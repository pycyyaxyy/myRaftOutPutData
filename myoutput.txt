1
2022-04-14 01:36:20
All real ports: 18144 13128 19745 11544 19122
All proxy ports: 11324 18581 13103 15001 12907
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:36:36 Start listening to port: 13128
2022/04/14 01:36:36 Start listening to port: 18144
2022/04/14 01:36:36 Start listening to port: 19745
2022/04/14 01:36:36 Start listening to port: 11544
2022/04/14 01:36:36 Start listening to port: 19122
2022/04/14 01:36:36 Successfully connect all nodes
2022/04/14 01:36:36 Successfully connect all nodes
2022/04/14 01:36:36 Successfully connect all nodes
2022/04/14 01:36:36 Successfully connect all nodes
2022/04/14 01:36:36 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3: dropped RequestVoteResponse to 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 4: dropped RequestVoteResponse to 0
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42317 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42322 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42323 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42324 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42325 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
2022/04/14 01:36:39 Start listening to port: 18144
node 3 Proxy started
2022/04/14 01:36:39 Start listening to port: 19122
2022/04/14 01:36:39 Start listening to port: 19745
node 4 Proxy started
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:36:39 Start listening to port: 13128
2022/04/14 01:36:39 Successfully connect all nodes
2022/04/14 01:36:39 Start listening to port: 11544
2022/04/14 01:36:39 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:36:40 Successfully connect all nodes
2022/04/14 01:36:40 Successfully connect all nodes
2022/04/14 01:36:40 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42402 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42403 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42404 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:36:43 Start listening to port: 19122
2022/04/14 01:36:43 Start listening to port: 13128
node 4 Proxy started
2022/04/14 01:36:43 Start listening to port: 19745
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:36:43 Start listening to port: 11544
2022/04/14 01:36:43 Start listening to port: 18144
2022/04/14 01:36:43 Successfully connect all nodes
2022/04/14 01:36:43 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:36:44 Successfully connect all nodes
2022/04/14 01:36:44 Successfully connect all nodes
2022/04/14 01:36:44 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42486 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42492 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:36:50 Start listening to port: 11544
2022/04/14 01:36:50 Start listening to port: 19745
2022/04/14 01:36:50 Start listening to port: 19122
node 2 Proxy started
2022/04/14 01:36:50 Start listening to port: 13128
node 3 Proxy started
2022/04/14 01:36:50 Start listening to port: 18144
2022/04/14 01:36:50 Successfully connect all nodes
node 0 Proxy started
Running testSplitVote:
2022/04/14 01:36:51 Successfully connect all nodes
2022/04/14 01:36:51 Successfully connect all nodes
2022/04/14 01:36:51 Successfully connect all nodes
2022/04/14 01:36:51 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 1 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42561 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42562 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42563 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42564 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42568 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42570 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 42565 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 42569 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:36:54 Start listening to port: 18144
node 2 Proxy started
2022/04/14 01:36:54 Start listening to port: 13128
2022/04/14 01:36:54 Start listening to port: 11544
2022/04/14 01:36:54 Start listening to port: 19745
node 3 Proxy started
2022/04/14 01:36:54 Start listening to port: 19122
2022/04/14 01:36:54 Successfully connect all nodes
2022/04/14 01:36:54 Successfully connect all nodes
2022/04/14 01:36:54 Successfully connect all nodes
2022/04/14 01:36:54 Successfully connect all nodes
2022/04/14 01:36:54 Successfully connect all nodes
Running testAllForElection:
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 3: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 4 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42648 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42649 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42650 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42651 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42652 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42654 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42655 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42656 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42657 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:36:58 Start listening to port: 11544
2022/04/14 01:36:58 Start listening to port: 19122
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:36:58 Start listening to port: 13128
node 0 Proxy started
2022/04/14 01:36:58 Start listening to port: 18144
2022/04/14 01:36:58 Successfully connect all nodes
2022/04/14 01:36:58 Start listening to port: 19745
2022/04/14 01:36:58 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 01:36:59 Successfully connect all nodes
2022/04/14 01:36:59 Successfully connect all nodes
2022/04/14 01:36:59 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 0: dropped RequestVote from 4
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42738 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42739 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42740 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42741 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42742 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42744 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42745 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42746 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42747 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 4 Proxy started
node 3 Proxy started
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:37:02 Start listening to port: 19745
2022/04/14 01:37:02 Start listening to port: 19122
2022/04/14 01:37:02 Start listening to port: 18144
2022/04/14 01:37:02 Start listening to port: 11544
2022/04/14 01:37:02 Start listening to port: 13128
2022/04/14 01:37:02 Successfully connect all nodes
2022/04/14 01:37:02 Successfully connect all nodes
2022/04/14 01:37:02 Successfully connect all nodes
2022/04/14 01:37:02 Successfully connect all nodes
2022/04/14 01:37:02 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:37:05 Receive propose from client
2022/04/14 01:37:05 Receive propose from client
2022/04/14 01:37:05 Receive propose from client
2022/04/14 01:37:05 Receive propose from client
2022/04/14 01:37:05 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,693334339>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,693334339>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,693334339>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,693334339>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
node 3 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:693334339 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42827 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42828 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42829 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42830 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42831 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42833 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42834 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42835 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42836 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:37:07 Start listening to port: 18144
2022/04/14 01:37:07 Start listening to port: 11544
2022/04/14 01:37:07 Start listening to port: 19122
2022/04/14 01:37:07 Start listening to port: 19745
2022/04/14 01:37:07 Start listening to port: 13128
2022/04/14 01:37:07 Successfully connect all nodes
2022/04/14 01:37:07 Successfully connect all nodes
2022/04/14 01:37:07 Successfully connect all nodes
2022/04/14 01:37:07 Successfully connect all nodes
2022/04/14 01:37:07 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:37:10 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,37959306>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,37959306>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:37959306 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:37:11 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,37959306>,t1:put<test,94812316>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,94812316>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,37959306>,t1:put<test,94812316>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,94812316>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:0], nextIndex :map[1:2 2:2 3:3 4:1] 
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:37959306  Term:1 Key:"test" Value:94812316 ], kvStore: map[test:37959306]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 4 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42911 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42912 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42913 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42914 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42915 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42919 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42920 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:37:13 Start listening to port: 18144
node 4 Proxy started
2022/04/14 01:37:13 Start listening to port: 13128
2022/04/14 01:37:13 Start listening to port: 19745
2022/04/14 01:37:13 Start listening to port: 11544
2022/04/14 01:37:13 Start listening to port: 19122
2022/04/14 01:37:13 Successfully connect all nodes
2022/04/14 01:37:13 Successfully connect all nodes
2022/04/14 01:37:13 Successfully connect all nodes
2022/04/14 01:37:13 Successfully connect all nodes
2022/04/14 01:37:13 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
2022/04/14 01:37:16 Receive propose from client
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 2
node 1 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 2
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
2022/04/14 01:37:17 Receive propose from client
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t2:del<test,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t2:del<test,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t2:del<test,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t2:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 1
node 2 -> 0: success, term: 2, matchIdx: 1
node 4 -> 0: success, term: 2, matchIdx: 1
node 1 -> 0: success, term: 2, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 当前的commitNum是:2
1当前leder的commit次数是:0

响应成功。更新之后：rn.nextIndex[hostId]： 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:2 Op:Delete Key:"test" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:0], nextIndex :map[1:1 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
01:37:18.662881 rafttest.go:222: FAIL: Node 0: incorrect status from GetValue on key test. Got KeyNotFound, expected KeyFound.
testOneSimpleDelete FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42994 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42995 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42996 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42997 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 42998 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43000 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43001 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43002 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43003 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:37:18 Start listening to port: 18144
2022/04/14 01:37:18 Start listening to port: 19745
2022/04/14 01:37:18 Start listening to port: 13128
2022/04/14 01:37:18 Start listening to port: 11544
2022/04/14 01:37:18 Start listening to port: 19122
2022/04/14 01:37:18 Successfully connect all nodes
2022/04/14 01:37:18 Successfully connect all nodes
2022/04/14 01:37:18 Successfully connect all nodes
2022/04/14 01:37:18 Successfully connect all nodes
2022/04/14 01:37:18 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:37:22 Receive propose from client
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:37:23 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>,t1:del<test2,0>], leaderCommit: 0
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:11870033  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:11870033  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:11870033]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,11870033>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43086 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43087 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43088 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43089 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43090 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43092 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43093 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43094 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 43095 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:36:39 testOneCandidateOneRoundElection PASS
2022/04/14 01:36:43 testOneCandidateStartTwoElection PASS
2022/04/14 01:36:49 testTwoCandidateForElection PASS
2022/04/14 01:36:54 testSplitVote PASS
2022/04/14 01:36:58 testAllForElection PASS
2022/04/14 01:37:01 testLeaderRevertToFollower PASS
2022/04/14 01:37:07 testOneSimplePut PASS
2022/04/14 01:37:13 testOneSimpleUpdate PASS
2022/04/14 01:37:18 testOneSimpleDelete FAIL
2022/04/14 01:37:25 testDeleteNonExistKey PASS

2
2022-04-14 01:37:30
All real ports: 19779 16683 12810 10926 17757
All proxy ports: 13989 15765 14009 17608 11531
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:37:33 Start listening to port: 12810
2022/04/14 01:37:33 Start listening to port: 16683
2022/04/14 01:37:33 Start listening to port: 19779
2022/04/14 01:37:33 Start listening to port: 17757
2022/04/14 01:37:33 Start listening to port: 10926
2022/04/14 01:37:33 Successfully connect all nodes
2022/04/14 01:37:33 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
2022/04/14 01:37:33 Successfully connect all nodes
2022/04/14 01:37:33 Successfully connect all nodes
2022/04/14 01:37:33 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44074 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44075 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44076 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44077 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44078 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44080 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44081 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44082 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44083 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:37:36 Start listening to port: 19779
node 4 Proxy started
2022/04/14 01:37:36 Start listening to port: 16683
2022/04/14 01:37:36 Start listening to port: 17757
2022/04/14 01:37:36 Start listening to port: 12810
2022/04/14 01:37:36 Start listening to port: 10926
2022/04/14 01:37:36 Successfully connect all nodes
2022/04/14 01:37:36 Successfully connect all nodes
2022/04/14 01:37:36 Successfully connect all nodes
2022/04/14 01:37:36 Successfully connect all nodes
2022/04/14 01:37:36 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44158 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44159 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44160 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44161 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44163 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44165 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44166 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44167 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44168 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:37:40 Start listening to port: 19779
2022/04/14 01:37:40 Start listening to port: 12810
2022/04/14 01:37:40 Start listening to port: 10926
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:37:40 Start listening to port: 16683
2022/04/14 01:37:40 Start listening to port: 17757
2022/04/14 01:37:40 Successfully connect all nodes
2022/04/14 01:37:40 Successfully connect all nodes
2022/04/14 01:37:40 Successfully connect all nodes
2022/04/14 01:37:40 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:37:41 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44239 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44240 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44241 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44242 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44243 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44245 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44246 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44247 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44248 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:37:45 Start listening to port: 19779
2022/04/14 01:37:45 Start listening to port: 16683
2022/04/14 01:37:45 Start listening to port: 12810
node 0 Proxy started
2022/04/14 01:37:45 Start listening to port: 10926
2022/04/14 01:37:45 Start listening to port: 17757
2022/04/14 01:37:45 Successfully connect all nodes
2022/04/14 01:37:45 Successfully connect all nodes
2022/04/14 01:37:45 Successfully connect all nodes
2022/04/14 01:37:45 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:37:46 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1node 0 -> 3: granted, term: 2

初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44321 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44322 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44323 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44324 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44325 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44327 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44328 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44329 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44330 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:37:50 Start listening to port: 19779
2022/04/14 01:37:50 Start listening to port: 17757
2022/04/14 01:37:50 Start listening to port: 16683
2022/04/14 01:37:50 Start listening to port: 12810
2022/04/14 01:37:50 Start listening to port: 10926
2022/04/14 01:37:50 Successfully connect all nodes
2022/04/14 01:37:50 Successfully connect all nodes
2022/04/14 01:37:50 Successfully connect all nodes
2022/04/14 01:37:50 Successfully connect all nodes
2022/04/14 01:37:50 Successfully connect all nodes
Running testAllForElection:
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: node 2 -> 4: granted, term: 2
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44407 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44408 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44409 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44410 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44411 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44413 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44414 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44415 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44416 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:37:54 Start listening to port: 19779
2022/04/14 01:37:54 Start listening to port: 12810
2022/04/14 01:37:54 Start listening to port: 10926
2022/04/14 01:37:54 Start listening to port: 17757
2022/04/14 01:37:54 Start listening to port: 16683
2022/04/14 01:37:54 Successfully connect all nodes
2022/04/14 01:37:54 Successfully connect all nodes
2022/04/14 01:37:54 Successfully connect all nodes
2022/04/14 01:37:54 Successfully connect all nodes
2022/04/14 01:37:54 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
node 4 -> 0: granted, term: 1
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 0: dropped RequestVote from 4
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44505 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44506 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44507 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44511 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44512 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:37:57 Start listening to port: 17757
node 0 Proxy started
2022/04/14 01:37:57 Start listening to port: 16683
node 3 Proxy started
2022/04/14 01:37:57 Start listening to port: 19779
2022/04/14 01:37:57 Start listening to port: 12810
node 1 Proxy started
2022/04/14 01:37:57 Start listening to port: 10926
node 2 Proxy started
node 4 Proxy started
Running testOneSimplePut:
2022/04/14 01:37:58 Successfully connect all nodes
2022/04/14 01:37:58 Successfully connect all nodes
2022/04/14 01:37:58 Successfully connect all nodes
2022/04/14 01:37:58 Successfully connect all nodes
2022/04/14 01:37:58 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:38:01 Receive propose from client
2022/04/14 01:38:01 Receive propose from client
2022/04/14 01:38:01 Receive propose from client
2022/04/14 01:38:01 Receive propose from client
2022/04/14 01:38:01 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,296260544>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,296260544>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,296260544>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,296260544>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2node 1 -> 0: success, term: 1, matchIdx: 1

AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:296260544 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
2
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44588 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44589 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44590 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44591 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44592 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44594 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44595 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44596 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44597 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:38:03 Start listening to port: 19779
2022/04/14 01:38:03 Start listening to port: 12810
2022/04/14 01:38:03 Start listening to port: 16683
2022/04/14 01:38:03 Start listening to port: 10926
2022/04/14 01:38:03 Start listening to port: 17757
2022/04/14 01:38:03 Successfully connect all nodes
2022/04/14 01:38:03 Successfully connect all nodes
2022/04/14 01:38:03 Successfully connect all nodes
2022/04/14 01:38:03 Successfully connect all nodes
2022/04/14 01:38:03 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:38:06 Receive propose from client
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,329058095>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,329058095>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2当前的commitNum是:2

当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:329058095 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:38:07 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,511871824>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,511871824>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,329058095>,t1:put<test,511871824>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,329058095>,t1:put<test,511871824>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2node 4 -> 0: success, term: 1, matchIdx: 2

响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:329058095  Term:1 Key:"test" Value:511871824 ], kvStore: map[test:329058095]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:0], nextIndex :map[1:2 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:2], nextIndex :map[1:2 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44672 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44673 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44674 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44675 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44676 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44678 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44679 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44680 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44681 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:38:09 Start listening to port: 16683
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:38:09 Start listening to port: 19779
2022/04/14 01:38:09 Start listening to port: 12810
2022/04/14 01:38:09 Start listening to port: 17757
2022/04/14 01:38:09 Start listening to port: 10926
2022/04/14 01:38:09 Successfully connect all nodes
2022/04/14 01:38:09 Successfully connect all nodes
2022/04/14 01:38:09 Successfully connect all nodes
2022/04/14 01:38:09 Successfully connect all nodes
2022/04/14 01:38:09 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:38:12 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,415654158>], leaderCommit: 0
node 1: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:38:13 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,415654158>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:415654158  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,415654158>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,415654158>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:415654158  Term:1 Op:Delete Key:"test" ], kvStore: map[test:415654158]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44753 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44754 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44755 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44756 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44757 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44759 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44760 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44761 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44762 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:38:16 Start listening to port: 19779
2022/04/14 01:38:16 Start listening to port: 16683
2022/04/14 01:38:16 Start listening to port: 12810
2022/04/14 01:38:16 Start listening to port: 10926
2022/04/14 01:38:16 Start listening to port: 17757
2022/04/14 01:38:16 Successfully connect all nodes
2022/04/14 01:38:16 Successfully connect all nodes
2022/04/14 01:38:16 Successfully connect all nodes
2022/04/14 01:38:16 Successfully connect all nodes
2022/04/14 01:38:16 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:38:19 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:38:20 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2063276147>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
当前的commitNum是:2
node 2 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2063276147  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2063276147  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:2063276147]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44841 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44842 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44844 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44845 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44847 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44848 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44849 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 44850 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:37:36 testOneCandidateOneRoundElection PASS
2022/04/14 01:37:40 testOneCandidateStartTwoElection PASS
2022/04/14 01:37:45 testTwoCandidateForElection PASS
2022/04/14 01:37:50 testSplitVote PASS
2022/04/14 01:37:54 testAllForElection PASS
2022/04/14 01:37:57 testLeaderRevertToFollower PASS
2022/04/14 01:38:02 testOneSimplePut PASS
2022/04/14 01:38:09 testOneSimpleUpdate PASS
2022/04/14 01:38:16 testOneSimpleDelete PASS
2022/04/14 01:38:23 testDeleteNonExistKey PASS

3
2022-04-14 01:38:28
All real ports: 19779 15915 18461 11894 12315
All proxy ports: 19707 12364 10440 12933 11121
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:38:32 Start listening to port: 12315
2022/04/14 01:38:32 Start listening to port: 19779
2022/04/14 01:38:32 Start listening to port: 18461
2022/04/14 01:38:32 Start listening to port: 11894
2022/04/14 01:38:32 Start listening to port: 15915
2022/04/14 01:38:32 Successfully connect all nodes
2022/04/14 01:38:32 Successfully connect all nodes
2022/04/14 01:38:32 Successfully connect all nodes
2022/04/14 01:38:32 Successfully connect all nodes
2022/04/14 01:38:32 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45732 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45733 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45734 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45735 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45736 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45738 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45739 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45740 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45741 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:38:35 Start listening to port: 19779
2022/04/14 01:38:35 Start listening to port: 18461
2022/04/14 01:38:35 Start listening to port: 15915
2022/04/14 01:38:35 Start listening to port: 12315
2022/04/14 01:38:35 Start listening to port: 11894
2022/04/14 01:38:35 Successfully connect all nodes
2022/04/14 01:38:35 Successfully connect all nodes
2022/04/14 01:38:35 Successfully connect all nodes
2022/04/14 01:38:35 Successfully connect all nodes
2022/04/14 01:38:35 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45813 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45814 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45815 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45816 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45817 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45819 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45820 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45822 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:38:39 Start listening to port: 19779
2022/04/14 01:38:39 Start listening to port: 11894
2022/04/14 01:38:39 Start listening to port: 18461
2022/04/14 01:38:39 Start listening to port: 15915
2022/04/14 01:38:39 Start listening to port: 12315
2022/04/14 01:38:39 Successfully connect all nodes
2022/04/14 01:38:39 Successfully connect all nodes
2022/04/14 01:38:39 Successfully connect all nodes
2022/04/14 01:38:39 Successfully connect all nodes
2022/04/14 01:38:39 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVote from 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: reject, term: 1
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
node 3 Proxy started
2022/04/14 01:38:44 Start listening to port: 18461
2022/04/14 01:38:44 Start listening to port: 11894
2022/04/14 01:38:44 Start listening to port: 12315
2022/04/14 01:38:44 Start listening to port: 19779
node 2 Proxy started
2022/04/14 01:38:44 Start listening to port: 15915
node 1 Proxy started
node 4 Proxy started
node 0 Proxy started
Running testSplitVote:
2022/04/14 01:38:45 Successfully connect all nodes
2022/04/14 01:38:45 Successfully connect all nodes
2022/04/14 01:38:45 Successfully connect all nodes
2022/04/14 01:38:45 Successfully connect all nodes
2022/04/14 01:38:45 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 3 -> 0: reject, term: 2
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45975 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45976 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45977 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45978 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45979 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45982 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45983 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 45984 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
2022/04/14 01:38:49 Start listening to port: 15915
node 4 Proxy started
2022/04/14 01:38:49 Start listening to port: 11894
2022/04/14 01:38:49 Start listening to port: 12315
2022/04/14 01:38:49 Start listening to port: 19779
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:38:49 Start listening to port: 18461
node 1 Proxy started
2022/04/14 01:38:49 Successfully connect all nodes
Running testAllForElection:
2022/04/14 01:38:50 Successfully connect all nodes
2022/04/14 01:38:50 Successfully connect all nodes
2022/04/14 01:38:50 Successfully connect all nodes
2022/04/14 01:38:50 Successfully connect all nodes
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 2 -> 1: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 2 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 4: granted, term: 2
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46055 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46056 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46057 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46058 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46060 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46062 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46063 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46064 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46065 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:38:54 Start listening to port: 19779
node 3 Proxy started
2022/04/14 01:38:54 Start listening to port: 15915
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:38:54 Start listening to port: 18461
2022/04/14 01:38:54 Start listening to port: 12315
2022/04/14 01:38:54 Start listening to port: 11894
2022/04/14 01:38:54 Successfully connect all nodes
2022/04/14 01:38:54 Successfully connect all nodes
2022/04/14 01:38:54 Successfully connect all nodes
2022/04/14 01:38:54 Successfully connect all nodes
2022/04/14 01:38:54 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46149 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46150 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46151 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46152 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46153 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46156 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46157 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46159 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:38:57 Start listening to port: 19779
2022/04/14 01:38:57 Start listening to port: 18461
2022/04/14 01:38:57 Start listening to port: 11894
2022/04/14 01:38:57 Start listening to port: 15915
2022/04/14 01:38:57 Start listening to port: 12315
2022/04/14 01:38:57 Successfully connect all nodes
2022/04/14 01:38:57 Successfully connect all nodes
2022/04/14 01:38:57 Successfully connect all nodes
2022/04/14 01:38:57 Successfully connect all nodes
2022/04/14 01:38:57 Successfully connect all nodes
Running testOneSimplePut:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:39:01 Receive propose from client
2022/04/14 01:39:01 Receive propose from client
2022/04/14 01:39:01 Receive propose from client
2022/04/14 01:39:01 Receive propose from client
2022/04/14 01:39:01 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,782848751>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,782848751>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,782848751>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,782848751>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2当前的commitNum是:2

当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:782848751 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:1], nextIndex :map[1:1 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46236 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46237 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46239 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46240 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46244 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:39:02 Start listening to port: 19779
2022/04/14 01:39:02 Start listening to port: 15915
2022/04/14 01:39:02 Start listening to port: 18461
2022/04/14 01:39:02 Start listening to port: 12315
2022/04/14 01:39:02 Start listening to port: 11894
2022/04/14 01:39:02 Successfully connect all nodes
2022/04/14 01:39:02 Successfully connect all nodes
2022/04/14 01:39:02 Successfully connect all nodes
2022/04/14 01:39:02 Successfully connect all nodes
2022/04/14 01:39:02 Successfully connect all nodes
Running testOneSimpleUpdate:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:39:06 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1918948297>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1918948297>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1918948297 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:39:06 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,853893251>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1918948297>,t1:put<test,853893251>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,853893251>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1918948297>,t1:put<test,853893251>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1918948297  Term:1 Key:"test" Value:853893251 ], kvStore: map[test:1918948297]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:0], nextIndex :map[1:2 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46329 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46330 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46331 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46332 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46333 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46335 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46336 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46337 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46340 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:39:08 Start listening to port: 19779
2022/04/14 01:39:08 Start listening to port: 15915
2022/04/14 01:39:08 Start listening to port: 18461
2022/04/14 01:39:08 Start listening to port: 11894
2022/04/14 01:39:08 Start listening to port: 12315
2022/04/14 01:39:08 Successfully connect all nodes
2022/04/14 01:39:08 Successfully connect all nodes
2022/04/14 01:39:08 Successfully connect all nodes
2022/04/14 01:39:08 Successfully connect all nodes
2022/04/14 01:39:08 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:39:12 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,986020169>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:39:13 Receive propose from client
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,986020169>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:986020169  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,986020169>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,986020169>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:986020169  Term:1 Op:Delete Key:"test" ], kvStore: map[test:986020169]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46417 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46418 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46419 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46420 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46421 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46424 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46425 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46426 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46427 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:39:15 Start listening to port: 19779
node 4 Proxy started
2022/04/14 01:39:15 Start listening to port: 12315
2022/04/14 01:39:15 Start listening to port: 15915
2022/04/14 01:39:15 Start listening to port: 18461
2022/04/14 01:39:15 Start listening to port: 11894
2022/04/14 01:39:15 Successfully connect all nodes
2022/04/14 01:39:15 Successfully connect all nodes
2022/04/14 01:39:15 Successfully connect all nodes
2022/04/14 01:39:15 Successfully connect all nodes
2022/04/14 01:39:15 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:39:19 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:39:20 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,827425436>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 3 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:827425436  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:0 4:2], nextIndex :map[1:1 2:3 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:827425436  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:827425436]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46504 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46505 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46506 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46507 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46509 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46511 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46512 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 46513 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:38:35 testOneCandidateOneRoundElection PASS
2022/04/14 01:38:39 testOneCandidateStartTwoElection PASS
2022/04/14 01:38:44 testTwoCandidateForElection PASS
2022/04/14 01:38:49 testSplitVote PASS
2022/04/14 01:38:54 testAllForElection PASS
2022/04/14 01:38:57 testLeaderRevertToFollower PASS
2022/04/14 01:39:02 testOneSimplePut PASS
2022/04/14 01:39:08 testOneSimpleUpdate PASS
2022/04/14 01:39:15 testOneSimpleDelete PASS
2022/04/14 01:39:22 testDeleteNonExistKey PASS

4
2022-04-14 01:39:27
All real ports: 15070 19298 13026 18406 19053
All proxy ports: 16144 17279 18033 13694 17602
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
node 0 Proxy started
2022/04/14 01:39:29 Start listening to port: 13026
2022/04/14 01:39:29 Start listening to port: 18406
2022/04/14 01:39:29 Start listening to port: 19053
2022/04/14 01:39:29 Start listening to port: 19298
2022/04/14 01:39:29 Start listening to port: 15070
2022/04/14 01:39:29 Successfully connect all nodes
2022/04/14 01:39:29 Successfully connect all nodes
2022/04/14 01:39:29 Successfully connect all nodes
2022/04/14 01:39:29 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
2022/04/14 01:39:29 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47427 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
node 0 Proxy started
2022/04/14 01:39:33 Start listening to port: 15070
2022/04/14 01:39:33 Start listening to port: 18406
2022/04/14 01:39:33 Start listening to port: 19298
node 3 Proxy started
2022/04/14 01:39:33 Start listening to port: 13026
node 4 Proxy started
2022/04/14 01:39:33 Start listening to port: 19053
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:39:34 Successfully connect all nodes
2022/04/14 01:39:34 Successfully connect all nodes
2022/04/14 01:39:34 Successfully connect all nodes
2022/04/14 01:39:34 Successfully connect all nodes
2022/04/14 01:39:34 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47509 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47510 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47511 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47512 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47513 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47515 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47516 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47517 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47518 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:39:38 Start listening to port: 19298
2022/04/14 01:39:38 Start listening to port: 15070
2022/04/14 01:39:38 Start listening to port: 19053
2022/04/14 01:39:38 Successfully connect all nodes
2022/04/14 01:39:38 Start listening to port: 13026
2022/04/14 01:39:38 Start listening to port: 18406
2022/04/14 01:39:38 Successfully connect all nodes
2022/04/14 01:39:38 Successfully connect all nodes
2022/04/14 01:39:38 Successfully connect all nodes
2022/04/14 01:39:38 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: reject, term: 1
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47586 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47592 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47593 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47594 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47596 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:39:43 Start listening to port: 18406
2022/04/14 01:39:43 Start listening to port: 19298
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:39:43 Start listening to port: 19053
2022/04/14 01:39:43 Start listening to port: 15070
node 1 Proxy started
2022/04/14 01:39:43 Start listening to port: 13026
node 0 Proxy started
node 3 Proxy started
Running testSplitVote:
2022/04/14 01:39:44 Successfully connect all nodes
2022/04/14 01:39:44 Successfully connect all nodes
2022/04/14 01:39:44 Successfully connect all nodes
2022/04/14 01:39:44 Successfully connect all nodes
2022/04/14 01:39:44 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47665 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47671 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47672 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47673 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47674 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:39:48 Start listening to port: 19298
2022/04/14 01:39:48 Start listening to port: 18406
2022/04/14 01:39:48 Start listening to port: 13026
node 2 Proxy started
2022/04/14 01:39:48 Start listening to port: 19053
2022/04/14 01:39:48 Start listening to port: 15070
2022/04/14 01:39:48 Successfully connect all nodes
2022/04/14 01:39:48 Successfully connect all nodes
2022/04/14 01:39:48 Successfully connect all nodes
2022/04/14 01:39:48 Successfully connect all nodes
2022/04/14 01:39:48 Successfully connect all nodes
Running testAllForElection:
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 2 -> 3: reject, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 2 -> 0: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 4 -> 0: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47745 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47746 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47747 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47748 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47749 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47752 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47753 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47754 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:39:52 Start listening to port: 15070
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:39:52 Start listening to port: 19298
node 3 Proxy started
2022/04/14 01:39:52 Start listening to port: 18406
2022/04/14 01:39:52 Start listening to port: 19053
2022/04/14 01:39:52 Start listening to port: 13026
2022/04/14 01:39:52 Successfully connect all nodes
2022/04/14 01:39:52 Successfully connect all nodes
2022/04/14 01:39:52 Successfully connect all nodes
2022/04/14 01:39:52 Successfully connect all nodes
2022/04/14 01:39:52 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47901 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47902 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47903 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47904 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47905 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47909 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47910 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:39:55 Start listening to port: 15070
node 3 Proxy started
2022/04/14 01:39:55 Start listening to port: 19298
2022/04/14 01:39:55 Start listening to port: 13026
2022/04/14 01:39:55 Start listening to port: 18406
2022/04/14 01:39:55 Start listening to port: 19053
2022/04/14 01:39:55 Successfully connect all nodes
2022/04/14 01:39:55 Successfully connect all nodes
2022/04/14 01:39:55 Successfully connect all nodes
2022/04/14 01:39:55 Successfully connect all nodes
2022/04/14 01:39:55 Successfully connect all nodes
Running testOneSimplePut:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:39:59 Receive propose from client
2022/04/14 01:39:59 Receive propose from client
2022/04/14 01:39:59 Receive propose from client
2022/04/14 01:39:59 Receive propose from client
2022/04/14 01:39:59 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1197435649>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1197435649>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1197435649>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1197435649>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1197435649 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:1], nextIndex :map[1:1 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47984 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47985 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47986 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47987 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47988 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 47992 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 01:40:00 Start listening to port: 19298
2022/04/14 01:40:00 Start listening to port: 15070
2022/04/14 01:40:00 Start listening to port: 13026
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:40:00 Start listening to port: 18406
2022/04/14 01:40:00 Start listening to port: 19053
2022/04/14 01:40:00 Successfully connect all nodes
2022/04/14 01:40:00 Successfully connect all nodes
2022/04/14 01:40:00 Successfully connect all nodes
2022/04/14 01:40:00 Successfully connect all nodes
2022/04/14 01:40:00 Successfully connect all nodes
Running testOneSimpleUpdate:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:40:04 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,405236739>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,405236739>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:405236739 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:40:04 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,375431090>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,405236739>,t1:put<test,375431090>], leaderCommit: 1
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,375431090>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,405236739>,t1:put<test,375431090>], leaderCommit: 1
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:405236739  Term:1 Key:"test" Value:375431090 ], kvStore: map[test:405236739]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48069 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48070 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48071 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48072 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48073 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48075 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48076 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48077 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48078 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:40:06 Start listening to port: 15070
node 4 Proxy started
2022/04/14 01:40:06 Start listening to port: 19298
2022/04/14 01:40:06 Start listening to port: 13026
node 3 Proxy started
2022/04/14 01:40:06 Start listening to port: 18406
2022/04/14 01:40:06 Start listening to port: 19053
2022/04/14 01:40:06 Successfully connect all nodes
2022/04/14 01:40:06 Successfully connect all nodes
2022/04/14 01:40:06 Successfully connect all nodes
2022/04/14 01:40:06 Successfully connect all nodes
Running testOneSimpleDelete:
2022/04/14 01:40:07 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:40:10 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1979745230>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:40:11 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1979745230>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1979745230  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1979745230>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1979745230>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1979745230  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1979745230]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48153 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48154 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48155 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48156 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48157 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48159 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48162 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:40:13 Start listening to port: 15070
2022/04/14 01:40:13 Start listening to port: 19298
2022/04/14 01:40:13 Start listening to port: 13026
2022/04/14 01:40:13 Start listening to port: 18406
node 4 Proxy started
2022/04/14 01:40:13 Start listening to port: 19053
2022/04/14 01:40:13 Successfully connect all nodes
2022/04/14 01:40:13 Successfully connect all nodes
2022/04/14 01:40:13 Successfully connect all nodes
2022/04/14 01:40:13 Successfully connect all nodes
2022/04/14 01:40:13 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:40:17 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:40:18 Receive propose from client
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2077007574>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 2 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2077007574  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2077007574  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:2077007574]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48236 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48237 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48238 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48239 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48240 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48242 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48243 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48244 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 48245 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:39:32 testOneCandidateOneRoundElection PASS
2022/04/14 01:39:38 testOneCandidateStartTwoElection PASS
2022/04/14 01:39:43 testTwoCandidateForElection PASS
2022/04/14 01:39:48 testSplitVote PASS
2022/04/14 01:39:52 testAllForElection PASS
2022/04/14 01:39:55 testLeaderRevertToFollower PASS
2022/04/14 01:40:00 testOneSimplePut PASS
2022/04/14 01:40:06 testOneSimpleUpdate PASS
2022/04/14 01:40:13 testOneSimpleDelete PASS
2022/04/14 01:40:20 testDeleteNonExistKey PASS

5
2022-04-14 01:40:25
All real ports: 13122 17032 18500 10775 19951
All proxy ports: 11775 16411 15661 19989 13745
node 0 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:40:27 Start listening to port: 13122
2022/04/14 01:40:27 Start listening to port: 10775
2022/04/14 01:40:27 Start listening to port: 17032
2022/04/14 01:40:27 Start listening to port: 19951
2022/04/14 01:40:27 Start listening to port: 18500
2022/04/14 01:40:27 Successfully connect all nodes
2022/04/14 01:40:27 Successfully connect all nodes
2022/04/14 01:40:27 Successfully connect all nodes
2022/04/14 01:40:27 Successfully connect all nodes
2022/04/14 01:40:27 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49187 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49188 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49189 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49190 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49191 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49193 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49194 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49195 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49196 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:40:31 Start listening to port: 13122
2022/04/14 01:40:31 Start listening to port: 18500
2022/04/14 01:40:31 Start listening to port: 10775
2022/04/14 01:40:31 Start listening to port: 19951
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:40:31 Start listening to port: 17032
node 4 Proxy started
2022/04/14 01:40:31 Successfully connect all nodes
node 1 Proxy started
2022/04/14 01:40:32 Successfully connect all nodes
2022/04/14 01:40:32 Successfully connect all nodes
2022/04/14 01:40:32 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:40:32 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49275 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49276 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49277 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49278 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49279 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49281 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49282 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49284 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:40:36 Start listening to port: 13122
node 1 Proxy started
2022/04/14 01:40:36 Start listening to port: 18500
2022/04/14 01:40:36 Start listening to port: 17032
2022/04/14 01:40:36 Start listening to port: 19951
2022/04/14 01:40:36 Start listening to port: 10775
2022/04/14 01:40:36 Successfully connect all nodes
2022/04/14 01:40:36 Successfully connect all nodes
2022/04/14 01:40:36 Successfully connect all nodes
2022/04/14 01:40:36 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:40:37 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49353 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49354 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49355 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49356 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49357 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49359 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49360 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49361 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49362 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:40:41 Start listening to port: 13122
2022/04/14 01:40:41 Start listening to port: 18500
2022/04/14 01:40:41 Start listening to port: 19951
2022/04/14 01:40:41 Start listening to port: 17032
2022/04/14 01:40:41 Start listening to port: 10775
2022/04/14 01:40:41 Successfully connect all nodes
2022/04/14 01:40:41 Successfully connect all nodes
2022/04/14 01:40:41 Successfully connect all nodes
2022/04/14 01:40:41 Successfully connect all nodes
2022/04/14 01:40:41 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49433 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49434 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49435 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49436 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49437 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49439 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49440 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49441 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49442 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:40:45 Start listening to port: 17032
2022/04/14 01:40:45 Start listening to port: 13122
2022/04/14 01:40:45 Start listening to port: 10775
2022/04/14 01:40:45 Start listening to port: 18500
2022/04/14 01:40:45 Start listening to port: 19951
2022/04/14 01:40:45 Successfully connect all nodes
2022/04/14 01:40:45 Successfully connect all nodes
2022/04/14 01:40:45 Successfully connect all nodes
2022/04/14 01:40:45 Successfully connect all nodes
2022/04/14 01:40:45 Successfully connect all nodes
Running testAllForElection:
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 3 -> 2: reject, term: 1
node 0 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49516 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49517 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49518 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49519 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49520 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49523 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49524 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49525 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:40:49 Start listening to port: 13122
node 4 Proxy started
2022/04/14 01:40:49 Start listening to port: 18500
2022/04/14 01:40:49 Start listening to port: 10775
2022/04/14 01:40:49 Start listening to port: 17032
2022/04/14 01:40:49 Start listening to port: 19951
2022/04/14 01:40:49 Successfully connect all nodes
2022/04/14 01:40:49 Successfully connect all nodes
2022/04/14 01:40:49 Successfully connect all nodes
2022/04/14 01:40:49 Successfully connect all nodes
2022/04/14 01:40:49 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 115: 49615 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49609 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49610 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49611 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49612 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49613 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49614 Killed                  ${RAFT_NODE} ${NODE_PORT0} ${ALL_PROXY_PORTS} 0 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49616 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49617 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 116: 49618 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 01:40:53 Start listening to port: 19951
2022/04/14 01:40:53 Start listening to port: 10775
2022/04/14 01:40:53 Start listening to port: 17032
2022/04/14 01:40:53 Start listening to port: 18500
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:40:53 Start listening to port: 13122
node 3 Proxy started
2022/04/14 01:40:53 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:40:54 Successfully connect all nodes
2022/04/14 01:40:54 Successfully connect all nodes
2022/04/14 01:40:54 Successfully connect all nodes
2022/04/14 01:40:54 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:40:56 Receive propose from client
2022/04/14 01:40:56 Receive propose from client
2022/04/14 01:40:56 Receive propose from client
2022/04/14 01:40:56 Receive propose from client
2022/04/14 01:40:56 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1150658847>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1150658847>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1150658847>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1150658847>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1150658847 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:1], nextIndex :map[1:1 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49689 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49690 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49691 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49692 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49693 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49696 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49698 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:40:58 Start listening to port: 19951
2022/04/14 01:40:58 Start listening to port: 13122
2022/04/14 01:40:58 Start listening to port: 18500
2022/04/14 01:40:58 Start listening to port: 17032
2022/04/14 01:40:58 Start listening to port: 10775
2022/04/14 01:40:58 Successfully connect all nodes
2022/04/14 01:40:58 Successfully connect all nodes
2022/04/14 01:40:58 Successfully connect all nodes
2022/04/14 01:40:58 Successfully connect all nodes
2022/04/14 01:40:58 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:41:01 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1701069589>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1701069589>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1701069589 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:41:02 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1701069589>,t1:put<test,1800542712>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1701069589>,t1:put<test,1800542712>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1800542712>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1800542712>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1701069589  Term:1 Key:"test" Value:1800542712 ], kvStore: map[test:1701069589]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:2], nextIndex :map[1:3 2:2 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49769 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49770 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49771 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49772 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49773 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49775 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49776 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49777 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49778 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:41:04 Start listening to port: 13122
2022/04/14 01:41:04 Start listening to port: 17032
2022/04/14 01:41:04 Start listening to port: 18500
2022/04/14 01:41:04 Successfully connect all nodes
2022/04/14 01:41:04 Successfully connect all nodes
2022/04/14 01:41:04 Successfully connect all nodes
2022/04/14 01:41:04 Start listening to port: 19951
2022/04/14 01:41:04 Successfully connect all nodes
Running testOneSimpleDelete:
2022/04/14 01:41:04 Start listening to port: 10775
2022/04/14 01:41:04 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:41:07 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,505854484>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:41:08 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,505854484>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:505854484  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,505854484>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,505854484>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:505854484  Term:1 Op:Delete Key:"test" ], kvStore: map[test:505854484]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49856 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49858 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49859 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49860 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49862 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49863 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49864 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49865 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:41:11 Start listening to port: 13122
node 0 Proxy started
2022/04/14 01:41:11 Start listening to port: 17032
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:41:11 Start listening to port: 10775
node 2 Proxy started
2022/04/14 01:41:11 Start listening to port: 19951
node 3 Proxy started
2022/04/14 01:41:11 Successfully connect all nodes
2022/04/14 01:41:11 Start listening to port: 18500
2022/04/14 01:41:11 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 01:41:12 Successfully connect all nodes
2022/04/14 01:41:12 Successfully connect all nodes
2022/04/14 01:41:12 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:41:14 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:41:15 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1613578680>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1613578680  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1613578680  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1613578680]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49937 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49938 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49939 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49940 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49941 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49944 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49945 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 49946 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:40:30 testOneCandidateOneRoundElection PASS
2022/04/14 01:40:36 testOneCandidateStartTwoElection PASS
2022/04/14 01:40:41 testTwoCandidateForElection PASS
2022/04/14 01:40:45 testSplitVote PASS
2022/04/14 01:40:49 testAllForElection PASS
2022/04/14 01:40:52 testLeaderRevertToFollower PASS
2022/04/14 01:40:58 testOneSimplePut PASS
2022/04/14 01:41:04 testOneSimpleUpdate PASS
2022/04/14 01:41:11 testOneSimpleDelete PASS
2022/04/14 01:41:18 testDeleteNonExistKey PASS

6
2022-04-14 01:41:23
All real ports: 12419 18657 13907 16511 18358
All proxy ports: 14268 18975 15359 19153 14387
node 4 Proxy started
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:41:25 Start listening to port: 16511
2022/04/14 01:41:25 Start listening to port: 18657
2022/04/14 01:41:25 Start listening to port: 13907
2022/04/14 01:41:25 Start listening to port: 18358
2022/04/14 01:41:25 Start listening to port: 12419
2022/04/14 01:41:25 Successfully connect all nodes
2022/04/14 01:41:25 Successfully connect all nodes
2022/04/14 01:41:25 Successfully connect all nodes
2022/04/14 01:41:25 Successfully connect all nodes
2022/04/14 01:41:25 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: node 4: dropped RequestVoteResponse to 0
0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50891 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50892 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50893 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50894 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50895 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50897 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50898 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50899 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50900 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:41:28 Start listening to port: 12419
2022/04/14 01:41:28 Start listening to port: 18657
2022/04/14 01:41:28 Start listening to port: 16511
2022/04/14 01:41:28 Start listening to port: 13907
2022/04/14 01:41:28 Start listening to port: 18358
2022/04/14 01:41:28 Successfully connect all nodes
2022/04/14 01:41:28 Successfully connect all nodes
2022/04/14 01:41:28 Successfully connect all nodes
2022/04/14 01:41:28 Successfully connect all nodes
2022/04/14 01:41:28 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50972 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50973 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50974 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50975 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50976 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50978 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50979 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50980 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 50981 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:41:32 Start listening to port: 12419
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:41:32 Start listening to port: 18657
2022/04/14 01:41:32 Start listening to port: 18358
2022/04/14 01:41:32 Start listening to port: 16511
2022/04/14 01:41:32 Start listening to port: 13907
2022/04/14 01:41:32 Successfully connect all nodes
2022/04/14 01:41:32 Successfully connect all nodes
2022/04/14 01:41:32 Successfully connect all nodes
2022/04/14 01:41:32 Successfully connect all nodes
2022/04/14 01:41:32 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51057 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51058 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51059 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51060 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51061 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51066 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:41:37 Start listening to port: 18657
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:41:37 Start listening to port: 16511
2022/04/14 01:41:37 Start listening to port: 13907
2022/04/14 01:41:37 Start listening to port: 12419
2022/04/14 01:41:37 Start listening to port: 18358
2022/04/14 01:41:37 Successfully connect all nodes
2022/04/14 01:41:37 Successfully connect all nodes
2022/04/14 01:41:37 Successfully connect all nodes
2022/04/14 01:41:37 Successfully connect all nodes
2022/04/14 01:41:37 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 3: granted, term: 2
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: granted, term: 2
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51139 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51145 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51146 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51147 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51148 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:41:42 Start listening to port: 13907
node 3 Proxy started
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 01:41:42 Start listening to port: 12419
2022/04/14 01:41:42 Start listening to port: 18358
node 2 Proxy started
2022/04/14 01:41:42 Start listening to port: 16511
2022/04/14 01:41:42 Start listening to port: 18657
2022/04/14 01:41:42 Successfully connect all nodes
2022/04/14 01:41:42 Successfully connect all nodes
2022/04/14 01:41:43 Successfully connect all nodes
2022/04/14 01:41:43 Successfully connect all nodes
2022/04/14 01:41:43 Successfully connect all nodes
Running testAllForElection:
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 0: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51222 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51223 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51224 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51225 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51226 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51229 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51230 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51231 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:41:46 Start listening to port: 12419
2022/04/14 01:41:46 Start listening to port: 18657
2022/04/14 01:41:46 Start listening to port: 13907
2022/04/14 01:41:46 Start listening to port: 16511
2022/04/14 01:41:46 Start listening to port: 18358
2022/04/14 01:41:46 Successfully connect all nodes
2022/04/14 01:41:46 Successfully connect all nodes
2022/04/14 01:41:46 Successfully connect all nodes
2022/04/14 01:41:46 Successfully connect all nodes
2022/04/14 01:41:46 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51314 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51315 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51316 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51317 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51318 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51320 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51321 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51322 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51323 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:41:50 Start listening to port: 12419
node 1 Proxy started
2022/04/14 01:41:50 Start listening to port: 16511
2022/04/14 01:41:50 Start listening to port: 18657
2022/04/14 01:41:50 Start listening to port: 13907
2022/04/14 01:41:50 Start listening to port: 18358
2022/04/14 01:41:50 Successfully connect all nodes
2022/04/14 01:41:50 Successfully connect all nodes
2022/04/14 01:41:50 Successfully connect all nodes
2022/04/14 01:41:50 Successfully connect all nodes
2022/04/14 01:41:50 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:41:53 Receive propose from client
2022/04/14 01:41:53 Receive propose from client
2022/04/14 01:41:53 Receive propose from client
2022/04/14 01:41:53 Receive propose from client
2022/04/14 01:41:53 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1017894931>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1017894931>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1017894931>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1017894931>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 1
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1017894931 ], kvStore: map[]  
node 3 -> 0: success, term: 1, matchIdx: 1
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51397 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51398 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51399 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51400 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51401 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51403 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51404 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51405 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51406 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:41:55 Start listening to port: 12419
node 4 Proxy started
2022/04/14 01:41:55 Start listening to port: 13907
2022/04/14 01:41:55 Start listening to port: 16511
2022/04/14 01:41:55 Start listening to port: 18657
2022/04/14 01:41:55 Start listening to port: 18358
2022/04/14 01:41:55 Successfully connect all nodes
2022/04/14 01:41:55 Successfully connect all nodes
2022/04/14 01:41:55 Successfully connect all nodes
2022/04/14 01:41:55 Successfully connect all nodes
2022/04/14 01:41:55 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:41:58 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,619948582>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,619948582>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 1 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:619948582 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:41:59 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,2010042934>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,619948582>,t1:put<test,2010042934>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,619948582>,t1:put<test,2010042934>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,2010042934>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
node 3 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:619948582  Term:1 Key:"test" Value:2010042934 ], kvStore: map[test:619948582]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:2], nextIndex :map[1:2 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51480 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51481 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51482 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51483 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51484 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51486 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51487 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51488 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51489 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:42:01 Start listening to port: 18358
2022/04/14 01:42:01 Start listening to port: 16511
2022/04/14 01:42:01 Start listening to port: 18657
2022/04/14 01:42:01 Start listening to port: 12419
2022/04/14 01:42:01 Start listening to port: 13907
2022/04/14 01:42:01 Successfully connect all nodes
2022/04/14 01:42:01 Successfully connect all nodes
2022/04/14 01:42:01 Successfully connect all nodes
2022/04/14 01:42:01 Successfully connect all nodes
2022/04/14 01:42:01 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:42:05 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1942802600>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:42:06 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1942802600>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1942802600  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1942802600>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1942802600>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1942802600  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1942802600]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51562 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51563 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51564 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51565 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51567 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51570 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51571 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51572 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51573 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:42:08 Start listening to port: 18657
2022/04/14 01:42:08 Start listening to port: 18358
2022/04/14 01:42:08 Start listening to port: 12419
2022/04/14 01:42:08 Start listening to port: 16511
2022/04/14 01:42:08 Start listening to port: 13907
2022/04/14 01:42:08 Successfully connect all nodes
2022/04/14 01:42:08 Successfully connect all nodes
2022/04/14 01:42:08 Successfully connect all nodes
2022/04/14 01:42:08 Successfully connect all nodes
2022/04/14 01:42:08 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 4 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:42:12 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:42:13 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1278094418>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:0 4:0], nextIndex :map[1:1 2:3 3:1 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1278094418  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1278094418  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1278094418]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51653 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51656 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51657 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51658 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 51659 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:41:28 testOneCandidateOneRoundElection PASS
2022/04/14 01:41:32 testOneCandidateStartTwoElection PASS
2022/04/14 01:41:37 testTwoCandidateForElection PASS
2022/04/14 01:41:42 testSplitVote PASS
2022/04/14 01:41:46 testAllForElection PASS
2022/04/14 01:41:50 testLeaderRevertToFollower PASS
2022/04/14 01:41:55 testOneSimplePut PASS
2022/04/14 01:42:01 testOneSimpleUpdate PASS
2022/04/14 01:42:08 testOneSimpleDelete PASS
2022/04/14 01:42:15 testDeleteNonExistKey PASS

7
2022-04-14 01:42:21
All real ports: 15705 12387 19468 18075 18741
All proxy ports: 12230 13909 12888 13329 12587
node 4 Proxy started
node 1 Proxy started
01:42:23.577027 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:42:23 Start listening to port: 18741
2022/04/14 01:42:23 Start listening to port: 19468
2022/04/14 01:42:23 Start listening to port: 12387
2022/04/14 01:42:23 Start listening to port: 15705
2022/04/14 01:42:23 Start listening to port: 18075
2022/04/14 01:42:23 Successfully connect all nodes
2022/04/14 01:42:24 Successfully connect all nodes
2022/04/14 01:42:24 Successfully connect all nodes
2022/04/14 01:42:24 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
2022/04/14 01:42:24 Successfully connect all nodes
01:42:26.277580 rafttest.go:262: FAIL: error on testOneCandidateOneRoundElection - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testOneCandidateOneRoundElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52566 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52567 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52569 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52570 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52572 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52573 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52574 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52575 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:42:26 Start listening to port: 15705
01:42:26.304107 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
2022/04/14 01:42:26 Start listening to port: 12387
2022/04/14 01:42:26 Start listening to port: 19468
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:42:26 Start listening to port: 18741
2022/04/14 01:42:26 Start listening to port: 18075
2022/04/14 01:42:26 Successfully connect all nodes
2022/04/14 01:42:26 Successfully connect all nodes
2022/04/14 01:42:26 Successfully connect all nodes
2022/04/14 01:42:26 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:42:27 Successfully connect all nodes
01:42:28.331634 rafttest.go:262: FAIL: error on testOneCandidateStartTwoElection - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testOneCandidateStartTwoElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52644 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52645 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52647 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52648 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52650 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52652 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52653 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52654 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
01:42:28.357367 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 0 Proxy started
2022/04/14 01:42:28 Start listening to port: 12387
node 4 Proxy started
2022/04/14 01:42:28 Start listening to port: 15705
2022/04/14 01:42:28 Start listening to port: 18741
2022/04/14 01:42:28 Start listening to port: 19468
2022/04/14 01:42:28 Start listening to port: 18075
2022/04/14 01:42:28 Successfully connect all nodes
2022/04/14 01:42:28 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:42:28 Successfully connect all nodes
2022/04/14 01:42:28 Successfully connect all nodes
2022/04/14 01:42:28 Successfully connect all nodes
01:42:30.574112 rafttest.go:262: FAIL: error on testTwoCandidateForElection - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testTwoCandidateForElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52743 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52744 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52746 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52747 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52749 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52750 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52751 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52752 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
01:42:30.599801 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 3 Proxy started
2022/04/14 01:42:30 Start listening to port: 12387
node 4 Proxy started
2022/04/14 01:42:30 Start listening to port: 19468
2022/04/14 01:42:30 Start listening to port: 15705
2022/04/14 01:42:30 Start listening to port: 18075
2022/04/14 01:42:30 Start listening to port: 18741
2022/04/14 01:42:30 Successfully connect all nodes
2022/04/14 01:42:30 Successfully connect all nodes
2022/04/14 01:42:30 Successfully connect all nodes
2022/04/14 01:42:30 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:42:30 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
01:42:34.706983 rafttest.go:262: FAIL: error on testSplitVote2 - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testSplitVote FAIL
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52888 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52889 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52891 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52892 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52894 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52895 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52896 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52897 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:42:34 Start listening to port: 15705
01:42:34.733967 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
2022/04/14 01:42:34 Start listening to port: 12387
2022/04/14 01:42:34 Start listening to port: 18075
2022/04/14 01:42:34 Start listening to port: 19468
2022/04/14 01:42:34 Start listening to port: 18741
2022/04/14 01:42:34 Successfully connect all nodes
2022/04/14 01:42:34 Successfully connect all nodes
2022/04/14 01:42:34 Successfully connect all nodes
2022/04/14 01:42:34 Successfully connect all nodes
2022/04/14 01:42:34 Successfully connect all nodes
Running testAllForElection:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 3 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 3: reject, term: 1
01:42:38.357606 rafttest.go:262: FAIL: error on testAllForElection2 - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testAllForElection FAIL
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52969 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52970 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52972 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52973 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52975 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52976 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52978 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 52980 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
01:42:38.382516 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 3 Proxy started
2022/04/14 01:42:38 Start listening to port: 15705
2022/04/14 01:42:38 Start listening to port: 12387
2022/04/14 01:42:38 Start listening to port: 19468
node 4 Proxy started
2022/04/14 01:42:38 Start listening to port: 18075
2022/04/14 01:42:38 Start listening to port: 18741
2022/04/14 01:42:38 Successfully connect all nodes
2022/04/14 01:42:38 Successfully connect all nodes
2022/04/14 01:42:38 Successfully connect all nodes
2022/04/14 01:42:38 Successfully connect all nodes
2022/04/14 01:42:38 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
01:42:41.489363 rafttest.go:262: FAIL: error on testLeaderRevertToFollower3 - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testLeaderRevertToFollower FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53063 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53064 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53066 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53067 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53069 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53070 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53071 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53072 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
01:42:41.514639 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 3 Proxy started
2022/04/14 01:42:41 Start listening to port: 15705
2022/04/14 01:42:41 Start listening to port: 12387
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:42:41 Start listening to port: 18741
2022/04/14 01:42:41 Start listening to port: 18075
2022/04/14 01:42:41 Start listening to port: 19468
2022/04/14 01:42:41 Successfully connect all nodes
2022/04/14 01:42:41 Successfully connect all nodes
2022/04/14 01:42:41 Successfully connect all nodes
2022/04/14 01:42:41 Successfully connect all nodes
2022/04/14 01:42:41 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
01:42:45.024028 rafttest.go:262: FAIL: error on testOneSimplePut - rpc error: code = Internal desc = grpc: error while marshaling: proto: Marshal called with nil
testOneSimplePut FAIL
2022/04/14 01:42:45 Receive propose from client
2022/04/14 01:42:45 Receive propose from client
2022/04/14 01:42:45 Receive propose from client
2022/04/14 01:42:45 Receive propose from client
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53148 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53149 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53151 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53153 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53157 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53180 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53181 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
01:42:45.050590 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:42:45 Start listening to port: 15705
2022/04/14 01:42:45 Start listening to port: 12387
2022/04/14 01:42:45 Start listening to port: 19468
2022/04/14 01:42:45 Start listening to port: 18075
2022/04/14 01:42:45 Start listening to port: 18741
2022/04/14 01:42:45 Successfully connect all nodes
2022/04/14 01:42:45 Successfully connect all nodes
2022/04/14 01:42:45 Successfully connect all nodes
2022/04/14 01:42:45 Successfully connect all nodes
2022/04/14 01:42:45 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:42:48 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1538938034>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1538938034>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1538938034>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1538938034 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:0], nextIndex :map[1:2 2:1 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
01:42:50.124514 rafttest.go:222: FAIL: Node 2: incorrect status from GetValue on key test. Got OK, expected KeyNotFound.
testOneSimpleUpdate FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53261 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53262 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53268 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53269 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53271 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53272 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53273 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53275 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
01:42:50.150427 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:42:50 Start listening to port: 15705
2022/04/14 01:42:50 Start listening to port: 12387
2022/04/14 01:42:50 Start listening to port: 18075
2022/04/14 01:42:50 Start listening to port: 19468
2022/04/14 01:42:50 Start listening to port: 18741
2022/04/14 01:42:50 Successfully connect all nodes
2022/04/14 01:42:50 Successfully connect all nodes
2022/04/14 01:42:50 Successfully connect all nodes
2022/04/14 01:42:50 Successfully connect all nodes
2022/04/14 01:42:50 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:42:53 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
2022/04/14 01:42:54 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1732447900>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
01:42:55.659667 rafttest.go:222: FAIL: Node 0: incorrect status from GetValue on key test. Got KeyNotFound, expected KeyFound.
testOneSimpleDelete FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53352 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53353 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53355 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53356 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53358 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53359 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53360 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53361 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
01:42:55.685008 raftproxy.go:80: Fail to listen portlisten tcp :12888: bind: address already in use
node 3 Proxy started
2022/04/14 01:42:55 Start listening to port: 15705
2022/04/14 01:42:55 Start listening to port: 12387
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 01:42:55 Start listening to port: 18075
2022/04/14 01:42:55 Start listening to port: 18741
2022/04/14 01:42:55 Start listening to port: 19468
2022/04/14 01:42:55 Successfully connect all nodes
2022/04/14 01:42:55 Successfully connect all nodes
2022/04/14 01:42:55 Successfully connect all nodes
2022/04/14 01:42:55 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 01:42:56 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:42:59 Receive propose from client
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1598824092>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1598824092>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:43:00 Receive propose from client
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1598824092>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1598824092>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
01:43:01.196100 rafttest.go:222: FAIL: Node 2: incorrect status from GetValue on key test. Got OK, expected KeyNotFound.
testDeleteNonExistKey FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53436 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 53437 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
2022/04/14 01:42:26 testOneCandidateOneRoundElection FAIL
2022/04/14 01:42:28 testOneCandidateStartTwoElection FAIL
2022/04/14 01:42:30 testTwoCandidateForElection FAIL
2022/04/14 01:42:34 testSplitVote FAIL
2022/04/14 01:42:38 testAllForElection FAIL
2022/04/14 01:42:41 testLeaderRevertToFollower FAIL
2022/04/14 01:42:45 testOneSimplePut FAIL
2022/04/14 01:42:50 testOneSimpleUpdate FAIL
2022/04/14 01:42:55 testOneSimpleDelete FAIL
2022/04/14 01:43:01 testDeleteNonExistKey FAIL

8
2022-04-14 01:43:06
All real ports: 12971 17901 18197 10157 17191
All proxy ports: 19348 10712 17674 12295 10614
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:43:08 Start listening to port: 17901
2022/04/14 01:43:08 Start listening to port: 17191
2022/04/14 01:43:08 Start listening to port: 18197
2022/04/14 01:43:08 Start listening to port: 12971
2022/04/14 01:43:08 Start listening to port: 10157
2022/04/14 01:43:08 Successfully connect all nodes
2022/04/14 01:43:08 Successfully connect all nodes
2022/04/14 01:43:08 Successfully connect all nodes
2022/04/14 01:43:08 Successfully connect all nodes
2022/04/14 01:43:08 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54343 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54346 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54347 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54348 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54349 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
2022/04/14 01:43:12 Start listening to port: 10157
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:43:12 Start listening to port: 18197
2022/04/14 01:43:12 Start listening to port: 12971
node 4 Proxy started
2022/04/14 01:43:12 Start listening to port: 17191
2022/04/14 01:43:12 Start listening to port: 17901
2022/04/14 01:43:12 Successfully connect all nodes
2022/04/14 01:43:12 Successfully connect all nodes
2022/04/14 01:43:13 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:43:13 Successfully connect all nodes
2022/04/14 01:43:13 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54421 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54422 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54423 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54424 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54425 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54427 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54428 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54429 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54430 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 4 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:43:17 Start listening to port: 12971
node 3 Proxy started
2022/04/14 01:43:17 Start listening to port: 17901
2022/04/14 01:43:17 Start listening to port: 18197
2022/04/14 01:43:17 Start listening to port: 10157
2022/04/14 01:43:17 Start listening to port: 17191
2022/04/14 01:43:17 Successfully connect all nodes
2022/04/14 01:43:17 Successfully connect all nodes
2022/04/14 01:43:17 Successfully connect all nodes
2022/04/14 01:43:17 Successfully connect all nodes
2022/04/14 01:43:17 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54504 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54505 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54506 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54507 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54509 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54510 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54511 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54512 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:43:22 Start listening to port: 12971
node 2 Proxy started
2022/04/14 01:43:22 Start listening to port: 17901
2022/04/14 01:43:22 Start listening to port: 18197
2022/04/14 01:43:22 Start listening to port: 10157
2022/04/14 01:43:22 Start listening to port: 17191
2022/04/14 01:43:22 Successfully connect all nodes
2022/04/14 01:43:22 Successfully connect all nodes
2022/04/14 01:43:22 Successfully connect all nodes
2022/04/14 01:43:22 Successfully connect all nodes
2022/04/14 01:43:22 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54588 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54589 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54590 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54591 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54592 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54594 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54595 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54596 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54597 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:43:26 Start listening to port: 12971
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:43:26 Start listening to port: 10157
2022/04/14 01:43:26 Start listening to port: 18197
2022/04/14 01:43:26 Start listening to port: 17901
2022/04/14 01:43:26 Start listening to port: 17191
2022/04/14 01:43:26 Successfully connect all nodes
2022/04/14 01:43:26 Successfully connect all nodes
2022/04/14 01:43:26 Successfully connect all nodes
2022/04/14 01:43:26 Successfully connect all nodes
2022/04/14 01:43:26 Successfully connect all nodes
Running testAllForElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54675 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54676 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54677 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54678 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54679 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54682 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54683 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54684 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:43:30 Start listening to port: 12971
node 4 Proxy started
2022/04/14 01:43:30 Start listening to port: 17901
2022/04/14 01:43:30 Start listening to port: 10157
2022/04/14 01:43:30 Start listening to port: 17191
2022/04/14 01:43:30 Start listening to port: 18197
2022/04/14 01:43:30 Successfully connect all nodes
2022/04/14 01:43:30 Successfully connect all nodes
2022/04/14 01:43:30 Successfully connect all nodes
2022/04/14 01:43:30 Successfully connect all nodes
2022/04/14 01:43:30 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54769 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54773 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54774 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:43:34 Start listening to port: 18197
2022/04/14 01:43:34 Start listening to port: 17901
2022/04/14 01:43:34 Start listening to port: 12971
2022/04/14 01:43:34 Start listening to port: 17191
node 0 Proxy started
2022/04/14 01:43:34 Start listening to port: 10157
2022/04/14 01:43:34 Successfully connect all nodes
node 3 Proxy started
Running testOneSimplePut:
2022/04/14 01:43:35 Successfully connect all nodes
2022/04/14 01:43:35 Successfully connect all nodes
2022/04/14 01:43:35 Successfully connect all nodes
2022/04/14 01:43:35 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:43:38 Receive propose from client
2022/04/14 01:43:38 Receive propose from client
2022/04/14 01:43:38 Receive propose from client
2022/04/14 01:43:38 Receive propose from client
2022/04/14 01:43:38 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1478650976>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1478650976>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1478650976>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1478650976>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1478650976 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:0], nextIndex :map[1:1 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 -> 0: success, term: 1, matchIdx: 1
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54852 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54853 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54854 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54855 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54856 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54858 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54859 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54860 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54861 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:43:39 Start listening to port: 12971
2022/04/14 01:43:39 Start listening to port: 17901
node 1 Proxy started
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:43:39 Start listening to port: 17191
2022/04/14 01:43:39 Start listening to port: 18197
2022/04/14 01:43:39 Start listening to port: 10157
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:43:39 Successfully connect all nodes
2022/04/14 01:43:39 Successfully connect all nodes
2022/04/14 01:43:39 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:43:40 Successfully connect all nodes
2022/04/14 01:43:40 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:43:43 Receive propose from client
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712952103>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712952103>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
node 1 -> 0: success, term: 1, matchIdx: 1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:712952103 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:43:43 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,248011359>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712952103>,t1:put<test,248011359>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712952103>,t1:put<test,248011359>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,248011359>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:712952103  Term:1 Key:"test" Value:248011359 ], kvStore: map[test:712952103]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:2], nextIndex :map[1:2 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54932 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54934 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54935 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54937 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 54939 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 01:43:45 Start listening to port: 12971
2022/04/14 01:43:45 Start listening to port: 18197
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:43:45 Start listening to port: 17191
2022/04/14 01:43:45 Start listening to port: 10157
2022/04/14 01:43:45 Start listening to port: 17901
2022/04/14 01:43:45 Successfully connect all nodes
2022/04/14 01:43:45 Successfully connect all nodes
2022/04/14 01:43:45 Successfully connect all nodes
2022/04/14 01:43:45 Successfully connect all nodes
2022/04/14 01:43:45 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:43:49 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1454271216>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:43:50 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1454271216>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1454271216  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1454271216>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1454271216>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1454271216  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1454271216]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55019 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55020 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55021 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55022 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55023 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55025 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55026 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55027 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55028 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:43:52 Start listening to port: 12971
node 2 Proxy started
node 4 Proxy started
node 0 Proxy started
2022/04/14 01:43:52 Start listening to port: 18197
2022/04/14 01:43:52 Start listening to port: 10157
2022/04/14 01:43:52 Start listening to port: 17191
2022/04/14 01:43:52 Start listening to port: 17901
2022/04/14 01:43:52 Successfully connect all nodes
2022/04/14 01:43:52 Successfully connect all nodes
2022/04/14 01:43:52 Successfully connect all nodes
2022/04/14 01:43:52 Successfully connect all nodes
2022/04/14 01:43:52 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:43:56 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:43:57 Receive propose from client
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1653473961>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1653473961  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1653473961  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1653473961]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 2 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55109 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55110 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55115 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55116 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
2022/04/14 01:43:11 testOneCandidateOneRoundElection PASS
2022/04/14 01:43:17 testOneCandidateStartTwoElection PASS
2022/04/14 01:43:22 testTwoCandidateForElection PASS
2022/04/14 01:43:26 testSplitVote PASS
2022/04/14 01:43:30 testAllForElection PASS
2022/04/14 01:43:34 testLeaderRevertToFollower PASS
2022/04/14 01:43:39 testOneSimplePut PASS
2022/04/14 01:43:45 testOneSimpleUpdate PASS
2022/04/14 01:43:52 testOneSimpleDelete PASS
2022/04/14 01:44:00 testDeleteNonExistKey PASS

9
2022-04-14 01:44:05
All real ports: 18316 16518 15157 16698 17467
All proxy ports: 17221 18702 12545 11959 17846
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 01:44:08 Start listening to port: 16698
2022/04/14 01:44:08 Start listening to port: 18316
2022/04/14 01:44:08 Start listening to port: 17467
2022/04/14 01:44:08 Start listening to port: 16518
2022/04/14 01:44:08 Start listening to port: 15157
2022/04/14 01:44:08 Successfully connect all nodes
2022/04/14 01:44:08 Successfully connect all nodes
2022/04/14 01:44:08 Successfully connect all nodes
2022/04/14 01:44:08 Successfully connect all nodes
2022/04/14 01:44:08 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55978 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55979 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55980 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55981 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55982 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55984 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55985 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55986 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 55987 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:44:11 Start listening to port: 16518
2022/04/14 01:44:11 Start listening to port: 18316
2022/04/14 01:44:11 Start listening to port: 17467
2022/04/14 01:44:11 Start listening to port: 15157
2022/04/14 01:44:11 Start listening to port: 16698
2022/04/14 01:44:11 Successfully connect all nodes
2022/04/14 01:44:11 Successfully connect all nodes
2022/04/14 01:44:11 Successfully connect all nodes
2022/04/14 01:44:11 Successfully connect all nodes
2022/04/14 01:44:11 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56059 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56060 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56062 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56063 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56065 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56066 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56067 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56068 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:44:15 Start listening to port: 15157
node 0 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:44:15 Start listening to port: 16518
node 3 Proxy started
2022/04/14 01:44:15 Start listening to port: 16698
2022/04/14 01:44:15 Start listening to port: 17467
2022/04/14 01:44:15 Successfully connect all nodes
2022/04/14 01:44:15 Successfully connect all nodes
2022/04/14 01:44:15 Start listening to port: 18316
2022/04/14 01:44:15 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:44:16 Successfully connect all nodes
2022/04/14 01:44:16 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 2: reject, term: 1
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56143 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56144 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56145 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56146 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56147 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56149 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56150 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56151 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56152 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:44:20 Start listening to port: 16518
2022/04/14 01:44:20 Start listening to port: 15157
2022/04/14 01:44:20 Start listening to port: 16698
node 2 Proxy started
2022/04/14 01:44:20 Start listening to port: 18316
2022/04/14 01:44:20 Successfully connect all nodes
2022/04/14 01:44:20 Successfully connect all nodes
2022/04/14 01:44:20 Successfully connect all nodes
2022/04/14 01:44:20 Start listening to port: 17467
2022/04/14 01:44:20 Successfully connect all nodes
2022/04/14 01:44:20 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56222 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56223 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56224 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56225 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56226 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56228 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56229 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56230 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56231 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:44:25 Start listening to port: 18316
2022/04/14 01:44:25 Start listening to port: 16518
2022/04/14 01:44:25 Start listening to port: 15157
2022/04/14 01:44:25 Start listening to port: 16698
2022/04/14 01:44:25 Start listening to port: 17467
2022/04/14 01:44:25 Successfully connect all nodes
2022/04/14 01:44:25 Successfully connect all nodes
2022/04/14 01:44:25 Successfully connect all nodes
2022/04/14 01:44:25 Successfully connect all nodes
2022/04/14 01:44:25 Successfully connect all nodes
Running testAllForElection:
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 2 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 4 -> 0: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 1 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56308 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56309 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56310 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56311 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56312 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56314 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56315 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56316 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56317 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:44:28 Start listening to port: 16518
2022/04/14 01:44:28 Start listening to port: 18316
node 4 Proxy started
2022/04/14 01:44:28 Start listening to port: 16698
2022/04/14 01:44:28 Start listening to port: 15157
2022/04/14 01:44:28 Start listening to port: 17467
2022/04/14 01:44:28 Successfully connect all nodes
2022/04/14 01:44:28 Successfully connect all nodes
2022/04/14 01:44:28 Successfully connect all nodes
2022/04/14 01:44:28 Successfully connect all nodes
2022/04/14 01:44:28 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56408 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56409 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56410 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56411 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56412 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56414 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56415 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56416 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56417 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:44:32 Start listening to port: 18316
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:44:32 Start listening to port: 15157
2022/04/14 01:44:32 Start listening to port: 16698
2022/04/14 01:44:32 Start listening to port: 17467
node 3 Proxy started
2022/04/14 01:44:32 Start listening to port: 16518
2022/04/14 01:44:32 Successfully connect all nodes
2022/04/14 01:44:32 Successfully connect all nodes
2022/04/14 01:44:32 Successfully connect all nodes
2022/04/14 01:44:32 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:44:33 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:44:35 Receive propose from client
2022/04/14 01:44:35 Receive propose from client
2022/04/14 01:44:35 Receive propose from client
2022/04/14 01:44:35 Receive propose from client
2022/04/14 01:44:35 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1273539746>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1273539746>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1273539746>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1273539746>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1273539746 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:0], nextIndex :map[1:2 2:1 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56496 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
node 1 Proxy started
2022/04/14 01:44:37 Start listening to port: 18316
2022/04/14 01:44:37 Start listening to port: 15157
2022/04/14 01:44:37 Start listening to port: 16698
node 2 Proxy started
2022/04/14 01:44:37 Start listening to port: 17467
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:44:37 Start listening to port: 16518
node 0 Proxy started
2022/04/14 01:44:38 Successfully connect all nodes
2022/04/14 01:44:38 Successfully connect all nodes
2022/04/14 01:44:38 Successfully connect all nodes
2022/04/14 01:44:38 Successfully connect all nodes
2022/04/14 01:44:38 Successfully connect all nodes
Running testOneSimpleUpdate:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:44:42 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1571555681>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1571555681>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1571555681 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:44:42 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1571555681>,t1:put<test,68212481>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1571555681>,t1:put<test,68212481>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,68212481>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:0], nextIndex :map[1:2 2:2 3:3 4:1] 
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1571555681  Term:1 Key:"test" Value:68212481 ], kvStore: map[test:1571555681]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,68212481>], leaderCommit: 1
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56584 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56585 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56586 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56587 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56588 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56591 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56592 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56593 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:44:44 Start listening to port: 18316
2022/04/14 01:44:44 Start listening to port: 16518
2022/04/14 01:44:44 Start listening to port: 15157
2022/04/14 01:44:44 Start listening to port: 16698
2022/04/14 01:44:44 Start listening to port: 17467
2022/04/14 01:44:44 Successfully connect all nodes
2022/04/14 01:44:44 Successfully connect all nodes
2022/04/14 01:44:44 Successfully connect all nodes
2022/04/14 01:44:44 Successfully connect all nodes
2022/04/14 01:44:44 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:44:48 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,533660649>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:44:49 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,533660649>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:533660649  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,533660649>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,533660649>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:533660649  Term:1 Op:Delete Key:"test" ], kvStore: map[test:533660649]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56668 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56669 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56670 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56671 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56672 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56674 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56675 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56676 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56677 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:44:51 Start listening to port: 18316
2022/04/14 01:44:51 Start listening to port: 16518
2022/04/14 01:44:51 Start listening to port: 15157
2022/04/14 01:44:51 Start listening to port: 16698
2022/04/14 01:44:51 Start listening to port: 17467
2022/04/14 01:44:51 Successfully connect all nodes
2022/04/14 01:44:51 Successfully connect all nodes
2022/04/14 01:44:51 Successfully connect all nodes
2022/04/14 01:44:51 Successfully connect all nodes
2022/04/14 01:44:51 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:44:55 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:44:56 Receive propose from client
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,712558921>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 3 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:712558921  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:712558921  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:712558921]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56760 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56762 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56763 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56764 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 56768 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
2022/04/14 01:44:11 testOneCandidateOneRoundElection PASS
2022/04/14 01:44:15 testOneCandidateStartTwoElection PASS
2022/04/14 01:44:20 testTwoCandidateForElection PASS
2022/04/14 01:44:25 testSplitVote PASS
2022/04/14 01:44:28 testAllForElection PASS
2022/04/14 01:44:32 testLeaderRevertToFollower PASS
2022/04/14 01:44:37 testOneSimplePut PASS
2022/04/14 01:44:44 testOneSimpleUpdate PASS
2022/04/14 01:44:51 testOneSimpleDelete PASS
2022/04/14 01:44:58 testDeleteNonExistKey PASS

10
2022-04-14 01:45:03
All real ports: 19390 17257 19654 10668 10709
All proxy ports: 10468 18900 11460 10618 11205
2022/04/14 01:45:07 Start listening to port: 19390
2022/04/14 01:45:07 Start listening to port: 17257
2022/04/14 01:45:07 Start listening to port: 10709
2022/04/14 01:45:07 Start listening to port: 19654
2022/04/14 01:45:07 Start listening to port: 10668
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:45:08 Successfully connect all nodes
2022/04/14 01:45:08 Successfully connect all nodes
2022/04/14 01:45:08 Successfully connect all nodes
2022/04/14 01:45:08 Successfully connect all nodes
2022/04/14 01:45:08 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57644 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57645 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57646 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57647 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57648 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57651 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57652 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57653 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57654 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:45:11 Start listening to port: 19390
2022/04/14 01:45:11 Start listening to port: 17257
2022/04/14 01:45:11 Start listening to port: 10709
2022/04/14 01:45:11 Start listening to port: 10668
2022/04/14 01:45:11 Start listening to port: 19654
2022/04/14 01:45:11 Successfully connect all nodes
2022/04/14 01:45:11 Successfully connect all nodes
2022/04/14 01:45:11 Successfully connect all nodes
2022/04/14 01:45:11 Successfully connect all nodes
2022/04/14 01:45:11 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57727 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57728 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57729 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57730 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57731 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57733 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57735 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57736 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:45:15 Start listening to port: 19390
2022/04/14 01:45:15 Start listening to port: 10709
2022/04/14 01:45:15 Start listening to port: 10668
2022/04/14 01:45:15 Start listening to port: 17257
2022/04/14 01:45:15 Start listening to port: 19654
2022/04/14 01:45:15 Successfully connect all nodes
2022/04/14 01:45:15 Successfully connect all nodes
2022/04/14 01:45:15 Successfully connect all nodes
2022/04/14 01:45:15 Successfully connect all nodes
2022/04/14 01:45:15 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57811 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57812 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57813 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57814 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57815 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57817 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57818 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57819 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57820 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:45:20 Start listening to port: 10668
node 4 Proxy started
2022/04/14 01:45:20 Start listening to port: 19654
2022/04/14 01:45:20 Start listening to port: 17257
2022/04/14 01:45:20 Start listening to port: 10709
2022/04/14 01:45:20 Start listening to port: 19390
2022/04/14 01:45:20 Successfully connect all nodes
2022/04/14 01:45:20 Successfully connect all nodes
2022/04/14 01:45:20 Successfully connect all nodes
2022/04/14 01:45:20 Successfully connect all nodes
2022/04/14 01:45:20 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57890 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57891 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57892 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57893 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57894 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57899 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57900 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57901 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57902 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:45:25 Start listening to port: 17257
2022/04/14 01:45:25 Start listening to port: 19390
2022/04/14 01:45:25 Start listening to port: 19654
2022/04/14 01:45:25 Start listening to port: 10668
2022/04/14 01:45:25 Start listening to port: 10709
2022/04/14 01:45:25 Successfully connect all nodes
2022/04/14 01:45:25 Successfully connect all nodes
2022/04/14 01:45:25 Successfully connect all nodes
2022/04/14 01:45:25 Successfully connect all nodes
2022/04/14 01:45:25 Successfully connect all nodes
Running testAllForElection:
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 0 -> 3: reject, term: 1
node 3 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 0 -> 1: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57977 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57978 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57979 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57980 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57981 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57983 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57984 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57985 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 57986 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:45:29 Start listening to port: 19654
2022/04/14 01:45:29 Start listening to port: 19390
2022/04/14 01:45:29 Start listening to port: 10668
2022/04/14 01:45:29 Start listening to port: 17257
node 2 Proxy started
2022/04/14 01:45:29 Start listening to port: 10709
2022/04/14 01:45:29 Successfully connect all nodes
2022/04/14 01:45:29 Successfully connect all nodes
2022/04/14 01:45:29 Successfully connect all nodes
2022/04/14 01:45:29 Successfully connect all nodes
2022/04/14 01:45:29 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58075 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58076 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58077 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58078 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58079 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58081 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58082 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58083 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58084 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:45:32 Start listening to port: 19390
node 2 Proxy started
2022/04/14 01:45:32 Start listening to port: 17257
2022/04/14 01:45:32 Start listening to port: 19654
2022/04/14 01:45:32 Start listening to port: 10668
2022/04/14 01:45:32 Start listening to port: 10709
2022/04/14 01:45:32 Successfully connect all nodes
2022/04/14 01:45:32 Successfully connect all nodes
2022/04/14 01:45:32 Successfully connect all nodes
2022/04/14 01:45:32 Successfully connect all nodes
2022/04/14 01:45:32 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:45:35 Receive propose from client
2022/04/14 01:45:35 Receive propose from client
2022/04/14 01:45:35 Receive propose from client
2022/04/14 01:45:35 Receive propose from client
2022/04/14 01:45:35 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1727359426>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1727359426>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1727359426>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1727359426>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1727359426 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:1], nextIndex :map[1:2 2:1 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58163 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58164 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58165 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58166 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58167 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58169 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58172 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:45:37 Start listening to port: 19390
2022/04/14 01:45:37 Start listening to port: 19654
2022/04/14 01:45:37 Start listening to port: 17257
2022/04/14 01:45:37 Start listening to port: 10668
2022/04/14 01:45:37 Start listening to port: 10709
2022/04/14 01:45:37 Successfully connect all nodes
2022/04/14 01:45:37 Successfully connect all nodes
2022/04/14 01:45:37 Successfully connect all nodes
2022/04/14 01:45:37 Successfully connect all nodes
2022/04/14 01:45:37 Successfully connect all nodes
Running testOneSimpleUpdate:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:45:41 Receive propose from client
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1566648977>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1566648977>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1566648977 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:45:41 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1183619411>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1566648977>,t1:put<test,1183619411>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1566648977>,t1:put<test,1183619411>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1183619411>], leaderCommit: 1
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:2], nextIndex :map[1:2 2:2 3:1 4:3] 
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1566648977  Term:1 Key:"test" Value:1183619411 ], kvStore: map[test:1566648977]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:2], nextIndex :map[1:2 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58253 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58254 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58255 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58256 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58257 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58259 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58260 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58261 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58262 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:45:43 Start listening to port: 17257
2022/04/14 01:45:43 Start listening to port: 19654
2022/04/14 01:45:43 Start listening to port: 10668
2022/04/14 01:45:43 Start listening to port: 10709
2022/04/14 01:45:43 Start listening to port: 19390
2022/04/14 01:45:43 Successfully connect all nodes
2022/04/14 01:45:43 Successfully connect all nodes
2022/04/14 01:45:43 Successfully connect all nodes
2022/04/14 01:45:43 Successfully connect all nodes
2022/04/14 01:45:43 Successfully connect all nodes
Running testOneSimpleDelete:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:45:47 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,279673658>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:45:48 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,279673658>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:279673658  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,279673658>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,279673658>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:279673658  Term:1 Op:Delete Key:"test" ], kvStore: map[test:279673658]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58343 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58344 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58345 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58346 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58347 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58349 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58350 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58351 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58352 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 01:45:50 Start listening to port: 19390
node 3 Proxy started
2022/04/14 01:45:50 Start listening to port: 19654
2022/04/14 01:45:50 Start listening to port: 17257
2022/04/14 01:45:50 Start listening to port: 10709
2022/04/14 01:45:50 Start listening to port: 10668
2022/04/14 01:45:50 Successfully connect all nodes
2022/04/14 01:45:50 Successfully connect all nodes
2022/04/14 01:45:50 Successfully connect all nodes
2022/04/14 01:45:50 Successfully connect all nodes
2022/04/14 01:45:50 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:45:54 Receive propose from client
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:45:55 Receive propose from client
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,62647715>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 当前的commitNum是:2
2当前leder的commit次数是:0

响应成功。更新之后：rn.nextIndex[hostId]： 3
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:62647715  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:62647715  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:62647715]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58443 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58444 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58445 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58446 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58447 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58449 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58450 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58451 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 58452 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:45:11 testOneCandidateOneRoundElection PASS
2022/04/14 01:45:15 testOneCandidateStartTwoElection PASS
2022/04/14 01:45:20 testTwoCandidateForElection PASS
2022/04/14 01:45:25 testSplitVote PASS
2022/04/14 01:45:29 testAllForElection PASS
2022/04/14 01:45:32 testLeaderRevertToFollower PASS
2022/04/14 01:45:37 testOneSimplePut PASS
2022/04/14 01:45:43 testOneSimpleUpdate PASS
2022/04/14 01:45:50 testOneSimpleDelete PASS
2022/04/14 01:45:57 testDeleteNonExistKey PASS

11
2022-04-14 01:46:02
All real ports: 16829 19038 17725 17999 19916
All proxy ports: 12174 13537 15278 19520 15806
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:46:04 Start listening to port: 17999
2022/04/14 01:46:04 Start listening to port: 17725
2022/04/14 01:46:04 Start listening to port: 19916
2022/04/14 01:46:04 Start listening to port: 19038
2022/04/14 01:46:04 Start listening to port: 16829
2022/04/14 01:46:04 Successfully connect all nodes
2022/04/14 01:46:04 Successfully connect all nodes
2022/04/14 01:46:04 Successfully connect all nodes
2022/04/14 01:46:04 Successfully connect all nodes
2022/04/14 01:46:04 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59332 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59335 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59336 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59337 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59338 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59340 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59341 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59342 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59343 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:46:07 Start listening to port: 19038
2022/04/14 01:46:07 Start listening to port: 16829
2022/04/14 01:46:07 Start listening to port: 17725
2022/04/14 01:46:07 Start listening to port: 17999
2022/04/14 01:46:07 Start listening to port: 19916
2022/04/14 01:46:07 Successfully connect all nodes
2022/04/14 01:46:07 Successfully connect all nodes
2022/04/14 01:46:07 Successfully connect all nodes
2022/04/14 01:46:07 Successfully connect all nodes
2022/04/14 01:46:07 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59416 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59417 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59418 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59419 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59420 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59423 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59424 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59425 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:46:11 Start listening to port: 16829
node 2 Proxy started
2022/04/14 01:46:11 Start listening to port: 19038
node 4 Proxy started
2022/04/14 01:46:11 Start listening to port: 17725
2022/04/14 01:46:11 Start listening to port: 17999
2022/04/14 01:46:11 Start listening to port: 19916
2022/04/14 01:46:11 Successfully connect all nodes
2022/04/14 01:46:11 Successfully connect all nodes
2022/04/14 01:46:11 Successfully connect all nodes
2022/04/14 01:46:11 Successfully connect all nodes
2022/04/14 01:46:11 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
1node 0 -> 2: reject, term: 1

node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 2: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
2022/04/14 01:46:16 Start listening to port: 19038
2022/04/14 01:46:16 Start listening to port: 17999
node 4 Proxy started
2022/04/14 01:46:16 Start listening to port: 17725
node 2 Proxy started
2022/04/14 01:46:16 Start listening to port: 19916
node 0 Proxy started
2022/04/14 01:46:16 Start listening to port: 16829
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:46:17 Successfully connect all nodes
2022/04/14 01:46:17 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:46:17 Successfully connect all nodes
2022/04/14 01:46:17 Successfully connect all nodes
2022/04/14 01:46:17 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59583 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59584 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59585 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59586 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59587 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59589 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59590 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59591 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59592 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:46:22 Start listening to port: 19038
2022/04/14 01:46:22 Start listening to port: 17999
2022/04/14 01:46:22 Start listening to port: 17725
2022/04/14 01:46:22 Start listening to port: 16829
node 1 Proxy started
2022/04/14 01:46:22 Start listening to port: 19916
2022/04/14 01:46:22 Successfully connect all nodes
2022/04/14 01:46:22 Successfully connect all nodes
2022/04/14 01:46:22 Successfully connect all nodes
2022/04/14 01:46:22 Successfully connect all nodes
2022/04/14 01:46:22 Successfully connect all nodes
Running testAllForElection:
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 3 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0node 1 -> 4: granted, term: 2

初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 4: granted, term: 2
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59666 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59667 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59668 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59669 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59670 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59672 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59673 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59674 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59675 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:46:26 Start listening to port: 16829
2022/04/14 01:46:26 Start listening to port: 19038
node 4 Proxy started
2022/04/14 01:46:26 Start listening to port: 17725
2022/04/14 01:46:26 Start listening to port: 17999
2022/04/14 01:46:26 Start listening to port: 19916
2022/04/14 01:46:26 Successfully connect all nodes
2022/04/14 01:46:26 Successfully connect all nodes
2022/04/14 01:46:26 Successfully connect all nodes
2022/04/14 01:46:26 Successfully connect all nodes
2022/04/14 01:46:26 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0

初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: reject, term: 1
01:46:29.178865 rafttest.go:262: FAIL: error on testLeaderRevertToFollower3 - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
But get:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: reject, term: 1
testLeaderRevertToFollower FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59776 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59777 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59778 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59779 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59780 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59785 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59786 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59787 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59788 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:46:29 Start listening to port: 16829
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:46:29 Start listening to port: 19038
2022/04/14 01:46:29 Start listening to port: 17725
2022/04/14 01:46:29 Start listening to port: 17999
2022/04/14 01:46:29 Start listening to port: 19916
2022/04/14 01:46:29 Successfully connect all nodes
2022/04/14 01:46:29 Successfully connect all nodes
2022/04/14 01:46:29 Successfully connect all nodes
2022/04/14 01:46:29 Successfully connect all nodes
2022/04/14 01:46:29 Successfully connect all nodes
Running testOneSimplePut:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:46:32 Receive propose from client
2022/04/14 01:46:32 Receive propose from client
2022/04/14 01:46:32 Receive propose from client
2022/04/14 01:46:32 Receive propose from client
2022/04/14 01:46:32 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,684913088>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,684913088>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,684913088>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,684913088>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:684913088 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:0], nextIndex :map[1:1 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59860 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59861 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59862 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59863 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59864 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59867 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59868 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59869 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:46:34 Start listening to port: 16829
node 4 Proxy started
2022/04/14 01:46:34 Start listening to port: 17725
2022/04/14 01:46:34 Start listening to port: 17999
node 3 Proxy started
2022/04/14 01:46:34 Start listening to port: 19038
2022/04/14 01:46:34 Successfully connect all nodes
2022/04/14 01:46:34 Successfully connect all nodes
2022/04/14 01:46:34 Successfully connect all nodes
2022/04/14 01:46:34 Start listening to port: 19916
2022/04/14 01:46:34 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:46:34 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:46:37 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,176799999>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,176799999>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:176799999 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:46:38 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1416451381>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,176799999>,t1:put<test,1416451381>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1416451381>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,176799999>,t1:put<test,1416451381>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3当前的commitNum是:2

当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:176799999  Term:1 Key:"test" Value:1416451381 ], kvStore: map[test:176799999]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59942 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59943 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59944 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59945 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59946 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59949 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59950 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 59951 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:46:40 Start listening to port: 19038
2022/04/14 01:46:40 Start listening to port: 16829
node 3 Proxy started
2022/04/14 01:46:40 Start listening to port: 17725
2022/04/14 01:46:40 Start listening to port: 17999
node 4 Proxy started
2022/04/14 01:46:40 Start listening to port: 19916
2022/04/14 01:46:40 Successfully connect all nodes
2022/04/14 01:46:40 Successfully connect all nodes
2022/04/14 01:46:40 Successfully connect all nodes
2022/04/14 01:46:40 Successfully connect all nodes
2022/04/14 01:46:40 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:46:43 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1994215310>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:46:44 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1994215310>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1994215310  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1994215310>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1994215310>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
当前的commitNum是:2
当前leder的commit次数是:0
node 3 -> 0: success, term: 1, matchIdx: 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1994215310  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1994215310]  
响应成功。更新之后：rn.matchIndex[hostId]： node 1 -> 0: success, term: 1, matchIdx: 2
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60025 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60026 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60027 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60028 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60029 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60031 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60032 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60033 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60034 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 01:46:47 Start listening to port: 16829
node 1 Proxy started
2022/04/14 01:46:47 Start listening to port: 19038
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:46:47 Start listening to port: 17725
2022/04/14 01:46:47 Start listening to port: 17999
2022/04/14 01:46:47 Start listening to port: 19916
2022/04/14 01:46:47 Successfully connect all nodes
2022/04/14 01:46:47 Successfully connect all nodes
2022/04/14 01:46:47 Successfully connect all nodes
2022/04/14 01:46:47 Successfully connect all nodes
2022/04/14 01:46:47 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:46:50 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:46:51 Receive propose from client
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1648917611>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1648917611  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1648917611  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60110 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 60113 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
2022/04/14 01:46:07 testOneCandidateOneRoundElection PASS
2022/04/14 01:46:11 testOneCandidateStartTwoElection PASS
2022/04/14 01:46:16 testTwoCandidateForElection PASS
2022/04/14 01:46:22 testSplitVote PASS
2022/04/14 01:46:26 testAllForElection PASS
2022/04/14 01:46:29 testLeaderRevertToFollower FAIL
2022/04/14 01:46:34 testOneSimplePut PASS
2022/04/14 01:46:40 testOneSimpleUpdate PASS
2022/04/14 01:46:47 testOneSimpleDelete PASS
2022/04/14 01:46:54 testDeleteNonExistKey PASS

12
2022-04-14 01:46:59
All real ports: 14532 13922 17516 10354 15355
All proxy ports: 10291 12034 15776 16305 12854
node 4 Proxy started
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 2 Proxy started
Running testOneCandidateOneRoundElection:
2022/04/14 01:47:01 Start listening to port: 17516
2022/04/14 01:47:01 Start listening to port: 15355
2022/04/14 01:47:01 Start listening to port: 14532
2022/04/14 01:47:01 Start listening to port: 13922
2022/04/14 01:47:01 Start listening to port: 10354
2022/04/14 01:47:01 Successfully connect all nodes
2022/04/14 01:47:01 Successfully connect all nodes
2022/04/14 01:47:01 Successfully connect all nodes
2022/04/14 01:47:01 Successfully connect all nodes
2022/04/14 01:47:01 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61072 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61073 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61074 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61075 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61076 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61078 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61079 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61080 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61081 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:47:04 Start listening to port: 13922
2022/04/14 01:47:04 Start listening to port: 14532
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:47:04 Start listening to port: 10354
2022/04/14 01:47:04 Start listening to port: 15355
2022/04/14 01:47:04 Start listening to port: 17516
2022/04/14 01:47:04 Successfully connect all nodes
2022/04/14 01:47:04 Successfully connect all nodes
2022/04/14 01:47:04 Successfully connect all nodes
2022/04/14 01:47:04 Successfully connect all nodes
2022/04/14 01:47:04 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61162 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61163 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61164 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61165 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61166 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61168 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61169 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61170 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61171 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:47:08 Start listening to port: 14532
2022/04/14 01:47:08 Start listening to port: 17516
2022/04/14 01:47:08 Start listening to port: 13922
2022/04/14 01:47:08 Start listening to port: 10354
2022/04/14 01:47:08 Start listening to port: 15355
2022/04/14 01:47:08 Successfully connect all nodes
2022/04/14 01:47:08 Successfully connect all nodes
2022/04/14 01:47:08 Successfully connect all nodes
2022/04/14 01:47:08 Successfully connect all nodes
2022/04/14 01:47:08 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61251 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61252 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61253 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61254 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61255 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61257 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61258 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61259 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61261 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:47:14 Start listening to port: 14532
node 3 Proxy started
2022/04/14 01:47:14 Start listening to port: 13922
node 4 Proxy started
2022/04/14 01:47:14 Start listening to port: 17516
2022/04/14 01:47:14 Start listening to port: 10354
2022/04/14 01:47:14 Start listening to port: 15355
2022/04/14 01:47:14 Successfully connect all nodes
2022/04/14 01:47:14 Successfully connect all nodes
2022/04/14 01:47:14 Successfully connect all nodes
2022/04/14 01:47:14 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:47:15 Successfully connect all nodes
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61338 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61340 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61342 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61343 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61344 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61345 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:47:18 Start listening to port: 14532
node 4 Proxy started
2022/04/14 01:47:18 Start listening to port: 13922
2022/04/14 01:47:18 Start listening to port: 10354
2022/04/14 01:47:18 Start listening to port: 15355
2022/04/14 01:47:18 Start listening to port: 17516
2022/04/14 01:47:18 Successfully connect all nodes
2022/04/14 01:47:18 Successfully connect all nodes
2022/04/14 01:47:18 Successfully connect all nodes
2022/04/14 01:47:18 Successfully connect all nodes
2022/04/14 01:47:18 Successfully connect all nodes
Running testAllForElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 1 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 1 -> 2: reject, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 4: granted, term: 2
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61425 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61429 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61430 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61431 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61432 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
2022/04/14 01:47:22 Start listening to port: 17516
node 1 Proxy started
2022/04/14 01:47:22 Start listening to port: 15355
2022/04/14 01:47:22 Start listening to port: 14532
2022/04/14 01:47:22 Start listening to port: 13922
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:47:22 Start listening to port: 10354
2022/04/14 01:47:22 Successfully connect all nodes
2022/04/14 01:47:23 Successfully connect all nodes
2022/04/14 01:47:23 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 01:47:23 Successfully connect all nodes
2022/04/14 01:47:23 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61520 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61521 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61522 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61523 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61524 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61526 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61527 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61528 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61529 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:47:26 Start listening to port: 14532
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:47:26 Start listening to port: 17516
2022/04/14 01:47:26 Start listening to port: 13922
2022/04/14 01:47:26 Start listening to port: 10354
2022/04/14 01:47:26 Start listening to port: 15355
2022/04/14 01:47:26 Successfully connect all nodes
2022/04/14 01:47:26 Successfully connect all nodes
2022/04/14 01:47:26 Successfully connect all nodes
2022/04/14 01:47:26 Successfully connect all nodes
2022/04/14 01:47:26 Successfully connect all nodes
Running testOneSimplePut:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:47:30 Receive propose from client
2022/04/14 01:47:30 Receive propose from client
2022/04/14 01:47:30 Receive propose from client
2022/04/14 01:47:30 Receive propose from client
2022/04/14 01:47:30 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,914882000>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,914882000>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,914882000>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,914882000>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:914882000 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61625 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61626 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61627 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61628 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61629 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61631 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61632 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61633 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61634 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:47:31 Start listening to port: 14532
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:47:31 Start listening to port: 13922
node 1 Proxy started
2022/04/14 01:47:31 Start listening to port: 10354
2022/04/14 01:47:31 Start listening to port: 15355
2022/04/14 01:47:31 Start listening to port: 17516
2022/04/14 01:47:31 Successfully connect all nodes
2022/04/14 01:47:31 Successfully connect all nodes
2022/04/14 01:47:31 Successfully connect all nodes
2022/04/14 01:47:31 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:47:32 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:47:35 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1118573491>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1118573491>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1118573491 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:47:35 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1118573491>,t1:put<test,1414446325>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1414446325>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1118573491>,t1:put<test,1414446325>], leaderCommit: 1
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1414446325>], leaderCommit: 1
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
当前的commitNum是:1
开始更新自己节点的kvStore
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 3 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:2], nextIndex :map[1:2 2:2 3:1 4:3] 
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1118573491  Term:1 Key:"test" Value:1414446325 ], kvStore: map[test:1118573491]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:2], nextIndex :map[1:2 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61713 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61714 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61715 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61716 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61717 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61721 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61722 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61723 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:47:37 Start listening to port: 14532
2022/04/14 01:47:37 Start listening to port: 13922
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:47:37 Start listening to port: 10354
2022/04/14 01:47:37 Start listening to port: 17516
2022/04/14 01:47:37 Start listening to port: 15355
2022/04/14 01:47:37 Successfully connect all nodes
2022/04/14 01:47:37 Successfully connect all nodes
2022/04/14 01:47:37 Successfully connect all nodes
2022/04/14 01:47:37 Successfully connect all nodes
2022/04/14 01:47:37 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:47:41 Receive propose from client
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,900720851>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:47:42 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,900720851>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:900720851  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,900720851>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,900720851>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:900720851  Term:1 Op:Delete Key:"test" ], kvStore: map[test:900720851]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61798 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61799 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61800 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61801 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61802 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61804 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61805 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61806 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61807 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:47:44 Start listening to port: 14532
2022/04/14 01:47:44 Start listening to port: 17516
2022/04/14 01:47:44 Start listening to port: 13922
node 2 Proxy started
2022/04/14 01:47:44 Start listening to port: 15355
2022/04/14 01:47:44 Start listening to port: 10354
2022/04/14 01:47:44 Successfully connect all nodes
2022/04/14 01:47:44 Successfully connect all nodes
2022/04/14 01:47:44 Successfully connect all nodes
2022/04/14 01:47:44 Successfully connect all nodes
2022/04/14 01:47:44 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:47:48 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:47:49 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1149851409>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1149851409  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1149851409  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1149851409]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61883 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61884 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61885 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61886 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61887 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 61889 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
2022/04/14 01:47:04 testOneCandidateOneRoundElection PASS
2022/04/14 01:47:08 testOneCandidateStartTwoElection PASS
2022/04/14 01:47:13 testTwoCandidateForElection PASS
2022/04/14 01:47:18 testSplitVote PASS
2022/04/14 01:47:22 testAllForElection PASS
2022/04/14 01:47:26 testLeaderRevertToFollower PASS
2022/04/14 01:47:31 testOneSimplePut PASS
2022/04/14 01:47:37 testOneSimpleUpdate PASS
2022/04/14 01:47:44 testOneSimpleDelete PASS
2022/04/14 01:47:52 testDeleteNonExistKey PASS

13
2022-04-14 01:47:57
All real ports: 17564 12912 17921 11791 13717
All proxy ports: 19181 17168 16457 16223 10259
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 01:47:59 Start listening to port: 17564
2022/04/14 01:47:59 Start listening to port: 13717
2022/04/14 01:47:59 Start listening to port: 17921
2022/04/14 01:47:59 Start listening to port: 12912
2022/04/14 01:47:59 Start listening to port: 11791
2022/04/14 01:47:59 Successfully connect all nodes
2022/04/14 01:47:59 Successfully connect all nodes
2022/04/14 01:47:59 Successfully connect all nodes
2022/04/14 01:47:59 Successfully connect all nodes
2022/04/14 01:47:59 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62779 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62780 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62781 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62782 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62783 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62785 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62786 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62787 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62788 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:48:02 Start listening to port: 17564
2022/04/14 01:48:02 Start listening to port: 17921
2022/04/14 01:48:02 Start listening to port: 12912
node 4 Proxy started
2022/04/14 01:48:02 Start listening to port: 11791
2022/04/14 01:48:02 Start listening to port: 13717
2022/04/14 01:48:02 Successfully connect all nodes
2022/04/14 01:48:02 Successfully connect all nodes
2022/04/14 01:48:02 Successfully connect all nodes
2022/04/14 01:48:02 Successfully connect all nodes
2022/04/14 01:48:02 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62861 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62863 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62864 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62866 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62867 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62868 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62869 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:48:06 Start listening to port: 17564
2022/04/14 01:48:06 Start listening to port: 11791
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:48:06 Start listening to port: 17921
2022/04/14 01:48:06 Start listening to port: 12912
node 3 Proxy started
2022/04/14 01:48:06 Start listening to port: 13717
2022/04/14 01:48:06 Successfully connect all nodes
2022/04/14 01:48:06 Successfully connect all nodes
2022/04/14 01:48:06 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:48:07 Successfully connect all nodes
2022/04/14 01:48:07 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3: dropped RequestVote from 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62941 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62942 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62943 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62944 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62945 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62947 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62948 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62949 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 62950 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 01:48:11 Start listening to port: 17564
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:48:11 Start listening to port: 17921
node 1 Proxy started
2022/04/14 01:48:11 Start listening to port: 12912
2022/04/14 01:48:11 Start listening to port: 13717
2022/04/14 01:48:11 Start listening to port: 11791
2022/04/14 01:48:11 Successfully connect all nodes
2022/04/14 01:48:11 Successfully connect all nodes
2022/04/14 01:48:11 Successfully connect all nodes
2022/04/14 01:48:11 Successfully connect all nodes
2022/04/14 01:48:11 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63024 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63025 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63026 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63027 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63028 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63030 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63031 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63032 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63033 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:48:16 Start listening to port: 17564
node 4 Proxy started
2022/04/14 01:48:16 Start listening to port: 17921
node 3 Proxy started
2022/04/14 01:48:16 Start listening to port: 11791
2022/04/14 01:48:16 Start listening to port: 13717
node 1 Proxy started
2022/04/14 01:48:16 Start listening to port: 12912
2022/04/14 01:48:16 Successfully connect all nodes
2022/04/14 01:48:16 Successfully connect all nodes
Running testAllForElection:
2022/04/14 01:48:17 Successfully connect all nodes
2022/04/14 01:48:17 Successfully connect all nodes
2022/04/14 01:48:17 Successfully connect all nodes
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 2 -> 4: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 3: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 4: granted, term: 2
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63110 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63113 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63114 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63116 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63117 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63118 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63119 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:48:19 Start listening to port: 17564
2022/04/14 01:48:19 Start listening to port: 12912
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:48:19 Start listening to port: 13717
2022/04/14 01:48:19 Start listening to port: 11791
2022/04/14 01:48:19 Start listening to port: 17921
node 4 Proxy started
2022/04/14 01:48:19 Successfully connect all nodes
2022/04/14 01:48:19 Successfully connect all nodes
2022/04/14 01:48:19 Successfully connect all nodes
2022/04/14 01:48:19 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 01:48:20 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63209 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63210 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63211 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63212 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63213 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63216 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63217 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63218 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:48:23 Start listening to port: 12912
2022/04/14 01:48:23 Start listening to port: 17564
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:48:23 Start listening to port: 17921
2022/04/14 01:48:23 Start listening to port: 11791
2022/04/14 01:48:23 Start listening to port: 13717
2022/04/14 01:48:23 Successfully connect all nodes
2022/04/14 01:48:23 Successfully connect all nodes
2022/04/14 01:48:23 Successfully connect all nodes
2022/04/14 01:48:23 Successfully connect all nodes
2022/04/14 01:48:23 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:48:26 Receive propose from client
2022/04/14 01:48:26 Receive propose from client
2022/04/14 01:48:26 Receive propose from client
2022/04/14 01:48:26 Receive propose from client
2022/04/14 01:48:26 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1000720926>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1000720926>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1000720926>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1000720926>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1000720926 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:1], nextIndex :map[1:2 2:1 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63294 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63295 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63296 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63297 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63298 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63300 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63301 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63302 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63303 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:48:28 Start listening to port: 17564
2022/04/14 01:48:28 Start listening to port: 12912
2022/04/14 01:48:28 Start listening to port: 11791
2022/04/14 01:48:28 Start listening to port: 17921
2022/04/14 01:48:28 Start listening to port: 13717
2022/04/14 01:48:28 Successfully connect all nodes
2022/04/14 01:48:28 Successfully connect all nodes
2022/04/14 01:48:28 Successfully connect all nodes
2022/04/14 01:48:28 Successfully connect all nodes
2022/04/14 01:48:28 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:48:31 Receive propose from client
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1020223434>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1020223434>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1020223434 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:48:32 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,379822314>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1020223434>,t1:put<test,379822314>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,379822314>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1020223434>,t1:put<test,379822314>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
node 4 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
node 3 -> 0: success, term: 1, matchIdx: 2
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1020223434  Term:1 Key:"test" Value:379822314 ], kvStore: map[test:1020223434]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63385 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63386 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63387 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63388 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63389 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63392 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63393 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63394 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:48:34 Start listening to port: 17564
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:48:34 Start listening to port: 12912
2022/04/14 01:48:34 Start listening to port: 17921
2022/04/14 01:48:34 Start listening to port: 11791
2022/04/14 01:48:34 Start listening to port: 13717
2022/04/14 01:48:34 Successfully connect all nodes
2022/04/14 01:48:34 Successfully connect all nodes
2022/04/14 01:48:34 Successfully connect all nodes
2022/04/14 01:48:34 Successfully connect all nodes
2022/04/14 01:48:34 Successfully connect all nodes
Running testOneSimpleDelete:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:48:37 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1383244399>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:48:38 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1383244399>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1383244399  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1383244399>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1383244399>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1383244399  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1383244399]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63469 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63470 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63472 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63473 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:48:41 Start listening to port: 17564
2022/04/14 01:48:41 Start listening to port: 11791
2022/04/14 01:48:41 Start listening to port: 17921
2022/04/14 01:48:41 Start listening to port: 12912
2022/04/14 01:48:41 Start listening to port: 13717
2022/04/14 01:48:41 Successfully connect all nodes
2022/04/14 01:48:41 Successfully connect all nodes
2022/04/14 01:48:41 Successfully connect all nodes
2022/04/14 01:48:41 Successfully connect all nodes
2022/04/14 01:48:41 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:48:45 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:48:46 Receive propose from client
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1763031236>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1763031236  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1763031236  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63557 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63558 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63559 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63560 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63561 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63563 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63564 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63565 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 63566 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:48:02 testOneCandidateOneRoundElection PASS
2022/04/14 01:48:06 testOneCandidateStartTwoElection PASS
2022/04/14 01:48:11 testTwoCandidateForElection PASS
2022/04/14 01:48:16 testSplitVote PASS
2022/04/14 01:48:19 testAllForElection PASS
2022/04/14 01:48:23 testLeaderRevertToFollower PASS
2022/04/14 01:48:28 testOneSimplePut PASS
2022/04/14 01:48:34 testOneSimpleUpdate PASS
2022/04/14 01:48:41 testOneSimpleDelete PASS
2022/04/14 01:48:48 testDeleteNonExistKey PASS

14
2022-04-14 01:48:53
All real ports: 13619 19748 12202 10742 17780
All proxy ports: 19445 19897 17722 17767 12003
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:48:57 Start listening to port: 12202
2022/04/14 01:48:57 Start listening to port: 13619
2022/04/14 01:48:57 Start listening to port: 17780
2022/04/14 01:48:57 Start listening to port: 19748
2022/04/14 01:48:57 Start listening to port: 10742
2022/04/14 01:48:57 Successfully connect all nodes
2022/04/14 01:48:57 Successfully connect all nodes
2022/04/14 01:48:57 Successfully connect all nodes
2022/04/14 01:48:57 Successfully connect all nodes
2022/04/14 01:48:57 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64447 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64448 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64449 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64450 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64451 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64453 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64454 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64455 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64456 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 4 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:49:00 Start listening to port: 13619
2022/04/14 01:49:00 Start listening to port: 12202
2022/04/14 01:49:00 Start listening to port: 19748
2022/04/14 01:49:00 Start listening to port: 10742
2022/04/14 01:49:00 Start listening to port: 17780
2022/04/14 01:49:00 Successfully connect all nodes
2022/04/14 01:49:00 Successfully connect all nodes
2022/04/14 01:49:00 Successfully connect all nodes
2022/04/14 01:49:00 Successfully connect all nodes
2022/04/14 01:49:00 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64526 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64527 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64528 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64529 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64530 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64532 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64533 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64534 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64535 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:49:04 Start listening to port: 13619
node 1 Proxy started
2022/04/14 01:49:04 Start listening to port: 19748
2022/04/14 01:49:04 Start listening to port: 12202
node 3 Proxy started
2022/04/14 01:49:04 Start listening to port: 10742
2022/04/14 01:49:04 Start listening to port: 17780
2022/04/14 01:49:04 Successfully connect all nodes
2022/04/14 01:49:04 Successfully connect all nodes
2022/04/14 01:49:04 Successfully connect all nodes
2022/04/14 01:49:04 Successfully connect all nodes
2022/04/14 01:49:04 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64609 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64612 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64613 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64615 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64616 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64617 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 64610 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 64618 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:49:09 Start listening to port: 12202
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:49:09 Start listening to port: 19748
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:49:09 Start listening to port: 13619
2022/04/14 01:49:09 Start listening to port: 17780
2022/04/14 01:49:09 Successfully connect all nodes
2022/04/14 01:49:09 Successfully connect all nodes
2022/04/14 01:49:09 Successfully connect all nodes
2022/04/14 01:49:09 Start listening to port: 10742
2022/04/14 01:49:09 Successfully connect all nodes
2022/04/14 01:49:10 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64693 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64694 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64695 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64696 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64697 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64699 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64701 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64702 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:49:15 Start listening to port: 13619
node 2 Proxy started
2022/04/14 01:49:15 Start listening to port: 12202
2022/04/14 01:49:15 Start listening to port: 17780
2022/04/14 01:49:15 Start listening to port: 19748
2022/04/14 01:49:15 Start listening to port: 10742
2022/04/14 01:49:15 Successfully connect all nodes
2022/04/14 01:49:15 Successfully connect all nodes
2022/04/14 01:49:15 Successfully connect all nodes
2022/04/14 01:49:15 Successfully connect all nodes
2022/04/14 01:49:15 Successfully connect all nodes
Running testAllForElection:
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 -> 2: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 4: granted, term: 2
1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64780 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64781 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64782 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64783 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64784 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64786 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64787 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64788 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64789 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:49:18 Start listening to port: 13619
node 2 Proxy started
2022/04/14 01:49:18 Start listening to port: 19748
2022/04/14 01:49:18 Start listening to port: 12202
2022/04/14 01:49:18 Start listening to port: 17780
2022/04/14 01:49:18 Start listening to port: 10742
2022/04/14 01:49:18 Successfully connect all nodes
2022/04/14 01:49:18 Successfully connect all nodes
2022/04/14 01:49:18 Successfully connect all nodes
2022/04/14 01:49:18 Successfully connect all nodes
2022/04/14 01:49:18 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64878 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64879 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64880 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64881 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64882 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64884 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64885 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64886 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64887 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:49:22 Start listening to port: 19748
2022/04/14 01:49:22 Start listening to port: 12202
2022/04/14 01:49:22 Start listening to port: 13619
2022/04/14 01:49:22 Start listening to port: 10742
2022/04/14 01:49:22 Start listening to port: 17780
2022/04/14 01:49:22 Successfully connect all nodes
2022/04/14 01:49:22 Successfully connect all nodes
2022/04/14 01:49:22 Successfully connect all nodes
2022/04/14 01:49:22 Successfully connect all nodes
2022/04/14 01:49:22 Successfully connect all nodes
Running testOneSimplePut:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:49:25 Receive propose from client
2022/04/14 01:49:25 Receive propose from client
2022/04/14 01:49:25 Receive propose from client
2022/04/14 01:49:25 Receive propose from client
2022/04/14 01:49:25 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,540704637>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,540704637>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,540704637>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,540704637>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:540704637 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64968 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64969 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64970 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64971 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64972 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64974 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64975 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64976 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 64978 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 4 Proxy started
2022/04/14 01:49:27 Start listening to port: 12202
node 1 Proxy started
2022/04/14 01:49:27 Start listening to port: 17780
2022/04/14 01:49:27 Start listening to port: 10742
2022/04/14 01:49:27 Start listening to port: 19748
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:49:27 Start listening to port: 13619
node 2 Proxy started
2022/04/14 01:49:27 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:49:28 Successfully connect all nodes
2022/04/14 01:49:28 Successfully connect all nodes
2022/04/14 01:49:28 Successfully connect all nodes
2022/04/14 01:49:28 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:49:30 Receive propose from client
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1754783268>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1754783268>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1754783268 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:49:31 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,885299214>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,885299214>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1754783268>,t1:put<test,885299214>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1754783268>,t1:put<test,885299214>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
node 1 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
node 3 -> 0: success, term: 1, matchIdx: 2
commit日志之后，当前的leader的rn.commitIndex为:
 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1754783268  Term:1 Key:"test" Value:885299214 ], kvStore: map[test:1754783268]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 

响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65059 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65060 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65061 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65062 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65063 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65065 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65066 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65067 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65068 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:49:33 Start listening to port: 19748
2022/04/14 01:49:33 Start listening to port: 13619
node 3 Proxy started
2022/04/14 01:49:33 Start listening to port: 10742
2022/04/14 01:49:33 Start listening to port: 12202
2022/04/14 01:49:33 Start listening to port: 17780
2022/04/14 01:49:33 Successfully connect all nodes
2022/04/14 01:49:33 Successfully connect all nodes
2022/04/14 01:49:33 Successfully connect all nodes
2022/04/14 01:49:33 Successfully connect all nodes
2022/04/14 01:49:33 Successfully connect all nodes
Running testOneSimpleDelete:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:49:36 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2071058105>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:49:37 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2071058105>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2071058105  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2071058105>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2071058105>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2071058105  Term:1 Op:Delete Key:"test" ], kvStore: map[test:2071058105]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65145 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65146 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65147 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65148 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65149 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65151 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65152 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65153 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65154 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:49:40 Start listening to port: 13619
2022/04/14 01:49:40 Start listening to port: 19748
2022/04/14 01:49:40 Start listening to port: 10742
2022/04/14 01:49:40 Start listening to port: 17780
2022/04/14 01:49:40 Start listening to port: 12202
2022/04/14 01:49:40 Successfully connect all nodes
2022/04/14 01:49:40 Successfully connect all nodes
2022/04/14 01:49:40 Successfully connect all nodes
2022/04/14 01:49:40 Successfully connect all nodes
2022/04/14 01:49:40 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:49:43 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:49:44 Receive propose from client
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,118066481>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:118066481  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:0 4:2], nextIndex :map[1:1 2:3 3:1 4:3] 

当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:118066481  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:118066481]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65231 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65232 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65233 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65234 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65235 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65239 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65240 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 65241 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:49:00 testOneCandidateOneRoundElection PASS
2022/04/14 01:49:04 testOneCandidateStartTwoElection PASS
2022/04/14 01:49:09 testTwoCandidateForElection PASS
2022/04/14 01:49:14 testSplitVote PASS
2022/04/14 01:49:18 testAllForElection PASS
2022/04/14 01:49:22 testLeaderRevertToFollower PASS
2022/04/14 01:49:27 testOneSimplePut PASS
2022/04/14 01:49:33 testOneSimpleUpdate PASS
2022/04/14 01:49:40 testOneSimpleDelete PASS
2022/04/14 01:49:47 testDeleteNonExistKey PASS

15
2022-04-14 01:49:52
All real ports: 14812 17519 18968 11828 11055
All proxy ports: 15916 17658 19942 12426 17438
node 2 Proxy started
node 3 Proxy started
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:49:55 Start listening to port: 18968
2022/04/14 01:49:55 Start listening to port: 11055
2022/04/14 01:49:55 Start listening to port: 17519
2022/04/14 01:49:55 Start listening to port: 14812
2022/04/14 01:49:55 Start listening to port: 11828
2022/04/14 01:49:55 Successfully connect all nodes
2022/04/14 01:49:55 Successfully connect all nodes
2022/04/14 01:49:55 Successfully connect all nodes
2022/04/14 01:49:55 Successfully connect all nodes
2022/04/14 01:49:55 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66113 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66114 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66115 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66116 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66117 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66119 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66120 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66121 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66122 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:49:58 Start listening to port: 17519
2022/04/14 01:49:58 Start listening to port: 14812
2022/04/14 01:49:58 Start listening to port: 18968
2022/04/14 01:49:58 Start listening to port: 11828
2022/04/14 01:49:58 Start listening to port: 11055
2022/04/14 01:49:58 Successfully connect all nodes
2022/04/14 01:49:58 Successfully connect all nodes
2022/04/14 01:49:58 Successfully connect all nodes
2022/04/14 01:49:58 Successfully connect all nodes
2022/04/14 01:49:58 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66198 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66199 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66200 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66201 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66202 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66205 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66206 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66207 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:50:02 Start listening to port: 14812
node 4 Proxy started
2022/04/14 01:50:02 Start listening to port: 17519
2022/04/14 01:50:02 Start listening to port: 11828
2022/04/14 01:50:02 Start listening to port: 11055
2022/04/14 01:50:02 Start listening to port: 18968
2022/04/14 01:50:02 Successfully connect all nodes
2022/04/14 01:50:02 Successfully connect all nodes
2022/04/14 01:50:02 Successfully connect all nodes
2022/04/14 01:50:02 Successfully connect all nodes
2022/04/14 01:50:02 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66288 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66289 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66290 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66291 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66292 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66295 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66296 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66297 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:50:07 Start listening to port: 14812
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:50:07 Start listening to port: 17519
node 4 Proxy started
2022/04/14 01:50:07 Start listening to port: 11828
2022/04/14 01:50:07 Start listening to port: 18968
2022/04/14 01:50:07 Start listening to port: 11055
2022/04/14 01:50:07 Successfully connect all nodes
2022/04/14 01:50:07 Successfully connect all nodes
2022/04/14 01:50:07 Successfully connect all nodes
2022/04/14 01:50:07 Successfully connect all nodes
2022/04/14 01:50:07 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: node 0 -> 3: granted, term: 2
0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66376 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66377 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66378 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66379 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66380 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66382 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66383 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66384 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66385 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
2022/04/14 01:50:12 Start listening to port: 14812
node 0 Proxy started
2022/04/14 01:50:12 Start listening to port: 18968
2022/04/14 01:50:12 Start listening to port: 17519
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:50:12 Start listening to port: 11055
2022/04/14 01:50:12 Start listening to port: 11828
node 2 Proxy started
2022/04/14 01:50:12 Successfully connect all nodes
2022/04/14 01:50:12 Successfully connect all nodes
2022/04/14 01:50:12 Successfully connect all nodes
2022/04/14 01:50:12 Successfully connect all nodes
2022/04/14 01:50:12 Successfully connect all nodes
Running testAllForElection:
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 2 -> 1: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 4 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 0: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66466 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66467 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66468 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66469 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66470 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66472 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66473 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66474 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66475 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:50:15 Start listening to port: 14812
2022/04/14 01:50:15 Start listening to port: 17519
2022/04/14 01:50:15 Start listening to port: 18968
2022/04/14 01:50:15 Start listening to port: 11055
2022/04/14 01:50:15 Start listening to port: 11828
2022/04/14 01:50:15 Successfully connect all nodes
2022/04/14 01:50:15 Successfully connect all nodes
2022/04/14 01:50:15 Successfully connect all nodes
2022/04/14 01:50:15 Successfully connect all nodes
2022/04/14 01:50:15 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66552 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66553 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66554 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66555 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66556 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66558 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66559 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66560 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66561 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 0 Proxy started
2022/04/14 01:50:19 Start listening to port: 14812
2022/04/14 01:50:19 Start listening to port: 18968
2022/04/14 01:50:19 Start listening to port: 17519
2022/04/14 01:50:19 Start listening to port: 11828
node 3 Proxy started
2022/04/14 01:50:19 Start listening to port: 11055
2022/04/14 01:50:19 Successfully connect all nodes
2022/04/14 01:50:19 Successfully connect all nodes
2022/04/14 01:50:19 Successfully connect all nodes
2022/04/14 01:50:19 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:50:20 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 4 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:50:22 Receive propose from client
2022/04/14 01:50:22 Receive propose from client
2022/04/14 01:50:22 Receive propose from client
2022/04/14 01:50:22 Receive propose from client
2022/04/14 01:50:22 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,457597103>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,457597103>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,457597103>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,457597103>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:457597103 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:0], nextIndex :map[1:1 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66636 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66641 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66642 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66643 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66644 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:50:24 Start listening to port: 14812
node 1 Proxy started
2022/04/14 01:50:24 Start listening to port: 11055
2022/04/14 01:50:24 Start listening to port: 17519
2022/04/14 01:50:24 Start listening to port: 18968
2022/04/14 01:50:24 Start listening to port: 11828
node 2 Proxy started
2022/04/14 01:50:24 Successfully connect all nodes
2022/04/14 01:50:24 Successfully connect all nodes
2022/04/14 01:50:24 Successfully connect all nodes
2022/04/14 01:50:24 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:50:25 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:50:28 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,599674979>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,599674979>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:599674979 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:50:28 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1541639778>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,599674979>,t1:put<test,1541639778>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,599674979>,t1:put<test,1541639778>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1541639778>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:0], nextIndex :map[1:2 2:2 3:3 4:1] 
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:599674979  Term:1 Key:"test" Value:1541639778 ], kvStore: map[test:599674979]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:2], nextIndex :map[1:2 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66724 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66725 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66726 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66727 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66728 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66730 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66731 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66732 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66733 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:50:30 Start listening to port: 17519
2022/04/14 01:50:30 Start listening to port: 11828
2022/04/14 01:50:30 Start listening to port: 18968
node 4 Proxy started
2022/04/14 01:50:30 Start listening to port: 11055
2022/04/14 01:50:30 Start listening to port: 14812
2022/04/14 01:50:30 Successfully connect all nodes
2022/04/14 01:50:30 Successfully connect all nodes
2022/04/14 01:50:30 Successfully connect all nodes
2022/04/14 01:50:30 Successfully connect all nodes
2022/04/14 01:50:30 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:50:34 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,644919848>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:50:35 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,644919848>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:644919848  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,644919848>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,644919848>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:644919848  Term:1 Op:Delete Key:"test" ], kvStore: map[test:644919848]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66809 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66810 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66811 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66812 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66813 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66815 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66816 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66822 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66823 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:50:37 Start listening to port: 14812
2022/04/14 01:50:37 Start listening to port: 17519
2022/04/14 01:50:37 Start listening to port: 18968
2022/04/14 01:50:37 Start listening to port: 11828
2022/04/14 01:50:37 Start listening to port: 11055
2022/04/14 01:50:37 Successfully connect all nodes
2022/04/14 01:50:37 Successfully connect all nodes
2022/04/14 01:50:37 Successfully connect all nodes
2022/04/14 01:50:37 Successfully connect all nodes
2022/04/14 01:50:37 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:50:41 Receive propose from client
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:50:42 Receive propose from client
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2074598900>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 当前的commitNum是:2
3当前leder的commit次数是:0

超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2074598900  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3当前的commitNum是:2

当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2074598900  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:2074598900]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 66923 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
2022/04/14 01:49:58 testOneCandidateOneRoundElection PASS
2022/04/14 01:50:02 testOneCandidateStartTwoElection PASS
2022/04/14 01:50:07 testTwoCandidateForElection PASS
2022/04/14 01:50:12 testSplitVote PASS
2022/04/14 01:50:15 testAllForElection PASS
2022/04/14 01:50:19 testLeaderRevertToFollower PASS
2022/04/14 01:50:24 testOneSimplePut PASS
2022/04/14 01:50:30 testOneSimpleUpdate PASS
2022/04/14 01:50:37 testOneSimpleDelete PASS
2022/04/14 01:50:44 testDeleteNonExistKey PASS

16
2022-04-14 01:50:49
All real ports: 18423 19808 19263 10069 13461
All proxy ports: 11418 19495 10883 19541 10039
node 3 Proxy started
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:50:52 Start listening to port: 19263
2022/04/14 01:50:52 Start listening to port: 18423
2022/04/14 01:50:52 Start listening to port: 10069
2022/04/14 01:50:52 Start listening to port: 19808
2022/04/14 01:50:52 Start listening to port: 13461
2022/04/14 01:50:52 Successfully connect all nodes
2022/04/14 01:50:52 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
2022/04/14 01:50:52 Successfully connect all nodes
2022/04/14 01:50:52 Successfully connect all nodes
2022/04/14 01:50:52 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67827 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67828 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67830 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 67825 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 67829 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
2022/04/14 01:50:55 Start listening to port: 13461
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:50:55 Start listening to port: 19808
2022/04/14 01:50:55 Start listening to port: 19263
2022/04/14 01:50:55 Start listening to port: 10069
2022/04/14 01:50:55 Successfully connect all nodes
node 3 Proxy started
2022/04/14 01:50:55 Start listening to port: 18423
2022/04/14 01:50:55 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:50:56 Successfully connect all nodes
2022/04/14 01:50:56 Successfully connect all nodes
2022/04/14 01:50:56 Successfully connect all nodes
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67902 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67903 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67904 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67905 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67907 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67909 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67910 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67911 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67912 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:51:00 Start listening to port: 18423
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:51:00 Start listening to port: 19808
2022/04/14 01:51:00 Start listening to port: 19263
node 4 Proxy started
2022/04/14 01:51:00 Start listening to port: 10069
2022/04/14 01:51:00 Start listening to port: 13461
2022/04/14 01:51:00 Successfully connect all nodes
2022/04/14 01:51:00 Successfully connect all nodes
2022/04/14 01:51:00 Successfully connect all nodes
2022/04/14 01:51:00 Successfully connect all nodes
2022/04/14 01:51:00 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67983 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67984 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67985 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67986 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67987 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67989 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67991 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 67992 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:51:06 Start listening to port: 10069
2022/04/14 01:51:06 Start listening to port: 18423
2022/04/14 01:51:06 Start listening to port: 19808
2022/04/14 01:51:06 Start listening to port: 19263
2022/04/14 01:51:06 Start listening to port: 13461
2022/04/14 01:51:06 Successfully connect all nodes
2022/04/14 01:51:06 Successfully connect all nodes
2022/04/14 01:51:06 Successfully connect all nodes
2022/04/14 01:51:06 Successfully connect all nodes
2022/04/14 01:51:06 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68068 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68069 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68070 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68071 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68072 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68074 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68075 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68077 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68078 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:51:10 Start listening to port: 10069
2022/04/14 01:51:10 Start listening to port: 19263
2022/04/14 01:51:10 Start listening to port: 19808
2022/04/14 01:51:10 Start listening to port: 18423
2022/04/14 01:51:10 Start listening to port: 13461
2022/04/14 01:51:10 Successfully connect all nodes
2022/04/14 01:51:10 Successfully connect all nodes
2022/04/14 01:51:10 Successfully connect all nodes
2022/04/14 01:51:10 Successfully connect all nodes
2022/04/14 01:51:10 Successfully connect all nodes
Running testAllForElection:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 0 -> 1: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 4: granted, term: 2
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68160 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68161 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68162 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68163 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68164 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68169 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:51:14 Start listening to port: 19808
node 3 Proxy started
2022/04/14 01:51:14 Start listening to port: 18423
node 2 Proxy started
2022/04/14 01:51:14 Start listening to port: 10069
2022/04/14 01:51:14 Start listening to port: 19263
2022/04/14 01:51:14 Start listening to port: 13461
2022/04/14 01:51:14 Successfully connect all nodes
2022/04/14 01:51:14 Successfully connect all nodes
2022/04/14 01:51:14 Successfully connect all nodes
2022/04/14 01:51:14 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 01:51:15 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68253 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68254 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68255 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68256 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68257 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68259 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68260 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68261 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68263 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:51:17 Start listening to port: 18423
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:51:17 Start listening to port: 19808
2022/04/14 01:51:17 Start listening to port: 10069
2022/04/14 01:51:17 Start listening to port: 19263
2022/04/14 01:51:17 Start listening to port: 13461
2022/04/14 01:51:17 Successfully connect all nodes
2022/04/14 01:51:17 Successfully connect all nodes
2022/04/14 01:51:17 Successfully connect all nodes
2022/04/14 01:51:17 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:51:18 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:51:21 Receive propose from client
2022/04/14 01:51:21 Receive propose from client
2022/04/14 01:51:21 Receive propose from client
2022/04/14 01:51:21 Receive propose from client
2022/04/14 01:51:21 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2047785490>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2047785490>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2047785490>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2047785490>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 3 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2047785490 ], kvStore: map[]  
node 2 -> 0: success, term: 1, matchIdx: 1
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:1], nextIndex :map[1:2 2:1 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68343 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68344 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68345 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68346 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68347 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68349 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68350 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68351 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68352 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:51:23 Start listening to port: 19808
node 0 Proxy started
2022/04/14 01:51:23 Start listening to port: 10069
node 1 Proxy started
2022/04/14 01:51:23 Start listening to port: 13461
node 2 Proxy started
2022/04/14 01:51:23 Start listening to port: 18423
2022/04/14 01:51:23 Start listening to port: 19263
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:51:24 Successfully connect all nodes
2022/04/14 01:51:24 Successfully connect all nodes
2022/04/14 01:51:24 Successfully connect all nodes
2022/04/14 01:51:24 Successfully connect all nodes
2022/04/14 01:51:24 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:51:27 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,97642766>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,97642766>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:97642766 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:51:28 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,296744507>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,97642766>,t1:put<test,296744507>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,97642766>,t1:put<test,296744507>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,296744507>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:97642766  Term:1 Key:"test" Value:296744507 ], kvStore: map[test:97642766]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68440 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68441 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68442 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68443 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68444 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68446 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68447 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68448 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68449 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:51:30 Start listening to port: 18423
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:51:30 Start listening to port: 19263
2022/04/14 01:51:30 Start listening to port: 19808
2022/04/14 01:51:30 Start listening to port: 13461
2022/04/14 01:51:30 Start listening to port: 10069
2022/04/14 01:51:30 Successfully connect all nodes
2022/04/14 01:51:30 Successfully connect all nodes
2022/04/14 01:51:30 Successfully connect all nodes
2022/04/14 01:51:30 Successfully connect all nodes
2022/04/14 01:51:30 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:51:34 Receive propose from client
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950607264>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:51:35 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950607264>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1950607264  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950607264>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950607264>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1950607264  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1950607264]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 2 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68579 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68580 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68581 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68582 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68583 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68585 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68586 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68587 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68588 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:51:37 Start listening to port: 19808
2022/04/14 01:51:37 Start listening to port: 18423
node 1 Proxy started
2022/04/14 01:51:37 Start listening to port: 19263
node 4 Proxy started
2022/04/14 01:51:37 Start listening to port: 13461
2022/04/14 01:51:37 Successfully connect all nodes
2022/04/14 01:51:37 Start listening to port: 10069
2022/04/14 01:51:37 Successfully connect all nodes
2022/04/14 01:51:37 Successfully connect all nodes
2022/04/14 01:51:37 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 01:51:38 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:51:41 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:51:42 Receive propose from client
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1600027798>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1600027798  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1600027798  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68674 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68675 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68676 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68677 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68678 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 68683 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:50:55 testOneCandidateOneRoundElection PASS
2022/04/14 01:51:00 testOneCandidateStartTwoElection PASS
2022/04/14 01:51:05 testTwoCandidateForElection PASS
2022/04/14 01:51:10 testSplitVote PASS
2022/04/14 01:51:14 testAllForElection PASS
2022/04/14 01:51:17 testLeaderRevertToFollower PASS
2022/04/14 01:51:22 testOneSimplePut PASS
2022/04/14 01:51:30 testOneSimpleUpdate PASS
2022/04/14 01:51:37 testOneSimpleDelete PASS
2022/04/14 01:51:44 testDeleteNonExistKey PASS

17
2022-04-14 01:51:49
All real ports: 13802 10745 12956 11544 11136
All proxy ports: 10480 18519 14569 16774 11115
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:51:51 Start listening to port: 13802
2022/04/14 01:51:51 Start listening to port: 11544
2022/04/14 01:51:51 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:51:51 Start listening to port: 10745
2022/04/14 01:51:51 Start listening to port: 12956
2022/04/14 01:51:51 Successfully connect all nodes
2022/04/14 01:51:51 Successfully connect all nodes
2022/04/14 01:51:51 Successfully connect all nodes
2022/04/14 01:51:51 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 0 -> 0: reject, term: 0
01:51:54.783853 rafttest.go:262: FAIL: error on testOneCandidateOneRoundElection - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
But get:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: reject, term: 0
testOneCandidateOneRoundElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69577 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69578 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69579 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69580 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69581 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69584 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69585 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 3 Proxy started
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:51:54 Start listening to port: 13802
2022/04/14 01:51:54 Start listening to port: 12956
2022/04/14 01:51:54 Start listening to port: 11544
2022/04/14 01:51:54 Start listening to port: 10745
2022/04/14 01:51:54 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:51:54 Successfully connect all nodes
2022/04/14 01:51:54 Successfully connect all nodes
2022/04/14 01:51:54 Successfully connect all nodes
2022/04/14 01:51:54 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 0 -> 0: reject, term: 0
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
01:51:58.821211 rafttest.go:262: FAIL: error on testOneCandidateStartTwoElection - 
Expected:
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 2
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
But get:
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
testOneCandidateStartTwoElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69662 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69663 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69664 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69665 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69666 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69668 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69669 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69670 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:51:58 Start listening to port: 13802
2022/04/14 01:51:58 Start listening to port: 12956
node 4 Proxy started
2022/04/14 01:51:58 Start listening to port: 10745
2022/04/14 01:51:58 Start listening to port: 11544
2022/04/14 01:51:58 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:51:58 Successfully connect all nodes
2022/04/14 01:51:58 Successfully connect all nodes
2022/04/14 01:51:58 Successfully connect all nodes
2022/04/14 01:51:58 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 0: reject, term: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 1 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
01:52:04.855623 rafttest.go:262: FAIL: error on testTwoCandidateForElection - 
Expected:
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: granted, term: 1
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
But get:
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
testTwoCandidateForElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69743 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69744 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69745 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69746 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69747 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69749 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69750 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69751 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:52:04 Start listening to port: 13802
2022/04/14 01:52:04 Start listening to port: 12956
2022/04/14 01:52:04 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:52:04 Start listening to port: 10745
node 4 Proxy started
2022/04/14 01:52:04 Start listening to port: 11544
2022/04/14 01:52:04 Successfully connect all nodes
2022/04/14 01:52:04 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:52:05 Successfully connect all nodes
2022/04/14 01:52:05 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 0 -> 0: reject, term: 0
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 -> 0: reject, term: 0
node 0 -> 3: reject, term: 2
01:52:09.490963 rafttest.go:262: FAIL: error on testSplitVote2 - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 3: success, term: 2, matchIdx: 0
But get:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
testSplitVote FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69844 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69845 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69846 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69847 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69849 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69851 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69852 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:52:09 Start listening to port: 13802
2022/04/14 01:52:09 Start listening to port: 10745
2022/04/14 01:52:09 Start listening to port: 12956
2022/04/14 01:52:09 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:52:09 Start listening to port: 11544
2022/04/14 01:52:09 Successfully connect all nodes
2022/04/14 01:52:09 Successfully connect all nodes
2022/04/14 01:52:09 Successfully connect all nodes
2022/04/14 01:52:09 Successfully connect all nodes
Running testAllForElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 3 -> 2: reject, term: 1
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 0 -> 0: reject, term: 0
node 0 -> 0: reject, term: 0
node 0 -> 0: reject, term: 0
01:52:13.122771 rafttest.go:262: FAIL: error on testAllForElection2 - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
But get:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 0 -> 0: reject, term: 0
node 0 -> 0: reject, term: 0
node 0 -> 0: reject, term: 0
testAllForElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69930 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69931 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69932 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69933 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69934 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69936 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69937 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 69938 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:52:13 Start listening to port: 12956
2022/04/14 01:52:13 Start listening to port: 10745
node 4 Proxy started
2022/04/14 01:52:13 Start listening to port: 11544
2022/04/14 01:52:13 Start listening to port: 13802
2022/04/14 01:52:13 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:52:13 Successfully connect all nodes
2022/04/14 01:52:13 Successfully connect all nodes
2022/04/14 01:52:13 Successfully connect all nodes
2022/04/14 01:52:13 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
01:52:16.256333 rafttest.go:262: FAIL: error on testLeaderRevertToFollower3 - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
But get:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
testLeaderRevertToFollower FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70018 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70019 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70020 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70021 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70022 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70024 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70026 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:52:16 Start listening to port: 13802
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:52:16 Start listening to port: 10745
2022/04/14 01:52:16 Start listening to port: 12956
node 0 Proxy started
2022/04/14 01:52:16 Start listening to port: 11544
2022/04/14 01:52:16 Successfully connect all nodes
2022/04/14 01:52:16 Successfully connect all nodes
2022/04/14 01:52:16 Successfully connect all nodes
2022/04/14 01:52:16 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
Running testOneSimplePut:
2022/04/14 01:52:17 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: node 0 -> 0: reject, term: 0
0
初始化matchIndex[]，其中的每一项为: 0node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0

初始化matchIndex[]，其中的每一项为: 0node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0

初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: granted, term: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:52:19 Receive propose from client
2022/04/14 01:52:19 Receive propose from client
2022/04/14 01:52:19 Receive propose from client
2022/04/14 01:52:19 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:156320658 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
node 0 -> 0: fail, term: 0, matchIdx: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 0 -> 0: fail, term: 0, matchIdx: 0
01:52:21.535898 rafttest.go:262: FAIL: error on testOneSimplePut - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 -> 0: success, term: 1, matchIdx: 1
But get:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,156320658>], leaderCommit: 1
node 0 -> 0: fail, term: 0, matchIdx: 0
testOneSimplePut FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70104 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70105 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70106 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70107 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70108 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70111 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:52:21 Start listening to port: 13802
node 3 Proxy started
2022/04/14 01:52:21 Start listening to port: 10745
2022/04/14 01:52:21 Start listening to port: 11544
2022/04/14 01:52:21 Start listening to port: 12956
2022/04/14 01:52:21 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:52:21 Successfully connect all nodes
2022/04/14 01:52:21 Successfully connect all nodes
2022/04/14 01:52:21 Successfully connect all nodes
2022/04/14 01:52:21 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 -> 0: reject, term: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:52:25 Receive propose from client
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1242933702>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1242933702>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1242933702 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
01:52:25.573735 rafttest.go:222: FAIL: Node 4: incorrect status from GetValue on key test. Got OK, expected KeyNotFound.
testOneSimpleUpdate FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70192 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70193 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70194 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70195 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70196 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70198 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70199 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70200 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:52:25 Start listening to port: 13802
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:52:25 Start listening to port: 12956
2022/04/14 01:52:25 Start listening to port: 11544
2022/04/14 01:52:25 Start listening to port: 10745
2022/04/14 01:52:25 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:52:25 Successfully connect all nodes
2022/04/14 01:52:25 Successfully connect all nodes
2022/04/14 01:52:25 Successfully connect all nodes
2022/04/14 01:52:25 Successfully connect all nodes
Running testOneSimpleDelete:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:52:29 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,608208472>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:52:30 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,608208472>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:608208472  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
01:52:31.112096 rafttest.go:222: FAIL: Node 4: incorrect status from GetValue on key test. Got OK, expected KeyNotFound.
testOneSimpleDelete FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70284 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70320 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70329 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70332 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70336 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70338 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70339 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70340 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:52:31 Start listening to port: 13802
2022/04/14 01:52:31 Start listening to port: 12956
2022/04/14 01:52:31 Start listening to port: 10745
2022/04/14 01:52:31 Start listening to port: 11544
2022/04/14 01:52:31 Fail to listen port listen tcp 127.0.0.1:11136: bind: address already in use
2022/04/14 01:52:31 Successfully connect all nodes
2022/04/14 01:52:31 Successfully connect all nodes
2022/04/14 01:52:31 Successfully connect all nodes
2022/04/14 01:52:31 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
2022/04/14 01:52:34 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,134733316>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,134733316>], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:52:35 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,134733316>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,134733316>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
01:52:36.648689 rafttest.go:222: FAIL: Node 4: incorrect status from GetValue on key test. Got OK, expected KeyNotFound.
testDeleteNonExistKey FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70432 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70433 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70434 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70435 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70436 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70438 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70439 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 70441 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
2022/04/14 01:51:54 testOneCandidateOneRoundElection FAIL
2022/04/14 01:51:58 testOneCandidateStartTwoElection FAIL
2022/04/14 01:52:04 testTwoCandidateForElection FAIL
2022/04/14 01:52:09 testSplitVote FAIL
2022/04/14 01:52:13 testAllForElection FAIL
2022/04/14 01:52:16 testLeaderRevertToFollower FAIL
2022/04/14 01:52:21 testOneSimplePut FAIL
2022/04/14 01:52:25 testOneSimpleUpdate FAIL
2022/04/14 01:52:31 testOneSimpleDelete FAIL
2022/04/14 01:52:36 testDeleteNonExistKey FAIL

18
2022-04-14 01:52:41
All real ports: 17476 13024 13393 14238 10714
All proxy ports: 16222 19204 11488 10288 10362
2022/04/14 01:52:44 Start listening to port: 13393
2022/04/14 01:52:44 Start listening to port: 13024
2022/04/14 01:52:44 Start listening to port: 17476
2022/04/14 01:52:44 Start listening to port: 10714
2022/04/14 01:52:44 Start listening to port: 14238
01:52:44.753759 raftproxy.go:80: Fail to listen portlisten tcp :19204: bind: address already in use
node 4 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
Running testOneCandidateOneRoundElection:
2022/04/14 01:52:45 Successfully connect all nodes
2022/04/14 01:52:45 Successfully connect all nodes
2022/04/14 01:52:45 Successfully connect all nodes
2022/04/14 01:52:45 Successfully connect all nodes
2022/04/14 01:52:45 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
01:52:48.008218 rafttest.go:262: FAIL: error on testOneCandidateOneRoundElection - rpc error: code = Unavailable desc = transport is closing
testOneCandidateOneRoundElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71341 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71343 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71344 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71345 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71347 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71348 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71349 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71350 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:52:48 Start listening to port: 17476
node 1 Proxy started
2022/04/14 01:52:48 Start listening to port: 13024
2022/04/14 01:52:48 Start listening to port: 13393
2022/04/14 01:52:48 Start listening to port: 10714
2022/04/14 01:52:48 Start listening to port: 14238
2022/04/14 01:52:48 Successfully connect all nodes
2022/04/14 01:52:48 Successfully connect all nodes
2022/04/14 01:52:48 Successfully connect all nodes
2022/04/14 01:52:48 Successfully connect all nodes
2022/04/14 01:52:48 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71417 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71418 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71419 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71420 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71421 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71424 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71425 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71426 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:52:52 Start listening to port: 17476
2022/04/14 01:52:52 Start listening to port: 13393
2022/04/14 01:52:52 Start listening to port: 14238
2022/04/14 01:52:52 Start listening to port: 13024
2022/04/14 01:52:52 Start listening to port: 10714
2022/04/14 01:52:52 Successfully connect all nodes
2022/04/14 01:52:52 Successfully connect all nodes
2022/04/14 01:52:52 Successfully connect all nodes
2022/04/14 01:52:52 Successfully connect all nodes
2022/04/14 01:52:52 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71505 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71506 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71507 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:52:57 Start listening to port: 10714
node 4 Proxy started
2022/04/14 01:52:57 Start listening to port: 13393
node 1 Proxy started
2022/04/14 01:52:57 Start listening to port: 13024
node 2 Proxy started
2022/04/14 01:52:57 Start listening to port: 17476
node 3 Proxy started
2022/04/14 01:52:57 Start listening to port: 14238
node 0 Proxy started
2022/04/14 01:52:58 Successfully connect all nodes
2022/04/14 01:52:58 Successfully connect all nodes
2022/04/14 01:52:58 Successfully connect all nodes
2022/04/14 01:52:58 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:52:58 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71579 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71580 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71581 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71582 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71583 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71585 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71586 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71587 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71588 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:53:03 Start listening to port: 17476
2022/04/14 01:53:03 Start listening to port: 14238
2022/04/14 01:53:03 Start listening to port: 13024
2022/04/14 01:53:03 Start listening to port: 10714
2022/04/14 01:53:03 Start listening to port: 13393
2022/04/14 01:53:03 Successfully connect all nodes
2022/04/14 01:53:03 Successfully connect all nodes
2022/04/14 01:53:03 Successfully connect all nodes
2022/04/14 01:53:03 Successfully connect all nodes
2022/04/14 01:53:03 Successfully connect all nodes
Running testAllForElection:
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: node 1 -> 4: granted, term: 2
0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71661 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71662 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71663 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71665 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71670 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:53:06 Start listening to port: 10714
2022/04/14 01:53:06 Start listening to port: 13393
2022/04/14 01:53:06 Start listening to port: 17476
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:53:06 Start listening to port: 13024
2022/04/14 01:53:06 Start listening to port: 14238
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
Running testLeaderRevertToFollower:
2022/04/14 01:53:07 Successfully connect all nodes
2022/04/14 01:53:07 Successfully connect all nodes
2022/04/14 01:53:07 Successfully connect all nodes
2022/04/14 01:53:07 Successfully connect all nodes
2022/04/14 01:53:07 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71757 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71758 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71759 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71760 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71761 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71764 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71765 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71766 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:53:11 Start listening to port: 10714
node 1 Proxy started
2022/04/14 01:53:11 Start listening to port: 17476
2022/04/14 01:53:11 Start listening to port: 14238
2022/04/14 01:53:11 Start listening to port: 13393
node 2 Proxy started
2022/04/14 01:53:11 Start listening to port: 13024
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
Running testOneSimplePut:
2022/04/14 01:53:12 Successfully connect all nodes
2022/04/14 01:53:12 Successfully connect all nodes
2022/04/14 01:53:12 Successfully connect all nodes
2022/04/14 01:53:12 Successfully connect all nodes
2022/04/14 01:53:12 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:53:15 Receive propose from client
2022/04/14 01:53:15 Receive propose from client
2022/04/14 01:53:15 Receive propose from client
2022/04/14 01:53:15 Receive propose from client
2022/04/14 01:53:15 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,847594995>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,847594995>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,847594995>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,847594995>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:847594995 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:1], nextIndex :map[1:1 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 -> 0: success, term: 1, matchIdx: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71837 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71838 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71839 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71840 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71841 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71844 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71845 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71846 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 4 Proxy started
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:53:16 Start listening to port: 17476
2022/04/14 01:53:16 Start listening to port: 13024
2022/04/14 01:53:16 Start listening to port: 14238
2022/04/14 01:53:16 Start listening to port: 13393
2022/04/14 01:53:16 Start listening to port: 10714
2022/04/14 01:53:16 Successfully connect all nodes
2022/04/14 01:53:16 Successfully connect all nodes
2022/04/14 01:53:16 Successfully connect all nodes
2022/04/14 01:53:16 Successfully connect all nodes
2022/04/14 01:53:16 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:53:20 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183945840>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183945840>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:183945840 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:53:20 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1059473196>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183945840>,t1:put<test,1059473196>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183945840>,t1:put<test,1059473196>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1059473196>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:0], nextIndex :map[1:2 2:2 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:183945840  Term:1 Key:"test" Value:1059473196 ], kvStore: map[test:183945840]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:0], nextIndex :map[1:2 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71991 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71992 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71993 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 71994 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72008 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72009 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72010 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72011 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:53:22 Start listening to port: 17476
2022/04/14 01:53:22 Start listening to port: 13393
2022/04/14 01:53:22 Start listening to port: 13024
2022/04/14 01:53:22 Start listening to port: 10714
2022/04/14 01:53:22 Start listening to port: 14238
2022/04/14 01:53:22 Successfully connect all nodes
2022/04/14 01:53:22 Successfully connect all nodes
2022/04/14 01:53:22 Successfully connect all nodes
2022/04/14 01:53:22 Successfully connect all nodes
2022/04/14 01:53:22 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:53:26 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1851650582>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:53:27 Receive propose from client
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1851650582>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1851650582  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1851650582>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1851650582>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1851650582  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1851650582]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72089 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72090 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72091 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72093 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72094 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72096 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72098 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72100 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:53:30 Start listening to port: 13393
2022/04/14 01:53:30 Start listening to port: 17476
2022/04/14 01:53:30 Start listening to port: 13024
2022/04/14 01:53:30 Start listening to port: 14238
2022/04/14 01:53:30 Start listening to port: 10714
2022/04/14 01:53:30 Successfully connect all nodes
2022/04/14 01:53:30 Successfully connect all nodes
2022/04/14 01:53:30 Successfully connect all nodes
2022/04/14 01:53:30 Successfully connect all nodes
2022/04/14 01:53:30 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:53:33 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:53:34 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,159425210>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:159425210  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:159425210  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:159425210]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72174 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72175 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72178 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72179 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72180 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 72181 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:52:48 testOneCandidateOneRoundElection FAIL
2022/04/14 01:52:52 testOneCandidateStartTwoElection PASS
2022/04/14 01:52:57 testTwoCandidateForElection PASS
2022/04/14 01:53:02 testSplitVote PASS
2022/04/14 01:53:06 testAllForElection PASS
2022/04/14 01:53:10 testLeaderRevertToFollower PASS
2022/04/14 01:53:16 testOneSimplePut PASS
2022/04/14 01:53:22 testOneSimpleUpdate PASS
2022/04/14 01:53:29 testOneSimpleDelete PASS
2022/04/14 01:53:37 testDeleteNonExistKey PASS

19
2022-04-14 01:53:42
All real ports: 11936 11994 11311 11799 12570
All proxy ports: 19177 15616 17462 11861 13631
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:53:44 Start listening to port: 11936
2022/04/14 01:53:44 Start listening to port: 11994
2022/04/14 01:53:44 Start listening to port: 11311
2022/04/14 01:53:44 Start listening to port: 12570
2022/04/14 01:53:44 Start listening to port: 11799
2022/04/14 01:53:44 Successfully connect all nodes
2022/04/14 01:53:44 Successfully connect all nodes
2022/04/14 01:53:44 Successfully connect all nodes
2022/04/14 01:53:44 Successfully connect all nodes
2022/04/14 01:53:44 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73025 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73026 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73027 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73028 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73029 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73031 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73032 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73033 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73034 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:53:47 Start listening to port: 11936
node 4 Proxy started
2022/04/14 01:53:47 Start listening to port: 11994
2022/04/14 01:53:47 Start listening to port: 11311
2022/04/14 01:53:47 Start listening to port: 12570
2022/04/14 01:53:47 Start listening to port: 11799
2022/04/14 01:53:47 Successfully connect all nodes
2022/04/14 01:53:47 Successfully connect all nodes
2022/04/14 01:53:47 Successfully connect all nodes
2022/04/14 01:53:47 Successfully connect all nodes
2022/04/14 01:53:47 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73105 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73106 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73107 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73108 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73109 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73111 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73112 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73113 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73114 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:53:51 Start listening to port: 11936
2022/04/14 01:53:51 Start listening to port: 12570
2022/04/14 01:53:51 Start listening to port: 11799
2022/04/14 01:53:51 Start listening to port: 11994
2022/04/14 01:53:51 Start listening to port: 11311
2022/04/14 01:53:51 Successfully connect all nodes
2022/04/14 01:53:51 Successfully connect all nodes
2022/04/14 01:53:51 Successfully connect all nodes
2022/04/14 01:53:51 Successfully connect all nodes
2022/04/14 01:53:51 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73188 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73189 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73190 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73191 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73192 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73196 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73197 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73198 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73199 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:53:56 Start listening to port: 11936
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:53:56 Start listening to port: 11994
2022/04/14 01:53:56 Start listening to port: 11799
node 4 Proxy started
2022/04/14 01:53:56 Start listening to port: 11311
2022/04/14 01:53:56 Start listening to port: 12570
2022/04/14 01:53:56 Successfully connect all nodes
2022/04/14 01:53:56 Successfully connect all nodes
2022/04/14 01:53:56 Successfully connect all nodes
2022/04/14 01:53:56 Successfully connect all nodes
2022/04/14 01:53:56 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73273 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73274 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73275 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73276 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73277 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73279 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73280 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73281 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73282 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
2022/04/14 01:54:01 Start listening to port: 11936
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:54:01 Start listening to port: 11311
2022/04/14 01:54:01 Start listening to port: 11994
node 4 Proxy started
2022/04/14 01:54:01 Start listening to port: 11799
2022/04/14 01:54:01 Start listening to port: 12570
2022/04/14 01:54:01 Successfully connect all nodes
2022/04/14 01:54:01 Successfully connect all nodes
2022/04/14 01:54:01 Successfully connect all nodes
2022/04/14 01:54:01 Successfully connect all nodes
2022/04/14 01:54:01 Successfully connect all nodes
Running testAllForElection:
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: reject, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73358 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73359 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73360 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73361 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73362 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73364 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73365 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73366 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73367 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:54:04 Start listening to port: 11936
node 0 Proxy started
2022/04/14 01:54:04 Start listening to port: 11799
2022/04/14 01:54:04 Start listening to port: 11311
2022/04/14 01:54:04 Start listening to port: 12570
2022/04/14 01:54:04 Start listening to port: 11994
2022/04/14 01:54:04 Successfully connect all nodes
2022/04/14 01:54:04 Successfully connect all nodes
2022/04/14 01:54:04 Successfully connect all nodes
2022/04/14 01:54:04 Successfully connect all nodes
2022/04/14 01:54:04 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73454 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73455 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73456 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73457 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73458 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73460 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73462 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73463 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73464 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:54:08 Start listening to port: 11936
2022/04/14 01:54:08 Start listening to port: 11311
node 4 Proxy started
2022/04/14 01:54:08 Start listening to port: 11799
2022/04/14 01:54:08 Start listening to port: 11994
2022/04/14 01:54:08 Start listening to port: 12570
2022/04/14 01:54:08 Successfully connect all nodes
2022/04/14 01:54:08 Successfully connect all nodes
2022/04/14 01:54:08 Successfully connect all nodes
2022/04/14 01:54:08 Successfully connect all nodes
2022/04/14 01:54:08 Successfully connect all nodes
Running testOneSimplePut:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:54:11 Receive propose from client
2022/04/14 01:54:11 Receive propose from client
2022/04/14 01:54:11 Receive propose from client
2022/04/14 01:54:11 Receive propose from client
2022/04/14 01:54:11 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1843252214>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1843252214>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1843252214>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1843252214>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1843252214 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:1], nextIndex :map[1:2 2:1 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73542 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73543 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73544 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73545 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73546 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73548 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73549 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73550 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73551 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:54:13 Start listening to port: 11994
2022/04/14 01:54:13 Start listening to port: 11936
2022/04/14 01:54:13 Start listening to port: 12570
2022/04/14 01:54:13 Start listening to port: 11311
node 0 Proxy started
2022/04/14 01:54:13 Start listening to port: 11799
2022/04/14 01:54:13 Successfully connect all nodes
2022/04/14 01:54:13 Successfully connect all nodes
2022/04/14 01:54:13 Successfully connect all nodes
2022/04/14 01:54:13 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:54:14 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:54:16 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,460489989>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,460489989>], leaderCommit: 0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:460489989 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:54:17 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1997140215>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1997140215>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,460489989>,t1:put<test,1997140215>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,460489989>,t1:put<test,1997140215>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:460489989  Term:1 Key:"test" Value:1997140215 ], kvStore: map[test:460489989]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:0], nextIndex :map[1:2 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73628 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73629 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73630 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73631 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73632 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73635 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73636 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73637 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:54:19 Start listening to port: 11936
node 4 Proxy started
2022/04/14 01:54:19 Start listening to port: 11799
2022/04/14 01:54:19 Start listening to port: 11994
2022/04/14 01:54:19 Start listening to port: 12570
2022/04/14 01:54:19 Start listening to port: 11311
2022/04/14 01:54:19 Successfully connect all nodes
2022/04/14 01:54:19 Successfully connect all nodes
2022/04/14 01:54:19 Successfully connect all nodes
2022/04/14 01:54:19 Successfully connect all nodes
2022/04/14 01:54:19 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:54:22 Receive propose from client
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,205145958>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:54:23 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,205145958>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:205145958  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,205145958>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,205145958>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:205145958  Term:1 Op:Delete Key:"test" ], kvStore: map[test:205145958]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73715 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73716 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73717 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73718 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73719 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73721 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73722 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73723 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73724 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:54:26 Start listening to port: 11936
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:54:26 Start listening to port: 11311
2022/04/14 01:54:26 Start listening to port: 11994
2022/04/14 01:54:26 Start listening to port: 12570
2022/04/14 01:54:26 Start listening to port: 11799
2022/04/14 01:54:26 Successfully connect all nodes
2022/04/14 01:54:26 Successfully connect all nodes
2022/04/14 01:54:26 Successfully connect all nodes
2022/04/14 01:54:26 Successfully connect all nodes
2022/04/14 01:54:26 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:54:29 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:54:30 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,305391924>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
当前的commitNum是:2
响应成功。更新之后：rn.nextIndex[hostId]： 当前leder的commit次数是:0
3
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:305391924  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:305391924  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:305391924]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73808 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 73809 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:53:47 testOneCandidateOneRoundElection PASS
2022/04/14 01:53:51 testOneCandidateStartTwoElection PASS
2022/04/14 01:53:56 testTwoCandidateForElection PASS
2022/04/14 01:54:01 testSplitVote PASS
2022/04/14 01:54:04 testAllForElection PASS
2022/04/14 01:54:08 testLeaderRevertToFollower PASS
2022/04/14 01:54:13 testOneSimplePut PASS
2022/04/14 01:54:19 testOneSimpleUpdate PASS
2022/04/14 01:54:26 testOneSimpleDelete PASS
2022/04/14 01:54:33 testDeleteNonExistKey PASS

20
2022-04-14 01:54:38
All real ports: 13167 10223 10155 11897 15866
All proxy ports: 15750 16597 19937 15069 12019
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:54:40 Start listening to port: 13167
2022/04/14 01:54:40 Start listening to port: 10155
2022/04/14 01:54:40 Start listening to port: 11897
2022/04/14 01:54:40 Start listening to port: 10223
2022/04/14 01:54:40 Start listening to port: 15866
2022/04/14 01:54:40 Successfully connect all nodes
2022/04/14 01:54:40 Successfully connect all nodes
2022/04/14 01:54:40 Successfully connect all nodes
2022/04/14 01:54:40 Successfully connect all nodes
2022/04/14 01:54:40 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74733 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74734 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74735 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74736 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74737 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74739 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74740 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74741 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74742 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:54:43 Start listening to port: 10223
2022/04/14 01:54:43 Start listening to port: 13167
2022/04/14 01:54:43 Start listening to port: 10155
node 3 Proxy started
2022/04/14 01:54:43 Start listening to port: 15866
2022/04/14 01:54:43 Start listening to port: 11897
2022/04/14 01:54:43 Successfully connect all nodes
2022/04/14 01:54:43 Successfully connect all nodes
2022/04/14 01:54:43 Successfully connect all nodes
2022/04/14 01:54:43 Successfully connect all nodes
2022/04/14 01:54:43 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74818 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74820 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74822 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74824 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74826 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 3 Proxy started
2022/04/14 01:54:48 Start listening to port: 10223
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:54:48 Start listening to port: 11897
2022/04/14 01:54:48 Start listening to port: 15866
node 4 Proxy started
2022/04/14 01:54:48 Start listening to port: 10155
2022/04/14 01:54:48 Start listening to port: 13167
2022/04/14 01:54:48 Successfully connect all nodes
2022/04/14 01:54:48 Successfully connect all nodes
2022/04/14 01:54:48 Successfully connect all nodes
2022/04/14 01:54:48 Successfully connect all nodes
2022/04/14 01:54:48 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74896 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74897 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74898 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74899 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74900 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74902 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74903 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74904 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74905 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:54:53 Start listening to port: 13167
2022/04/14 01:54:53 Start listening to port: 10155
2022/04/14 01:54:53 Start listening to port: 10223
2022/04/14 01:54:53 Start listening to port: 11897
2022/04/14 01:54:53 Start listening to port: 15866
2022/04/14 01:54:53 Successfully connect all nodes
2022/04/14 01:54:53 Successfully connect all nodes
2022/04/14 01:54:53 Successfully connect all nodes
2022/04/14 01:54:53 Successfully connect all nodes
2022/04/14 01:54:53 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 3 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74983 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74984 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74985 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74986 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74988 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74989 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74990 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 74991 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:54:58 Start listening to port: 10223
2022/04/14 01:54:58 Start listening to port: 13167
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:54:58 Start listening to port: 11897
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
Running testAllForElection:
2022/04/14 01:54:58 Start listening to port: 15866
2022/04/14 01:54:58 Successfully connect all nodes
2022/04/14 01:54:58 Start listening to port: 10155
2022/04/14 01:54:58 Successfully connect all nodes
2022/04/14 01:54:59 Successfully connect all nodes
2022/04/14 01:54:59 Successfully connect all nodes
2022/04/14 01:54:59 Successfully connect all nodes
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 4: granted, term: 2
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75066 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75067 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75068 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75069 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75070 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75072 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75073 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75074 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75075 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:55:01 Start listening to port: 13167
2022/04/14 01:55:01 Start listening to port: 10223
2022/04/14 01:55:01 Start listening to port: 15866
2022/04/14 01:55:01 Start listening to port: 10155
2022/04/14 01:55:01 Start listening to port: 11897
2022/04/14 01:55:01 Successfully connect all nodes
2022/04/14 01:55:01 Successfully connect all nodes
2022/04/14 01:55:01 Successfully connect all nodes
2022/04/14 01:55:01 Successfully connect all nodes
2022/04/14 01:55:01 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75157 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75158 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75159 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75160 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75161 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75163 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75164 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75165 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75166 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:55:05 Start listening to port: 13167
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:55:05 Start listening to port: 10155
2022/04/14 01:55:05 Start listening to port: 11897
2022/04/14 01:55:05 Start listening to port: 15866
2022/04/14 01:55:05 Start listening to port: 10223
2022/04/14 01:55:05 Successfully connect all nodes
2022/04/14 01:55:05 Successfully connect all nodes
2022/04/14 01:55:05 Successfully connect all nodes
2022/04/14 01:55:05 Successfully connect all nodes
2022/04/14 01:55:05 Successfully connect all nodes
Running testOneSimplePut:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:55:08 Receive propose from client
2022/04/14 01:55:08 Receive propose from client
2022/04/14 01:55:08 Receive propose from client
2022/04/14 01:55:08 Receive propose from client
2022/04/14 01:55:08 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,360470711>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,360470711>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,360470711>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,360470711>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:360470711 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75244 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75245 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75246 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75247 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75248 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75251 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:55:10 Start listening to port: 13167
node 3 Proxy started
2022/04/14 01:55:10 Start listening to port: 10155
2022/04/14 01:55:10 Start listening to port: 11897
2022/04/14 01:55:10 Start listening to port: 10223
2022/04/14 01:55:10 Start listening to port: 15866
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:55:11 Successfully connect all nodes
2022/04/14 01:55:11 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:55:11 Successfully connect all nodes
2022/04/14 01:55:11 Successfully connect all nodes
2022/04/14 01:55:11 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:55:15 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1562618375>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1562618375>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1562618375 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:55:15 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1562618375>,t1:put<test,1260534558>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1260534558>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1260534558>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1562618375>,t1:put<test,1260534558>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:2], nextIndex :map[1:2 2:2 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1562618375  Term:1 Key:"test" Value:1260534558 ], kvStore: map[test:1562618375]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:2], nextIndex :map[1:3 2:2 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75326 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75327 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75328 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75329 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75330 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75332 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75333 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75334 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75335 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:55:17 Start listening to port: 13167
2022/04/14 01:55:17 Start listening to port: 10155
2022/04/14 01:55:17 Start listening to port: 10223
2022/04/14 01:55:17 Start listening to port: 11897
2022/04/14 01:55:17 Start listening to port: 15866
2022/04/14 01:55:17 Successfully connect all nodes
2022/04/14 01:55:17 Successfully connect all nodes
2022/04/14 01:55:17 Successfully connect all nodes
2022/04/14 01:55:17 Successfully connect all nodes
2022/04/14 01:55:17 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:55:21 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,601154389>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:55:22 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,601154389>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:601154389  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,601154389>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,601154389>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:601154389  Term:1 Op:Delete Key:"test" ], kvStore: map[test:601154389]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75406 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75407 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75408 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75409 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75410 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75414 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75417 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 01:55:24 Start listening to port: 13167
node 3 Proxy started
2022/04/14 01:55:24 Start listening to port: 10223
node 4 Proxy started
2022/04/14 01:55:24 Start listening to port: 11897
2022/04/14 01:55:24 Start listening to port: 15866
2022/04/14 01:55:24 Start listening to port: 10155
2022/04/14 01:55:24 Successfully connect all nodes
2022/04/14 01:55:24 Successfully connect all nodes
2022/04/14 01:55:24 Successfully connect all nodes
2022/04/14 01:55:24 Successfully connect all nodes
2022/04/14 01:55:24 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:55:28 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:55:29 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,966545190>,t1:del<test2,0>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:966545190  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:966545190  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:966545190]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75500 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75501 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75502 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75504 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75506 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75507 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75508 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 75509 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:54:43 testOneCandidateOneRoundElection PASS
2022/04/14 01:54:47 testOneCandidateStartTwoElection PASS
2022/04/14 01:54:53 testTwoCandidateForElection PASS
2022/04/14 01:54:57 testSplitVote PASS
2022/04/14 01:55:01 testAllForElection PASS
2022/04/14 01:55:05 testLeaderRevertToFollower PASS
2022/04/14 01:55:10 testOneSimplePut PASS
2022/04/14 01:55:17 testOneSimpleUpdate PASS
2022/04/14 01:55:24 testOneSimpleDelete PASS
2022/04/14 01:55:31 testDeleteNonExistKey PASS

21
2022-04-14 01:55:36
All real ports: 13614 13995 16126 16816 12369
All proxy ports: 19720 12152 10653 14260 11190
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:55:39 Start listening to port: 16126
2022/04/14 01:55:39 Start listening to port: 12369
2022/04/14 01:55:39 Start listening to port: 16816
2022/04/14 01:55:39 Start listening to port: 13995
2022/04/14 01:55:39 Start listening to port: 13614
2022/04/14 01:55:39 Successfully connect all nodes
2022/04/14 01:55:39 Successfully connect all nodes
2022/04/14 01:55:39 Successfully connect all nodes
2022/04/14 01:55:39 Successfully connect all nodes
2022/04/14 01:55:39 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76418 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76421 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76424 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76425 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76426 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76427 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:55:42 Start listening to port: 13614
2022/04/14 01:55:42 Start listening to port: 16126
2022/04/14 01:55:42 Start listening to port: 13995
2022/04/14 01:55:42 Start listening to port: 16816
node 4 Proxy started
2022/04/14 01:55:42 Start listening to port: 12369
2022/04/14 01:55:42 Successfully connect all nodes
2022/04/14 01:55:42 Successfully connect all nodes
2022/04/14 01:55:42 Successfully connect all nodes
2022/04/14 01:55:42 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:55:43 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76500 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76501 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76502 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76504 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76506 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76507 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76508 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76509 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 01:55:46 Start listening to port: 13614
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:55:46 Start listening to port: 16816
2022/04/14 01:55:46 Start listening to port: 13995
2022/04/14 01:55:46 Start listening to port: 16126
2022/04/14 01:55:46 Start listening to port: 12369
2022/04/14 01:55:46 Successfully connect all nodes
2022/04/14 01:55:46 Successfully connect all nodes
2022/04/14 01:55:46 Successfully connect all nodes
2022/04/14 01:55:46 Successfully connect all nodes
2022/04/14 01:55:46 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76595 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76596 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76597 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76598 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76599 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76601 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76602 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76603 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76604 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:55:51 Start listening to port: 16126
2022/04/14 01:55:51 Start listening to port: 13995
2022/04/14 01:55:51 Start listening to port: 13614
node 4 Proxy started
2022/04/14 01:55:51 Start listening to port: 16816
2022/04/14 01:55:51 Start listening to port: 12369
2022/04/14 01:55:51 Successfully connect all nodes
2022/04/14 01:55:51 Successfully connect all nodes
2022/04/14 01:55:51 Successfully connect all nodes
2022/04/14 01:55:51 Successfully connect all nodes
2022/04/14 01:55:51 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76680 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76681 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76682 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76683 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:55:56 Start listening to port: 13995
2022/04/14 01:55:56 Start listening to port: 16126
2022/04/14 01:55:56 Start listening to port: 16816
2022/04/14 01:55:56 Start listening to port: 12369
2022/04/14 01:55:56 Start listening to port: 13614
2022/04/14 01:55:56 Successfully connect all nodes
2022/04/14 01:55:56 Successfully connect all nodes
2022/04/14 01:55:56 Successfully connect all nodes
2022/04/14 01:55:56 Successfully connect all nodes
2022/04/14 01:55:56 Successfully connect all nodes
Running testAllForElection:
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 0 -> 1: reject, term: 1
node 1 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 -> 4: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 2: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76763 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76764 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76765 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76766 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76767 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76769 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76770 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76771 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76772 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 4 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:56:00 Start listening to port: 13995
2022/04/14 01:56:00 Start listening to port: 13614
node 2 Proxy started
2022/04/14 01:56:00 Start listening to port: 16126
2022/04/14 01:56:00 Start listening to port: 12369
2022/04/14 01:56:00 Start listening to port: 16816
2022/04/14 01:56:00 Successfully connect all nodes
2022/04/14 01:56:00 Successfully connect all nodes
2022/04/14 01:56:00 Successfully connect all nodes
2022/04/14 01:56:00 Successfully connect all nodes
2022/04/14 01:56:00 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76853 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76854 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76855 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76856 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76857 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76859 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76860 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76861 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76862 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:56:03 Start listening to port: 13995
node 4 Proxy started
2022/04/14 01:56:03 Start listening to port: 13614
2022/04/14 01:56:03 Start listening to port: 16126
2022/04/14 01:56:03 Start listening to port: 16816
2022/04/14 01:56:03 Start listening to port: 12369
node 2 Proxy started
2022/04/14 01:56:03 Successfully connect all nodes
2022/04/14 01:56:03 Successfully connect all nodes
2022/04/14 01:56:03 Successfully connect all nodes
2022/04/14 01:56:03 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:56:04 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:56:06 Receive propose from client
2022/04/14 01:56:06 Receive propose from client
2022/04/14 01:56:06 Receive propose from client
2022/04/14 01:56:06 Receive propose from client
2022/04/14 01:56:06 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,757526601>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,757526601>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,757526601>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,757526601>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:757526601 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:0], nextIndex :map[1:1 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76948 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76949 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76950 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76951 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76952 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76954 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76955 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76958 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 76959 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 01:56:08 Start listening to port: 13614
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:56:08 Start listening to port: 13995
2022/04/14 01:56:08 Start listening to port: 16816
2022/04/14 01:56:08 Successfully connect all nodes
2022/04/14 01:56:08 Start listening to port: 16126
2022/04/14 01:56:08 Start listening to port: 12369
2022/04/14 01:56:08 Successfully connect all nodes
2022/04/14 01:56:08 Successfully connect all nodes
2022/04/14 01:56:08 Successfully connect all nodes
2022/04/14 01:56:08 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:56:11 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2068644176>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2068644176>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2068644176 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:56:12 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2068644176>,t1:put<test,1037203395>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1037203395>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1037203395>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2068644176>,t1:put<test,1037203395>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 3 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2068644176  Term:1 Key:"test" Value:1037203395 ], kvStore: map[test:2068644176]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:2], nextIndex :map[1:2 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77038 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77039 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77040 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77041 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77042 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77044 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77045 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77046 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77048 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:56:14 Start listening to port: 16816
2022/04/14 01:56:14 Start listening to port: 16126
2022/04/14 01:56:14 Start listening to port: 13614
2022/04/14 01:56:14 Start listening to port: 12369
2022/04/14 01:56:14 Start listening to port: 13995
node 0 Proxy started
node 4 Proxy started
2022/04/14 01:56:14 Successfully connect all nodes
2022/04/14 01:56:14 Successfully connect all nodes
2022/04/14 01:56:14 Successfully connect all nodes
2022/04/14 01:56:14 Successfully connect all nodes
2022/04/14 01:56:14 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:56:18 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,45509311>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:56:19 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,45509311>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:45509311  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,45509311>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,45509311>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:45509311  Term:1 Op:Delete Key:"test" ], kvStore: map[test:45509311]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77124 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77125 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77126 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77127 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77128 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77130 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77131 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77132 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77133 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:56:21 Start listening to port: 13614
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:56:21 Start listening to port: 16126
2022/04/14 01:56:21 Start listening to port: 13995
2022/04/14 01:56:21 Start listening to port: 12369
2022/04/14 01:56:21 Start listening to port: 16816
2022/04/14 01:56:21 Successfully connect all nodes
2022/04/14 01:56:21 Successfully connect all nodes
2022/04/14 01:56:21 Successfully connect all nodes
2022/04/14 01:56:21 Successfully connect all nodes
2022/04/14 01:56:21 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:56:25 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:56:26 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066318493>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2066318493  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2066318493  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77207 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77208 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77209 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77210 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77211 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77214 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77215 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77216 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 77217 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:55:42 testOneCandidateOneRoundElection PASS
2022/04/14 01:55:46 testOneCandidateStartTwoElection PASS
2022/04/14 01:55:51 testTwoCandidateForElection PASS
2022/04/14 01:55:56 testSplitVote PASS
2022/04/14 01:55:59 testAllForElection PASS
2022/04/14 01:56:03 testLeaderRevertToFollower PASS
2022/04/14 01:56:08 testOneSimplePut PASS
2022/04/14 01:56:14 testOneSimpleUpdate PASS
2022/04/14 01:56:21 testOneSimpleDelete PASS
2022/04/14 01:56:28 testDeleteNonExistKey PASS

22
2022-04-14 01:56:33
All real ports: 14610 17960 14281 17551 10509
All proxy ports: 15754 14140 17849 12291 14647
node 4 Proxy started
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 01:56:36 Start listening to port: 14610
2022/04/14 01:56:36 Start listening to port: 10509
2022/04/14 01:56:36 Start listening to port: 17551
2022/04/14 01:56:36 Start listening to port: 14281
2022/04/14 01:56:36 Start listening to port: 17960
2022/04/14 01:56:36 Successfully connect all nodes
2022/04/14 01:56:36 Successfully connect all nodes
2022/04/14 01:56:36 Successfully connect all nodes
2022/04/14 01:56:36 Successfully connect all nodes
2022/04/14 01:56:36 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78126 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78127 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78128 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78129 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78130 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78132 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78133 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78134 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78135 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:56:39 Start listening to port: 14610
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:56:39 Start listening to port: 17960
2022/04/14 01:56:39 Start listening to port: 14281
2022/04/14 01:56:39 Start listening to port: 17551
2022/04/14 01:56:39 Start listening to port: 10509
2022/04/14 01:56:39 Successfully connect all nodes
2022/04/14 01:56:39 Successfully connect all nodes
2022/04/14 01:56:39 Successfully connect all nodes
2022/04/14 01:56:39 Successfully connect all nodes
2022/04/14 01:56:39 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78210 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78211 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78212 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78213 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78214 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78216 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78217 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78218 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78219 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 01:56:43 Start listening to port: 14610
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:56:43 Start listening to port: 10509
2022/04/14 01:56:43 Start listening to port: 14281
node 2 Proxy started
2022/04/14 01:56:43 Successfully connect all nodes
2022/04/14 01:56:43 Start listening to port: 17960
2022/04/14 01:56:43 Start listening to port: 17551
2022/04/14 01:56:43 Successfully connect all nodes
2022/04/14 01:56:43 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 01:56:44 Successfully connect all nodes
2022/04/14 01:56:44 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78292 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78293 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78294 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78295 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78299 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78305 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78306 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78307 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78308 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:56:48 Start listening to port: 17960
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 01:56:48 Start listening to port: 10509
2022/04/14 01:56:48 Start listening to port: 17551
2022/04/14 01:56:48 Start listening to port: 14610
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:56:48 Start listening to port: 14281
2022/04/14 01:56:48 Successfully connect all nodes
2022/04/14 01:56:48 Successfully connect all nodes
Running testSplitVote:
2022/04/14 01:56:48 Successfully connect all nodes
2022/04/14 01:56:49 Successfully connect all nodes
2022/04/14 01:56:49 Successfully connect all nodes
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78368 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78369 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78370 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78371 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78372 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78374 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78375 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78376 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78377 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:56:53 Start listening to port: 17960
2022/04/14 01:56:53 Start listening to port: 14610
node 4 Proxy started
2022/04/14 01:56:53 Start listening to port: 17551
2022/04/14 01:56:53 Start listening to port: 10509
2022/04/14 01:56:53 Start listening to port: 14281
2022/04/14 01:56:53 Successfully connect all nodes
2022/04/14 01:56:53 Successfully connect all nodes
2022/04/14 01:56:53 Successfully connect all nodes
2022/04/14 01:56:53 Successfully connect all nodes
2022/04/14 01:56:53 Successfully connect all nodes
Running testAllForElection:
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 0 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
1node 2 -> 0: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1

node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 0 -> 4: granted, term: 2
node 1 -> 4: reject, term: 1
初始化nextIndex[]，其中的每一项为: node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
1node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0

node 1 -> 2: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: node 3 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
1node 3 -> 1: reject, term: 1

node 1 -> 4: granted, term: 2
node 3 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1node 3 -> 0: reject, term: 1

node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
初始化matchIndex[]，其中的每一项为: node 3 -> 4: granted, term: 2
0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78450 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78451 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78453 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78454 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78456 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78457 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78458 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78459 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:56:57 Start listening to port: 14610
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
node 0 Proxy started
2022/04/14 01:56:57 Start listening to port: 14281
2022/04/14 01:56:57 Start listening to port: 17960
2022/04/14 01:56:57 Start listening to port: 10509
2022/04/14 01:56:57 Start listening to port: 17551
2022/04/14 01:56:57 Successfully connect all nodes
2022/04/14 01:56:57 Successfully connect all nodes
2022/04/14 01:56:57 Successfully connect all nodes
2022/04/14 01:56:57 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 01:56:58 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78542 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78548 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78549 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78550 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78551 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:57:00 Start listening to port: 14281
node 1 Proxy started
2022/04/14 01:57:00 Start listening to port: 14610
node 2 Proxy started
2022/04/14 01:57:00 Successfully connect all nodes
2022/04/14 01:57:00 Start listening to port: 10509
2022/04/14 01:57:00 Start listening to port: 17551
2022/04/14 01:57:00 Start listening to port: 17960
node 0 Proxy started
2022/04/14 01:57:00 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:57:01 Successfully connect all nodes
2022/04/14 01:57:01 Successfully connect all nodes
2022/04/14 01:57:01 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:57:04 Receive propose from client
2022/04/14 01:57:04 Receive propose from client
2022/04/14 01:57:04 Receive propose from client
2022/04/14 01:57:04 Receive propose from client
2022/04/14 01:57:04 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,228277837>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,228277837>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,228277837>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,228277837>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 2 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:228277837 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:1], nextIndex :map[1:1 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78631 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78632 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78633 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78634 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78635 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78638 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78639 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78640 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
2022/04/14 01:57:06 Start listening to port: 14610
2022/04/14 01:57:06 Start listening to port: 17960
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:57:06 Start listening to port: 14281
2022/04/14 01:57:06 Start listening to port: 10509
2022/04/14 01:57:06 Start listening to port: 17551
2022/04/14 01:57:06 Successfully connect all nodes
2022/04/14 01:57:06 Successfully connect all nodes
2022/04/14 01:57:06 Successfully connect all nodes
2022/04/14 01:57:06 Successfully connect all nodes
2022/04/14 01:57:06 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:57:09 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,394166485>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,394166485>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:394166485 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:57:10 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,914554803>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,394166485>,t1:put<test,914554803>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,394166485>,t1:put<test,914554803>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,914554803>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:394166485  Term:1 Key:"test" Value:914554803 ], kvStore: map[test:394166485]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:2], nextIndex :map[1:3 2:2 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
node 2 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78712 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78713 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78714 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78715 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78716 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78718 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78719 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78720 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78721 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:57:12 Start listening to port: 14610
2022/04/14 01:57:12 Start listening to port: 14281
2022/04/14 01:57:12 Start listening to port: 17960
2022/04/14 01:57:12 Start listening to port: 17551
2022/04/14 01:57:12 Start listening to port: 10509
2022/04/14 01:57:12 Successfully connect all nodes
2022/04/14 01:57:12 Successfully connect all nodes
2022/04/14 01:57:12 Successfully connect all nodes
2022/04/14 01:57:12 Successfully connect all nodes
2022/04/14 01:57:12 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:57:15 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1999440065>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:57:16 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1999440065>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1999440065  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1999440065>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1999440065>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1999440065  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1999440065]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 4 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78793 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78794 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78795 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78796 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78797 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78800 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78801 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78802 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:57:19 Start listening to port: 17960
2022/04/14 01:57:19 Start listening to port: 14610
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:57:19 Start listening to port: 17551
2022/04/14 01:57:19 Start listening to port: 14281
2022/04/14 01:57:19 Start listening to port: 10509
2022/04/14 01:57:19 Successfully connect all nodes
2022/04/14 01:57:19 Successfully connect all nodes
2022/04/14 01:57:19 Successfully connect all nodes
2022/04/14 01:57:19 Successfully connect all nodes
2022/04/14 01:57:19 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:57:22 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:57:23 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1187377272>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1187377272  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1187377272  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1187377272]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78876 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78877 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78878 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78879 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78880 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78882 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78883 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78884 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 78885 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:56:39 testOneCandidateOneRoundElection PASS
2022/04/14 01:56:43 testOneCandidateStartTwoElection PASS
2022/04/14 01:56:48 testTwoCandidateForElection PASS
2022/04/14 01:56:53 testSplitVote PASS
2022/04/14 01:56:57 testAllForElection PASS
2022/04/14 01:57:00 testLeaderRevertToFollower PASS
2022/04/14 01:57:05 testOneSimplePut PASS
2022/04/14 01:57:12 testOneSimpleUpdate PASS
2022/04/14 01:57:19 testOneSimpleDelete PASS
2022/04/14 01:57:26 testDeleteNonExistKey PASS

23
2022-04-14 01:57:31
All real ports: 12910 14535 16368 19248 10768
All proxy ports: 19216 13571 15077 16326 15870
node 4 Proxy started
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:57:33 Start listening to port: 10768
2022/04/14 01:57:33 Start listening to port: 14535
2022/04/14 01:57:33 Start listening to port: 19248
2022/04/14 01:57:33 Start listening to port: 12910
2022/04/14 01:57:33 Start listening to port: 16368
2022/04/14 01:57:33 Successfully connect all nodes
2022/04/14 01:57:33 Successfully connect all nodes
2022/04/14 01:57:33 Successfully connect all nodes
2022/04/14 01:57:33 Successfully connect all nodes
2022/04/14 01:57:33 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79758 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79759 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79760 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79761 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79762 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79764 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79765 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79766 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79767 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:57:36 Start listening to port: 12910
2022/04/14 01:57:36 Start listening to port: 14535
2022/04/14 01:57:36 Start listening to port: 16368
2022/04/14 01:57:36 Start listening to port: 19248
2022/04/14 01:57:36 Start listening to port: 10768
2022/04/14 01:57:36 Successfully connect all nodes
2022/04/14 01:57:36 Successfully connect all nodes
2022/04/14 01:57:36 Successfully connect all nodes
2022/04/14 01:57:36 Successfully connect all nodes
2022/04/14 01:57:36 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79841 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79842 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79843 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79844 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79845 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79847 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79849 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:57:40 Start listening to port: 12910
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:57:40 Start listening to port: 10768
2022/04/14 01:57:40 Start listening to port: 19248
2022/04/14 01:57:40 Start listening to port: 14535
2022/04/14 01:57:40 Start listening to port: 16368
2022/04/14 01:57:40 Successfully connect all nodes
2022/04/14 01:57:40 Successfully connect all nodes
2022/04/14 01:57:40 Successfully connect all nodes
2022/04/14 01:57:40 Successfully connect all nodes
2022/04/14 01:57:40 Successfully connect all nodes
Running testTwoCandidateForElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79925 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79926 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79927 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79928 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79929 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79931 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79932 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79933 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 79934 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:57:45 Start listening to port: 12910
2022/04/14 01:57:45 Start listening to port: 14535
2022/04/14 01:57:45 Start listening to port: 19248
2022/04/14 01:57:45 Start listening to port: 16368
2022/04/14 01:57:45 Successfully connect all nodes
2022/04/14 01:57:45 Start listening to port: 10768
2022/04/14 01:57:45 Successfully connect all nodes
2022/04/14 01:57:45 Successfully connect all nodes
2022/04/14 01:57:45 Successfully connect all nodes
2022/04/14 01:57:45 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: node 2 -> 3: granted, term: 2
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80018 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80019 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80020 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80021 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80022 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80025 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80026 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80027 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:57:49 Start listening to port: 14535
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:57:49 Start listening to port: 16368
2022/04/14 01:57:49 Start listening to port: 10768
2022/04/14 01:57:49 Start listening to port: 19248
2022/04/14 01:57:49 Start listening to port: 12910
2022/04/14 01:57:49 Successfully connect all nodes
2022/04/14 01:57:49 Successfully connect all nodes
2022/04/14 01:57:49 Successfully connect all nodes
2022/04/14 01:57:49 Successfully connect all nodes
2022/04/14 01:57:49 Successfully connect all nodes
Running testAllForElection:
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 1: reject, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
node 1 -> 4: granted, term: 2
初始化matchIndex[]，其中的每一项为: node 2 -> 4: granted, term: 2
0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80108 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80109 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80110 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80117 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80119 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80120 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:57:53 Start listening to port: 12910
2022/04/14 01:57:53 Start listening to port: 16368
2022/04/14 01:57:53 Start listening to port: 19248
2022/04/14 01:57:53 Start listening to port: 14535
2022/04/14 01:57:53 Start listening to port: 10768
2022/04/14 01:57:53 Successfully connect all nodes
2022/04/14 01:57:53 Successfully connect all nodes
2022/04/14 01:57:53 Successfully connect all nodes
2022/04/14 01:57:53 Successfully connect all nodes
2022/04/14 01:57:53 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 2: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80218 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80219 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80220 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80221 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80222 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80225 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80226 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80227 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:57:57 Start listening to port: 16368
2022/04/14 01:57:57 Start listening to port: 19248
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:57:57 Start listening to port: 14535
2022/04/14 01:57:57 Start listening to port: 10768
2022/04/14 01:57:57 Start listening to port: 12910
2022/04/14 01:57:57 Successfully connect all nodes
2022/04/14 01:57:57 Successfully connect all nodes
2022/04/14 01:57:57 Successfully connect all nodes
2022/04/14 01:57:57 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 01:57:58 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 4 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:58:00 Receive propose from client
2022/04/14 01:58:00 Receive propose from client
2022/04/14 01:58:00 Receive propose from client
2022/04/14 01:58:00 Receive propose from client
2022/04/14 01:58:00 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,132902949>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,132902949>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,132902949>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,132902949>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:132902949 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:1], nextIndex :map[1:1 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80307 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80308 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80309 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80310 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80311 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80313 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80314 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80315 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80317 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:58:02 Start listening to port: 12910
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:58:02 Start listening to port: 14535
2022/04/14 01:58:02 Start listening to port: 16368
2022/04/14 01:58:02 Start listening to port: 19248
2022/04/14 01:58:02 Start listening to port: 10768
2022/04/14 01:58:02 Successfully connect all nodes
2022/04/14 01:58:02 Successfully connect all nodes
2022/04/14 01:58:02 Successfully connect all nodes
2022/04/14 01:58:02 Successfully connect all nodes
2022/04/14 01:58:02 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:58:05 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1295018277>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1295018277>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1295018277 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:58:06 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,686677372>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1295018277>,t1:put<test,686677372>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,686677372>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1295018277>,t1:put<test,686677372>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1295018277  Term:1 Key:"test" Value:686677372 ], kvStore: map[test:1295018277]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80395 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80396 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80397 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80398 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80400 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80401 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80402 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80403 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:58:08 Start listening to port: 12910
2022/04/14 01:58:08 Start listening to port: 16368
2022/04/14 01:58:08 Start listening to port: 14535
2022/04/14 01:58:08 Start listening to port: 10768
2022/04/14 01:58:08 Start listening to port: 19248
2022/04/14 01:58:08 Successfully connect all nodes
2022/04/14 01:58:08 Successfully connect all nodes
2022/04/14 01:58:08 Successfully connect all nodes
2022/04/14 01:58:08 Successfully connect all nodes
2022/04/14 01:58:08 Successfully connect all nodes
Running testOneSimpleDelete:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:58:11 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605172072>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:58:12 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605172072>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1605172072  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605172072>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605172072>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1605172072  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1605172072]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80477 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80478 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80479 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80480 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80481 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80484 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80486 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80487 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:58:15 Start listening to port: 12910
2022/04/14 01:58:15 Start listening to port: 14535
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:58:15 Start listening to port: 10768
2022/04/14 01:58:15 Start listening to port: 19248
2022/04/14 01:58:15 Start listening to port: 16368
2022/04/14 01:58:15 Successfully connect all nodes
2022/04/14 01:58:15 Successfully connect all nodes
2022/04/14 01:58:15 Successfully connect all nodes
2022/04/14 01:58:15 Successfully connect all nodes
2022/04/14 01:58:15 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:58:18 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 01:58:19 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1980174679>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
node 1 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
node 3 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 2 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1980174679  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1980174679  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1980174679]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80561 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80562 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80563 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80564 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80565 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 80570 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
2022/04/14 01:57:36 testOneCandidateOneRoundElection PASS
2022/04/14 01:57:40 testOneCandidateStartTwoElection PASS
2022/04/14 01:57:45 testTwoCandidateForElection PASS
2022/04/14 01:57:49 testSplitVote PASS
2022/04/14 01:57:53 testAllForElection PASS
2022/04/14 01:57:56 testLeaderRevertToFollower PASS
2022/04/14 01:58:02 testOneSimplePut PASS
2022/04/14 01:58:08 testOneSimpleUpdate PASS
2022/04/14 01:58:15 testOneSimpleDelete PASS
2022/04/14 01:58:22 testDeleteNonExistKey PASS

24
2022-04-14 01:58:27
All real ports: 12944 14176 11924 10057 11488
All proxy ports: 18523 14711 19126 10301 15439
node 0 Proxy started
node 1 Proxy started
01:58:29.796198 raftproxy.go:80: Fail to listen portlisten tcp :10301: bind: address already in use
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:58:29 Start listening to port: 10057
2022/04/14 01:58:29 Start listening to port: 14176
2022/04/14 01:58:29 Start listening to port: 11924
2022/04/14 01:58:29 Start listening to port: 12944
2022/04/14 01:58:29 Start listening to port: 11488
2022/04/14 01:58:29 Successfully connect all nodes
2022/04/14 01:58:29 Successfully connect all nodes
2022/04/14 01:58:29 Successfully connect all nodes
2022/04/14 01:58:29 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
2022/04/14 01:58:29 Successfully connect all nodes
01:58:31.817528 rafttest.go:262: FAIL: error on testOneCandidateOneRoundElection - rpc error: code = Unavailable desc = transport is closing
testOneCandidateOneRoundElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81479 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81480 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81481 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81483 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81485 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81486 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81487 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81488 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 01:58:31 Start listening to port: 12944
2022/04/14 01:58:31 Start listening to port: 11924
2022/04/14 01:58:31 Start listening to port: 10057
2022/04/14 01:58:31 Start listening to port: 14176
2022/04/14 01:58:31 Start listening to port: 11488
2022/04/14 01:58:31 Successfully connect all nodes
2022/04/14 01:58:31 Successfully connect all nodes
2022/04/14 01:58:31 Successfully connect all nodes
2022/04/14 01:58:31 Successfully connect all nodes
2022/04/14 01:58:31 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81561 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81563 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81564 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81565 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81566 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:58:35 Start listening to port: 14176
2022/04/14 01:58:35 Start listening to port: 11924
2022/04/14 01:58:35 Start listening to port: 12944
2022/04/14 01:58:35 Start listening to port: 10057
2022/04/14 01:58:35 Start listening to port: 11488
2022/04/14 01:58:35 Successfully connect all nodes
2022/04/14 01:58:35 Successfully connect all nodes
2022/04/14 01:58:35 Successfully connect all nodes
2022/04/14 01:58:35 Successfully connect all nodes
2022/04/14 01:58:35 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81642 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81644 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81646 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81647 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81648 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81649 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:58:41 Start listening to port: 14176
2022/04/14 01:58:41 Start listening to port: 12944
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:58:41 Start listening to port: 11924
2022/04/14 01:58:41 Start listening to port: 11488
2022/04/14 01:58:41 Start listening to port: 10057
node 2 Proxy started
node 4 Proxy started
2022/04/14 01:58:41 Successfully connect all nodes
2022/04/14 01:58:42 Successfully connect all nodes
2022/04/14 01:58:42 Successfully connect all nodes
2022/04/14 01:58:42 Successfully connect all nodes
2022/04/14 01:58:42 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81724 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81725 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81726 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81727 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81728 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81730 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81731 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81732 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81733 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:58:46 Start listening to port: 12944
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:58:46 Start listening to port: 10057
2022/04/14 01:58:46 Start listening to port: 11488
node 4 Proxy started
2022/04/14 01:58:46 Start listening to port: 11924
2022/04/14 01:58:46 Start listening to port: 14176
2022/04/14 01:58:46 Successfully connect all nodes
2022/04/14 01:58:46 Successfully connect all nodes
2022/04/14 01:58:46 Successfully connect all nodes
2022/04/14 01:58:46 Successfully connect all nodes
Running testAllForElection:
2022/04/14 01:58:47 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 3 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 1: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81805 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81806 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81807 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81808 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81809 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81811 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81812 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81813 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81815 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 01:58:50 Start listening to port: 12944
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:58:50 Start listening to port: 14176
2022/04/14 01:58:50 Start listening to port: 11924
2022/04/14 01:58:50 Start listening to port: 10057
2022/04/14 01:58:50 Start listening to port: 11488
2022/04/14 01:58:50 Successfully connect all nodes
2022/04/14 01:58:50 Successfully connect all nodes
2022/04/14 01:58:50 Successfully connect all nodes
2022/04/14 01:58:50 Successfully connect all nodes
2022/04/14 01:58:50 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81906 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81907 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81909 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81910 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81912 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81913 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81914 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81915 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:58:53 Start listening to port: 14176
2022/04/14 01:58:53 Start listening to port: 12944
2022/04/14 01:58:53 Start listening to port: 10057
2022/04/14 01:58:53 Start listening to port: 11924
2022/04/14 01:58:53 Start listening to port: 11488
2022/04/14 01:58:53 Successfully connect all nodes
2022/04/14 01:58:53 Successfully connect all nodes
2022/04/14 01:58:53 Successfully connect all nodes
2022/04/14 01:58:53 Successfully connect all nodes
2022/04/14 01:58:53 Successfully connect all nodes
Running testOneSimplePut:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:58:57 Receive propose from client
2022/04/14 01:58:57 Receive propose from client
2022/04/14 01:58:57 Receive propose from client
2022/04/14 01:58:57 Receive propose from client
2022/04/14 01:58:57 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1267170185>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1267170185>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1267170185>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1267170185>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2当前的commitNum是:2

当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1267170185 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:1], nextIndex :map[1:1 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81990 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81991 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81992 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81993 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81994 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81996 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81997 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81998 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 81999 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
2022/04/14 01:58:58 Start listening to port: 12944
2022/04/14 01:58:58 Start listening to port: 14176
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:58:58 Start listening to port: 10057
2022/04/14 01:58:58 Start listening to port: 11924
2022/04/14 01:58:58 Start listening to port: 11488
2022/04/14 01:58:58 Successfully connect all nodes
2022/04/14 01:58:58 Successfully connect all nodes
2022/04/14 01:58:58 Successfully connect all nodes
2022/04/14 01:58:58 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 01:58:59 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:59:02 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,447742169>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,447742169>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:447742169 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 01:59:02 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1292713234>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1292713234>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,447742169>,t1:put<test,1292713234>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,447742169>,t1:put<test,1292713234>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
node 1 -> 0: success, term: 1, matchIdx: 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:447742169  Term:1 Key:"test" Value:1292713234 ], kvStore: map[test:447742169]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82074 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82075 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82076 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82077 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82078 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82080 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82081 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82082 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82083 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 01:59:04 Start listening to port: 12944
2022/04/14 01:59:04 Start listening to port: 11488
2022/04/14 01:59:04 Start listening to port: 14176
2022/04/14 01:59:04 Start listening to port: 11924
2022/04/14 01:59:04 Start listening to port: 10057
2022/04/14 01:59:04 Successfully connect all nodes
2022/04/14 01:59:04 Successfully connect all nodes
2022/04/14 01:59:04 Successfully connect all nodes
2022/04/14 01:59:04 Successfully connect all nodes
2022/04/14 01:59:04 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:59:08 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2101380740>], leaderCommit: 0
node 1: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 01:59:09 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2101380740>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2101380740  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2101380740>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2101380740>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2101380740  Term:1 Op:Delete Key:"test" ], kvStore: map[test:2101380740]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82167 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82172 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 01:59:12 Start listening to port: 12944
node 2 Proxy started
node 1 Proxy started
2022/04/14 01:59:12 Start listening to port: 14176
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:59:12 Start listening to port: 11488
2022/04/14 01:59:12 Start listening to port: 10057
2022/04/14 01:59:12 Start listening to port: 11924
2022/04/14 01:59:12 Successfully connect all nodes
2022/04/14 01:59:12 Successfully connect all nodes
2022/04/14 01:59:12 Successfully connect all nodes
2022/04/14 01:59:12 Successfully connect all nodes
2022/04/14 01:59:12 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
1
初始化nextIndex[]，其中的每一项为: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化matchIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
0node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1

初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:59:15 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 01:59:16 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1830620181>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1830620181  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1830620181  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1830620181]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82249 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82250 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82251 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82252 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82253 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82255 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82256 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82257 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 82258 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:58:31 testOneCandidateOneRoundElection FAIL
2022/04/14 01:58:35 testOneCandidateStartTwoElection PASS
2022/04/14 01:58:40 testTwoCandidateForElection PASS
2022/04/14 01:58:46 testSplitVote PASS
2022/04/14 01:58:50 testAllForElection PASS
2022/04/14 01:58:53 testLeaderRevertToFollower PASS
2022/04/14 01:58:58 testOneSimplePut PASS
2022/04/14 01:59:04 testOneSimpleUpdate PASS
2022/04/14 01:59:11 testOneSimpleDelete PASS
2022/04/14 01:59:19 testDeleteNonExistKey PASS

25
2022-04-14 01:59:24
All real ports: 18284 19350 16716 10760 14925
All proxy ports: 18078 19460 17733 13728 12812
node 2 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 01:59:26 Start listening to port: 16716
2022/04/14 01:59:26 Start listening to port: 18284
2022/04/14 01:59:26 Start listening to port: 14925
2022/04/14 01:59:26 Start listening to port: 10760
2022/04/14 01:59:26 Start listening to port: 19350
2022/04/14 01:59:26 Successfully connect all nodes
2022/04/14 01:59:26 Successfully connect all nodes
2022/04/14 01:59:26 Successfully connect all nodes
2022/04/14 01:59:26 Successfully connect all nodes
2022/04/14 01:59:26 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83135 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 01:59:29 Start listening to port: 18284
2022/04/14 01:59:29 Start listening to port: 19350
node 3 Proxy started
node 4 Proxy started
2022/04/14 01:59:29 Start listening to port: 14925
2022/04/14 01:59:29 Start listening to port: 10760
2022/04/14 01:59:29 Start listening to port: 16716
2022/04/14 01:59:29 Successfully connect all nodes
2022/04/14 01:59:29 Successfully connect all nodes
2022/04/14 01:59:29 Successfully connect all nodes
2022/04/14 01:59:29 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 01:59:30 Successfully connect all nodes
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83217 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83218 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83219 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83220 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83221 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83223 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83224 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83225 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83226 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 01:59:33 Start listening to port: 19350
2022/04/14 01:59:33 Start listening to port: 18284
node 4 Proxy started
2022/04/14 01:59:33 Start listening to port: 10760
2022/04/14 01:59:33 Start listening to port: 16716
2022/04/14 01:59:33 Start listening to port: 14925
2022/04/14 01:59:33 Successfully connect all nodes
2022/04/14 01:59:33 Successfully connect all nodes
2022/04/14 01:59:33 Successfully connect all nodes
2022/04/14 01:59:33 Successfully connect all nodes
2022/04/14 01:59:33 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 2: reject, term: 1
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83298 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83299 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83300 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83302 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83305 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83307 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:59:39 Start listening to port: 10760
2022/04/14 01:59:39 Start listening to port: 16716
2022/04/14 01:59:39 Start listening to port: 19350
node 0 Proxy started
2022/04/14 01:59:39 Start listening to port: 18284
node 2 Proxy started
2022/04/14 01:59:39 Start listening to port: 14925
node 1 Proxy started
Running testSplitVote:
2022/04/14 01:59:40 Successfully connect all nodes
2022/04/14 01:59:40 Successfully connect all nodes
2022/04/14 01:59:40 Successfully connect all nodes
2022/04/14 01:59:40 Successfully connect all nodes
2022/04/14 01:59:40 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83382 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83383 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83384 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83385 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83386 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83388 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83390 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83391 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83392 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 01:59:44 Start listening to port: 18284
node 4 Proxy started
2022/04/14 01:59:44 Start listening to port: 19350
node 2 Proxy started
2022/04/14 01:59:44 Start listening to port: 16716
2022/04/14 01:59:44 Start listening to port: 10760
2022/04/14 01:59:44 Start listening to port: 14925
2022/04/14 01:59:44 Successfully connect all nodes
2022/04/14 01:59:44 Successfully connect all nodes
2022/04/14 01:59:44 Successfully connect all nodes
2022/04/14 01:59:44 Successfully connect all nodes
2022/04/14 01:59:44 Successfully connect all nodes
Running testAllForElection:
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 2 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 2 -> 3: reject, term: 1
node 3 -> 1: reject, term: 1
node 1 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83472 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83473 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83474 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83475 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83476 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83478 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83479 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83480 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83481 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
2022/04/14 01:59:48 Start listening to port: 18284
node 4 Proxy started
node 2 Proxy started
node 3 Proxy started
node 0 Proxy started
2022/04/14 01:59:48 Start listening to port: 16716
2022/04/14 01:59:48 Start listening to port: 10760
2022/04/14 01:59:48 Start listening to port: 14925
2022/04/14 01:59:48 Start listening to port: 19350
2022/04/14 01:59:48 Successfully connect all nodes
2022/04/14 01:59:48 Successfully connect all nodes
2022/04/14 01:59:48 Successfully connect all nodes
2022/04/14 01:59:48 Successfully connect all nodes
2022/04/14 01:59:48 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 0: dropped RequestVote from 4
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83568 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83569 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83570 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83571 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83572 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83574 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83575 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83576 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83577 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 01:59:51 Start listening to port: 19350
2022/04/14 01:59:51 Start listening to port: 16716
2022/04/14 01:59:51 Start listening to port: 18284
2022/04/14 01:59:51 Start listening to port: 10760
node 0 Proxy started
2022/04/14 01:59:51 Start listening to port: 14925
2022/04/14 01:59:51 Successfully connect all nodes
2022/04/14 01:59:51 Successfully connect all nodes
2022/04/14 01:59:51 Successfully connect all nodes
2022/04/14 01:59:51 Successfully connect all nodes
2022/04/14 01:59:51 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 01:59:55 Receive propose from client
2022/04/14 01:59:55 Receive propose from client
2022/04/14 01:59:55 Receive propose from client
2022/04/14 01:59:55 Receive propose from client
2022/04/14 01:59:55 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,367718185>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,367718185>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,367718185>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,367718185>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
node 3 -> 0: success, term: 1, matchIdx: 1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:367718185 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83659 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83660 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83661 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83662 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83663 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83665 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83666 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83667 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83668 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 01:59:56 Start listening to port: 18284
node 2 Proxy started
2022/04/14 01:59:56 Start listening to port: 16716
node 1 Proxy started
2022/04/14 01:59:56 Start listening to port: 14925
2022/04/14 01:59:56 Start listening to port: 10760
2022/04/14 01:59:56 Start listening to port: 19350
2022/04/14 01:59:56 Successfully connect all nodes
2022/04/14 01:59:56 Successfully connect all nodes
2022/04/14 01:59:56 Successfully connect all nodes
2022/04/14 01:59:56 Successfully connect all nodes
2022/04/14 01:59:56 Successfully connect all nodes
Running testOneSimpleUpdate:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:00:00 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605235544>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605235544>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1605235544 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:00:00 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605235544>,t1:put<test,1443430779>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1605235544>,t1:put<test,1443430779>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1443430779>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1443430779>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1605235544  Term:1 Key:"test" Value:1443430779 ], kvStore: map[test:1605235544]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83744 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83745 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83746 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83747 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83748 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83750 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83751 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83752 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83753 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:00:02 Start listening to port: 18284
2022/04/14 02:00:02 Start listening to port: 19350
2022/04/14 02:00:02 Start listening to port: 10760
2022/04/14 02:00:02 Start listening to port: 14925
2022/04/14 02:00:02 Start listening to port: 16716
2022/04/14 02:00:02 Successfully connect all nodes
2022/04/14 02:00:02 Successfully connect all nodes
2022/04/14 02:00:02 Successfully connect all nodes
2022/04/14 02:00:02 Successfully connect all nodes
2022/04/14 02:00:02 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:00:06 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,16020338>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:00:07 Receive propose from client
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,16020338>,t1:del<test,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:16020338  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,16020338>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,16020338>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
node 2 -> 0: success, term: 1, matchIdx: 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:16020338  Term:1 Op:Delete Key:"test" ], kvStore: map[test:16020338]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 1 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
node 3 Proxy started
2022/04/14 02:00:09 Start listening to port: 16716
2022/04/14 02:00:09 Start listening to port: 18284
2022/04/14 02:00:09 Start listening to port: 19350
node 0 Proxy started
2022/04/14 02:00:09 Start listening to port: 10760
2022/04/14 02:00:09 Start listening to port: 14925
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:00:10 Successfully connect all nodes
2022/04/14 02:00:10 Successfully connect all nodes
2022/04/14 02:00:10 Successfully connect all nodes
2022/04/14 02:00:10 Successfully connect all nodes
2022/04/14 02:00:10 Successfully connect all nodes
Running testDeleteNonExistKey:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:00:14 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:00:15 Receive propose from client
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1604071588>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1604071588  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:0 4:2], nextIndex :map[1:1 2:3 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1604071588  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1604071588]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83919 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83920 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83921 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83922 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83923 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83925 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83926 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83927 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 83928 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 01:59:29 testOneCandidateOneRoundElection PASS
2022/04/14 01:59:33 testOneCandidateStartTwoElection PASS
2022/04/14 01:59:38 testTwoCandidateForElection PASS
2022/04/14 01:59:44 testSplitVote PASS
2022/04/14 01:59:48 testAllForElection PASS
2022/04/14 01:59:51 testLeaderRevertToFollower PASS
2022/04/14 01:59:56 testOneSimplePut PASS
2022/04/14 02:00:02 testOneSimpleUpdate PASS
2022/04/14 02:00:09 testOneSimpleDelete PASS
2022/04/14 02:00:18 testDeleteNonExistKey PASS

26
2022-04-14 02:00:23
All real ports: 12459 14257 18635 11155 12421
All proxy ports: 11626 17477 17632 12053 11174
node 3 Proxy started
node 2 Proxy started
node 0 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:00:26 Start listening to port: 14257
2022/04/14 02:00:26 Start listening to port: 11155
2022/04/14 02:00:26 Start listening to port: 12421
2022/04/14 02:00:26 Start listening to port: 18635
2022/04/14 02:00:26 Start listening to port: 12459
2022/04/14 02:00:26 Successfully connect all nodes
2022/04/14 02:00:26 Successfully connect all nodes
2022/04/14 02:00:26 Successfully connect all nodes
2022/04/14 02:00:26 Successfully connect all nodes
2022/04/14 02:00:26 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84820 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84821 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84822 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84823 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84824 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84826 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84827 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84828 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84829 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 02:00:29 Start listening to port: 12459
node 4 Proxy started
2022/04/14 02:00:29 Start listening to port: 18635
node 2 Proxy started
2022/04/14 02:00:29 Start listening to port: 12421
2022/04/14 02:00:29 Start listening to port: 11155
2022/04/14 02:00:29 Start listening to port: 14257
2022/04/14 02:00:29 Successfully connect all nodes
2022/04/14 02:00:29 Successfully connect all nodes
2022/04/14 02:00:29 Successfully connect all nodes
2022/04/14 02:00:29 Successfully connect all nodes
2022/04/14 02:00:29 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVote from 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84902 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84903 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84904 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84905 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84906 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84908 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84909 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84910 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84911 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:00:33 Start listening to port: 12459
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:00:33 Start listening to port: 18635
2022/04/14 02:00:33 Start listening to port: 14257
2022/04/14 02:00:33 Start listening to port: 11155
2022/04/14 02:00:33 Start listening to port: 12421
2022/04/14 02:00:33 Successfully connect all nodes
2022/04/14 02:00:33 Successfully connect all nodes
2022/04/14 02:00:33 Successfully connect all nodes
2022/04/14 02:00:33 Successfully connect all nodes
2022/04/14 02:00:33 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84987 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84988 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84989 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84990 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84991 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84993 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84997 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84998 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 84999 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:00:38 Start listening to port: 12459
2022/04/14 02:00:38 Start listening to port: 18635
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:00:38 Start listening to port: 14257
2022/04/14 02:00:38 Start listening to port: 11155
2022/04/14 02:00:38 Successfully connect all nodes
2022/04/14 02:00:38 Successfully connect all nodes
2022/04/14 02:00:38 Start listening to port: 12421
2022/04/14 02:00:38 Successfully connect all nodes
2022/04/14 02:00:38 Successfully connect all nodes
Running testSplitVote:
2022/04/14 02:00:38 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 3: granted, term: 2
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85070 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85071 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85072 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85073 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85074 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85076 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85077 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85078 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:00:43 Start listening to port: 12459
2022/04/14 02:00:43 Start listening to port: 18635
2022/04/14 02:00:43 Start listening to port: 14257
2022/04/14 02:00:43 Start listening to port: 11155
2022/04/14 02:00:43 Start listening to port: 12421
2022/04/14 02:00:43 Successfully connect all nodes
2022/04/14 02:00:43 Successfully connect all nodes
2022/04/14 02:00:43 Successfully connect all nodes
2022/04/14 02:00:43 Successfully connect all nodes
2022/04/14 02:00:43 Successfully connect all nodes
Running testAllForElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 2: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85154 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85155 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85156 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85157 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85158 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85160 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85161 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85162 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85163 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 02:00:46 Start listening to port: 12459
node 3 Proxy started
2022/04/14 02:00:46 Start listening to port: 14257
node 4 Proxy started
2022/04/14 02:00:46 Start listening to port: 18635
2022/04/14 02:00:46 Start listening to port: 12421
2022/04/14 02:00:46 Start listening to port: 11155
2022/04/14 02:00:46 Successfully connect all nodes
2022/04/14 02:00:46 Successfully connect all nodes
2022/04/14 02:00:46 Successfully connect all nodes
2022/04/14 02:00:46 Successfully connect all nodes
2022/04/14 02:00:46 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85249 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85250 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85251 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85252 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85253 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85255 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85256 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85257 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85258 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:00:50 Start listening to port: 12459
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:00:50 Start listening to port: 14257
2022/04/14 02:00:50 Start listening to port: 11155
2022/04/14 02:00:50 Start listening to port: 18635
2022/04/14 02:00:50 Start listening to port: 12421
2022/04/14 02:00:50 Successfully connect all nodes
2022/04/14 02:00:50 Successfully connect all nodes
2022/04/14 02:00:50 Successfully connect all nodes
2022/04/14 02:00:50 Successfully connect all nodes
2022/04/14 02:00:50 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:00:53 Receive propose from client
2022/04/14 02:00:53 Receive propose from client
2022/04/14 02:00:53 Receive propose from client
2022/04/14 02:00:53 Receive propose from client
2022/04/14 02:00:53 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1953388459>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1953388459>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1953388459>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1953388459>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1953388459 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:0], nextIndex :map[1:2 2:1 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85336 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85337 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85338 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85339 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85340 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85342 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85343 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85345 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85346 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 02:00:55 Start listening to port: 14257
2022/04/14 02:00:55 Start listening to port: 12459
2022/04/14 02:00:55 Start listening to port: 11155
2022/04/14 02:00:55 Start listening to port: 12421
2022/04/14 02:00:55 Start listening to port: 18635
2022/04/14 02:00:55 Successfully connect all nodes
2022/04/14 02:00:55 Successfully connect all nodes
2022/04/14 02:00:55 Successfully connect all nodes
2022/04/14 02:00:55 Successfully connect all nodes
2022/04/14 02:00:55 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:00:58 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,218912658>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,218912658>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:218912658 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:00:59 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,985428172>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,985428172>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,218912658>,t1:put<test,985428172>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,218912658>,t1:put<test,985428172>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:218912658  Term:1 Key:"test" Value:985428172 ], kvStore: map[test:218912658]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85434 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85437 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85438 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85439 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85440 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 4 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 02:01:01 Start listening to port: 14257
node 3 Proxy started
2022/04/14 02:01:01 Start listening to port: 12459
2022/04/14 02:01:01 Start listening to port: 12421
2022/04/14 02:01:01 Successfully connect all nodes
node 1 Proxy started
2022/04/14 02:01:01 Start listening to port: 18635
2022/04/14 02:01:01 Successfully connect all nodes
2022/04/14 02:01:01 Start listening to port: 11155
2022/04/14 02:01:01 Successfully connect all nodes
2022/04/14 02:01:02 Successfully connect all nodes
2022/04/14 02:01:02 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:01:06 Receive propose from client
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1710979405>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:01:07 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1710979405>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1710979405  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1710979405>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1710979405>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1710979405  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1710979405]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85521 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85522 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85524 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:01:09 Start listening to port: 14257
2022/04/14 02:01:09 Start listening to port: 11155
node 4 Proxy started
node 0 Proxy started
2022/04/14 02:01:09 Start listening to port: 12421
2022/04/14 02:01:09 Start listening to port: 12459
2022/04/14 02:01:09 Start listening to port: 18635
2022/04/14 02:01:09 Successfully connect all nodes
node 2 Proxy started
2022/04/14 02:01:10 Successfully connect all nodes
2022/04/14 02:01:10 Successfully connect all nodes
2022/04/14 02:01:10 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 02:01:10 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:01:14 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:01:15 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1915094785>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1915094785  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1915094785  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1915094785]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85596 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85597 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85598 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85599 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85602 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85603 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 85604 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:00:29 testOneCandidateOneRoundElection PASS
2022/04/14 02:00:33 testOneCandidateStartTwoElection PASS
2022/04/14 02:00:38 testTwoCandidateForElection PASS
2022/04/14 02:00:43 testSplitVote PASS
2022/04/14 02:00:46 testAllForElection PASS
2022/04/14 02:00:50 testLeaderRevertToFollower PASS
2022/04/14 02:00:55 testOneSimplePut PASS
2022/04/14 02:01:01 testOneSimpleUpdate PASS
2022/04/14 02:01:09 testOneSimpleDelete PASS
2022/04/14 02:01:17 testDeleteNonExistKey PASS

27
2022-04-14 02:01:23
All real ports: 10844 10913 11895 10070 15656
All proxy ports: 14151 14416 11585 14621 18012
node 1 Proxy started
node 4 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:01:25 Start listening to port: 15656
2022/04/14 02:01:25 Start listening to port: 10913
2022/04/14 02:01:25 Start listening to port: 10070
2022/04/14 02:01:25 Start listening to port: 10844
2022/04/14 02:01:25 Start listening to port: 11895
2022/04/14 02:01:25 Successfully connect all nodes
2022/04/14 02:01:25 Successfully connect all nodes
2022/04/14 02:01:25 Successfully connect all nodes
2022/04/14 02:01:25 Successfully connect all nodes
2022/04/14 02:01:25 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86559 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86560 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86561 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86562 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86563 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86565 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86566 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86567 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86568 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:01:28 Start listening to port: 10913
2022/04/14 02:01:28 Start listening to port: 10844
2022/04/14 02:01:28 Start listening to port: 10070
2022/04/14 02:01:28 Start listening to port: 11895
node 4 Proxy started
2022/04/14 02:01:28 Start listening to port: 15656
2022/04/14 02:01:28 Successfully connect all nodes
2022/04/14 02:01:28 Successfully connect all nodes
2022/04/14 02:01:28 Successfully connect all nodes
2022/04/14 02:01:28 Successfully connect all nodes
2022/04/14 02:01:28 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86643 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86644 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86645 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86646 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86647 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86649 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86650 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86651 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86652 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:01:32 Start listening to port: 10913
2022/04/14 02:01:32 Start listening to port: 10844
2022/04/14 02:01:32 Start listening to port: 11895
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:01:32 Start listening to port: 15656
2022/04/14 02:01:32 Start listening to port: 10070
2022/04/14 02:01:32 Successfully connect all nodes
2022/04/14 02:01:32 Successfully connect all nodes
2022/04/14 02:01:32 Successfully connect all nodes
2022/04/14 02:01:32 Successfully connect all nodes
2022/04/14 02:01:32 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86731 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86732 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86733 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86734 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86735 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86737 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86738 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86739 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86740 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:01:37 Start listening to port: 10913
2022/04/14 02:01:37 Start listening to port: 10844
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:01:37 Start listening to port: 11895
2022/04/14 02:01:37 Start listening to port: 10070
2022/04/14 02:01:37 Start listening to port: 15656
2022/04/14 02:01:37 Successfully connect all nodes
2022/04/14 02:01:37 Successfully connect all nodes
2022/04/14 02:01:37 Successfully connect all nodes
2022/04/14 02:01:37 Successfully connect all nodes
2022/04/14 02:01:37 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86823 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86826 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86827 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86828 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86829 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 02:01:42 Start listening to port: 15656
2022/04/14 02:01:42 Start listening to port: 10070
node 2 Proxy started
2022/04/14 02:01:42 Start listening to port: 11895
node 3 Proxy started
2022/04/14 02:01:42 Start listening to port: 10844
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:01:42 Start listening to port: 10913
2022/04/14 02:01:42 Successfully connect all nodes
Running testAllForElection:
2022/04/14 02:01:43 Successfully connect all nodes
2022/04/14 02:01:43 Successfully connect all nodes
2022/04/14 02:01:43 Successfully connect all nodes
2022/04/14 02:01:43 Successfully connect all nodes
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 0 -> 1: reject, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86916 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86917 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86918 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86919 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86920 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86922 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86923 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86924 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 86925 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:01:45 Start listening to port: 10913
2022/04/14 02:01:45 Start listening to port: 10070
2022/04/14 02:01:45 Start listening to port: 11895
2022/04/14 02:01:45 Start listening to port: 10844
2022/04/14 02:01:45 Start listening to port: 15656
node 3 Proxy started
2022/04/14 02:01:45 Successfully connect all nodes
2022/04/14 02:01:46 Successfully connect all nodes
2022/04/14 02:01:46 Successfully connect all nodes
2022/04/14 02:01:46 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 02:01:47 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87012 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87013 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87014 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87015 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87016 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87018 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87019 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87021 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:01:49 Start listening to port: 10844
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:01:49 Start listening to port: 11895
node 4 Proxy started
2022/04/14 02:01:49 Start listening to port: 10070
2022/04/14 02:01:49 Start listening to port: 15656
2022/04/14 02:01:49 Start listening to port: 10913
2022/04/14 02:01:49 Successfully connect all nodes
2022/04/14 02:01:49 Successfully connect all nodes
2022/04/14 02:01:49 Successfully connect all nodes
2022/04/14 02:01:49 Successfully connect all nodes
2022/04/14 02:01:49 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:01:52 Receive propose from client
2022/04/14 02:01:52 Receive propose from client
2022/04/14 02:01:52 Receive propose from client
2022/04/14 02:01:52 Receive propose from client
2022/04/14 02:01:52 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1610350225>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1610350225>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1610350225>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1610350225>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
node 4 -> 0: success, term: 1, matchIdx: 1
commit日志之后，当前的leader的rn.commitIndex为:
 1node 3 -> 0: success, term: 1, matchIdx: 1

当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1610350225 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87105 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87106 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87107 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87108 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87109 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87111 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87112 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87113 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87114 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:01:54 Start listening to port: 10844
2022/04/14 02:01:54 Start listening to port: 11895
2022/04/14 02:01:54 Start listening to port: 10070
2022/04/14 02:01:54 Start listening to port: 10913
2022/04/14 02:01:54 Start listening to port: 15656
2022/04/14 02:01:54 Successfully connect all nodes
2022/04/14 02:01:54 Successfully connect all nodes
2022/04/14 02:01:54 Successfully connect all nodes
2022/04/14 02:01:54 Successfully connect all nodes
2022/04/14 02:01:54 Successfully connect all nodes
Running testOneSimpleUpdate:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:01:57 Receive propose from client
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2062816693>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2062816693>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 1 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2062816693 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:01:58 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1812321197>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2062816693>,t1:put<test,1812321197>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1812321197>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2062816693>,t1:put<test,1812321197>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
当前的commitNum是:1
node 1 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2062816693  Term:1 Key:"test" Value:1812321197 ], kvStore: map[test:2062816693]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87204 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87205 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87206 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87207 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87208 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87210 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87211 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87212 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87213 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:02:00 Start listening to port: 10844
2022/04/14 02:02:00 Start listening to port: 10913
node 4 Proxy started
2022/04/14 02:02:00 Start listening to port: 10070
2022/04/14 02:02:00 Start listening to port: 15656
2022/04/14 02:02:00 Start listening to port: 11895
2022/04/14 02:02:00 Successfully connect all nodes
2022/04/14 02:02:00 Successfully connect all nodes
2022/04/14 02:02:00 Successfully connect all nodes
2022/04/14 02:02:00 Successfully connect all nodes
2022/04/14 02:02:00 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:02:04 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1949979420>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:02:05 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1949979420>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1949979420  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1949979420>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1949979420>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1949979420  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1949979420]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87297 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87298 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87299 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87300 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:02:07 Start listening to port: 10913
node 1 Proxy started
2022/04/14 02:02:07 Start listening to port: 10070
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:02:07 Start listening to port: 11895
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:02:07 Start listening to port: 15656
2022/04/14 02:02:07 Successfully connect all nodes
2022/04/14 02:02:07 Start listening to port: 10844
2022/04/14 02:02:07 Successfully connect all nodes
2022/04/14 02:02:08 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 02:02:08 Successfully connect all nodes
2022/04/14 02:02:08 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:02:12 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:02:13 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>,t1:del<test2,0>], leaderCommit: 0
当前的commitNum是:1
当前leder的commit次数是:0
node 1 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2046318203>,t1:del<test2,0>], leaderCommit: 0
2node 2 -> 0: success, term: 1, matchIdx: 2

响应成功。更新之后：rn.nextIndex[hostId]： node 3 -> 0: success, term: 1, matchIdx: 2
3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2046318203  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2046318203  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:2046318203]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87377 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87378 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87379 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87380 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87381 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87383 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87384 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87385 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 87386 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:01:28 testOneCandidateOneRoundElection PASS
2022/04/14 02:01:32 testOneCandidateStartTwoElection PASS
2022/04/14 02:01:37 testTwoCandidateForElection PASS
2022/04/14 02:01:42 testSplitVote PASS
2022/04/14 02:01:45 testAllForElection PASS
2022/04/14 02:01:49 testLeaderRevertToFollower PASS
2022/04/14 02:01:54 testOneSimplePut PASS
2022/04/14 02:02:00 testOneSimpleUpdate PASS
2022/04/14 02:02:07 testOneSimpleDelete PASS
2022/04/14 02:02:15 testDeleteNonExistKey PASS

28
2022-04-14 02:02:20
All real ports: 14797 11728 17555 10507 18013
All proxy ports: 10460 11738 18956 15301 16278
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:02:22 Start listening to port: 10507
2022/04/14 02:02:22 Start listening to port: 18013
2022/04/14 02:02:22 Start listening to port: 11728
2022/04/14 02:02:22 Start listening to port: 14797
2022/04/14 02:02:22 Start listening to port: 17555
2022/04/14 02:02:22 Successfully connect all nodes
2022/04/14 02:02:22 Successfully connect all nodes
2022/04/14 02:02:22 Successfully connect all nodes
2022/04/14 02:02:22 Successfully connect all nodes
2022/04/14 02:02:22 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88267 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88268 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88269 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88270 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88271 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88273 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88274 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88275 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88276 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:02:25 Start listening to port: 14797
2022/04/14 02:02:25 Start listening to port: 11728
2022/04/14 02:02:25 Start listening to port: 17555
2022/04/14 02:02:25 Start listening to port: 10507
2022/04/14 02:02:25 Start listening to port: 18013
2022/04/14 02:02:25 Successfully connect all nodes
2022/04/14 02:02:25 Successfully connect all nodes
2022/04/14 02:02:25 Successfully connect all nodes
2022/04/14 02:02:25 Successfully connect all nodes
2022/04/14 02:02:25 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88356 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88358 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88359 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88360 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88361 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
2022/04/14 02:02:30 Start listening to port: 17555
2022/04/14 02:02:30 Start listening to port: 10507
node 3 Proxy started
node 4 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:02:30 Start listening to port: 18013
2022/04/14 02:02:30 Start listening to port: 11728
2022/04/14 02:02:30 Start listening to port: 14797
2022/04/14 02:02:30 Successfully connect all nodes
2022/04/14 02:02:30 Successfully connect all nodes
2022/04/14 02:02:30 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 02:02:31 Successfully connect all nodes
2022/04/14 02:02:31 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88437 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88438 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88439 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88440 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88441 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88443 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88444 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
node 0 Proxy started
node 4 Proxy started
2022/04/14 02:02:35 Start listening to port: 14797
2022/04/14 02:02:35 Start listening to port: 17555
node 1 Proxy started
node 2 Proxy started
2022/04/14 02:02:35 Start listening to port: 10507
2022/04/14 02:02:35 Successfully connect all nodes
node 3 Proxy started
Running testSplitVote:
2022/04/14 02:02:35 Start listening to port: 18013
2022/04/14 02:02:35 Successfully connect all nodes
2022/04/14 02:02:35 Start listening to port: 11728
2022/04/14 02:02:35 Successfully connect all nodes
2022/04/14 02:02:36 Successfully connect all nodes
2022/04/14 02:02:36 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88515 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88516 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88517 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88518 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88519 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88521 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88522 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88523 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88524 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:02:40 Start listening to port: 14797
2022/04/14 02:02:40 Start listening to port: 17555
2022/04/14 02:02:40 Start listening to port: 11728
2022/04/14 02:02:40 Start listening to port: 10507
2022/04/14 02:02:40 Successfully connect all nodes
2022/04/14 02:02:40 Start listening to port: 18013
2022/04/14 02:02:40 Successfully connect all nodes
2022/04/14 02:02:40 Successfully connect all nodes
2022/04/14 02:02:40 Successfully connect all nodes
2022/04/14 02:02:40 Successfully connect all nodes
Running testAllForElection:
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 4: granted, term: 2
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88599 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88600 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88601 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88602 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88603 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88606 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88607 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88608 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88609 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:02:44 Start listening to port: 11728
2022/04/14 02:02:44 Start listening to port: 17555
2022/04/14 02:02:44 Start listening to port: 14797
2022/04/14 02:02:44 Start listening to port: 10507
2022/04/14 02:02:44 Start listening to port: 18013
2022/04/14 02:02:44 Successfully connect all nodes
2022/04/14 02:02:44 Successfully connect all nodes
2022/04/14 02:02:44 Successfully connect all nodes
2022/04/14 02:02:44 Successfully connect all nodes
2022/04/14 02:02:44 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88699 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88700 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88701 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88702 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88703 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88705 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88706 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88707 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88708 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:02:47 Start listening to port: 14797
2022/04/14 02:02:47 Start listening to port: 11728
node 1 Proxy started
2022/04/14 02:02:47 Start listening to port: 18013
2022/04/14 02:02:47 Start listening to port: 10507
2022/04/14 02:02:47 Successfully connect all nodes
2022/04/14 02:02:47 Successfully connect all nodes
2022/04/14 02:02:47 Start listening to port: 17555
2022/04/14 02:02:47 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 02:02:47 Successfully connect all nodes
2022/04/14 02:02:48 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:02:50 Receive propose from client
2022/04/14 02:02:50 Receive propose from client
2022/04/14 02:02:50 Receive propose from client
2022/04/14 02:02:50 Receive propose from client
2022/04/14 02:02:50 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,638791359>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,638791359>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,638791359>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,638791359>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:638791359 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:0], nextIndex :map[1:2 2:1 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88783 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88784 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88785 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88786 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88787 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88790 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88791 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88792 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:02:52 Start listening to port: 14797
2022/04/14 02:02:52 Start listening to port: 11728
2022/04/14 02:02:52 Start listening to port: 17555
2022/04/14 02:02:52 Start listening to port: 10507
2022/04/14 02:02:52 Start listening to port: 18013
2022/04/14 02:02:52 Successfully connect all nodes
2022/04/14 02:02:52 Successfully connect all nodes
2022/04/14 02:02:52 Successfully connect all nodes
2022/04/14 02:02:52 Successfully connect all nodes
2022/04/14 02:02:52 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:02:55 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,48171868>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,48171868>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:48171868 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:02:56 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,48171868>,t1:put<test,653858132>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,653858132>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,48171868>,t1:put<test,653858132>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,653858132>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:0], nextIndex :map[1:2 2:2 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:48171868  Term:1 Key:"test" Value:653858132 ], kvStore: map[test:48171868]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:0], nextIndex :map[1:2 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88867 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88868 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88869 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88872 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88873 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88874 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 88866 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 88875 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:02:58 Start listening to port: 10507
node 0 Proxy started
2022/04/14 02:02:58 Start listening to port: 17555
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:02:58 Start listening to port: 11728
2022/04/14 02:02:58 Start listening to port: 18013
2022/04/14 02:02:58 Start listening to port: 14797
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:02:58 Successfully connect all nodes
2022/04/14 02:02:59 Successfully connect all nodes
2022/04/14 02:02:59 Successfully connect all nodes
2022/04/14 02:02:59 Successfully connect all nodes
Running testOneSimpleDelete:
2022/04/14 02:02:59 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:03:03 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,949299634>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:03:04 Receive propose from client
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,949299634>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:949299634  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,949299634>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,949299634>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:949299634  Term:1 Op:Delete Key:"test" ], kvStore: map[test:949299634]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88949 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88950 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88951 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88952 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88953 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88955 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88956 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88957 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 88958 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:03:06 Start listening to port: 14797
2022/04/14 02:03:06 Start listening to port: 11728
node 4 Proxy started
2022/04/14 02:03:06 Start listening to port: 10507
2022/04/14 02:03:06 Start listening to port: 18013
2022/04/14 02:03:06 Start listening to port: 17555
2022/04/14 02:03:06 Successfully connect all nodes
2022/04/14 02:03:06 Successfully connect all nodes
2022/04/14 02:03:06 Successfully connect all nodes
2022/04/14 02:03:06 Successfully connect all nodes
2022/04/14 02:03:06 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:03:10 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:03:11 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1493933520>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
node 2 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1493933520  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1493933520  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1493933520]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89041 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89042 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89043 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89044 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89045 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89047 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89048 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89049 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89050 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:02:25 testOneCandidateOneRoundElection PASS
2022/04/14 02:02:29 testOneCandidateStartTwoElection PASS
2022/04/14 02:02:35 testTwoCandidateForElection PASS
2022/04/14 02:02:40 testSplitVote PASS
2022/04/14 02:02:43 testAllForElection PASS
2022/04/14 02:02:47 testLeaderRevertToFollower PASS
2022/04/14 02:02:52 testOneSimplePut PASS
2022/04/14 02:02:58 testOneSimpleUpdate PASS
2022/04/14 02:03:06 testOneSimpleDelete PASS
2022/04/14 02:03:13 testDeleteNonExistKey PASS

29
2022-04-14 02:03:18
All real ports: 12393 12496 14345 13237 13462
All proxy ports: 12543 11327 12424 12681 13232
node 1 Proxy started
node 2 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:03:21 Start listening to port: 14345
2022/04/14 02:03:21 Start listening to port: 12393
2022/04/14 02:03:21 Start listening to port: 13237
2022/04/14 02:03:21 Start listening to port: 12496
2022/04/14 02:03:21 Start listening to port: 13462
2022/04/14 02:03:21 Successfully connect all nodes
2022/04/14 02:03:21 Successfully connect all nodes
2022/04/14 02:03:21 Successfully connect all nodes
2022/04/14 02:03:21 Successfully connect all nodes
2022/04/14 02:03:21 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89955 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89960 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89961 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89962 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 89963 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:03:24 Start listening to port: 12496
2022/04/14 02:03:24 Start listening to port: 12393
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:03:24 Start listening to port: 13237
2022/04/14 02:03:24 Start listening to port: 14345
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:03:24 Successfully connect all nodes
2022/04/14 02:03:24 Successfully connect all nodes
2022/04/14 02:03:24 Start listening to port: 13462
2022/04/14 02:03:24 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 02:03:25 Successfully connect all nodes
2022/04/14 02:03:25 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90031 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90032 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90033 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90034 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90035 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90037 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90038 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90039 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90040 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:03:28 Start listening to port: 13237
2022/04/14 02:03:28 Start listening to port: 14345
2022/04/14 02:03:28 Start listening to port: 12393
2022/04/14 02:03:28 Start listening to port: 12496
2022/04/14 02:03:28 Start listening to port: 13462
2022/04/14 02:03:28 Successfully connect all nodes
2022/04/14 02:03:28 Successfully connect all nodes
2022/04/14 02:03:28 Successfully connect all nodes
2022/04/14 02:03:28 Successfully connect all nodes
2022/04/14 02:03:28 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90113 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90114 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90115 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90117 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90118 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90119 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90120 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:03:33 Start listening to port: 12393
2022/04/14 02:03:33 Start listening to port: 14345
2022/04/14 02:03:33 Start listening to port: 13237
2022/04/14 02:03:33 Start listening to port: 12496
2022/04/14 02:03:33 Start listening to port: 13462
2022/04/14 02:03:33 Successfully connect all nodes
2022/04/14 02:03:33 Successfully connect all nodes
2022/04/14 02:03:33 Successfully connect all nodes
2022/04/14 02:03:33 Successfully connect all nodes
2022/04/14 02:03:33 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90200 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
node 1 Proxy started
2022/04/14 02:03:38 Start listening to port: 12496
2022/04/14 02:03:38 Start listening to port: 12393
node 2 Proxy started
2022/04/14 02:03:38 Start listening to port: 14345
node 0 Proxy started
2022/04/14 02:03:38 Start listening to port: 13462
node 4 Proxy started
2022/04/14 02:03:38 Start listening to port: 13237
node 3 Proxy started
2022/04/14 02:03:38 Successfully connect all nodes
Running testAllForElection:
2022/04/14 02:03:39 Successfully connect all nodes
2022/04/14 02:03:39 Successfully connect all nodes
2022/04/14 02:03:39 Successfully connect all nodes
2022/04/14 02:03:39 Successfully connect all nodes
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90274 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90275 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90276 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90277 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90278 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90281 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90282 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90283 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:03:41 Start listening to port: 12393
2022/04/14 02:03:41 Start listening to port: 12496
node 2 Proxy started
2022/04/14 02:03:41 Start listening to port: 14345
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:03:41 Start listening to port: 13237
2022/04/14 02:03:41 Start listening to port: 13462
2022/04/14 02:03:41 Successfully connect all nodes
2022/04/14 02:03:41 Successfully connect all nodes
2022/04/14 02:03:41 Successfully connect all nodes
2022/04/14 02:03:41 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 02:03:42 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 2: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90369 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90370 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90371 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90372 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90373 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90375 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90376 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90377 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90378 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:03:45 Start listening to port: 12393
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:03:45 Start listening to port: 12496
2022/04/14 02:03:45 Start listening to port: 14345
2022/04/14 02:03:45 Start listening to port: 13462
2022/04/14 02:03:45 Start listening to port: 13237
2022/04/14 02:03:45 Successfully connect all nodes
2022/04/14 02:03:45 Successfully connect all nodes
2022/04/14 02:03:45 Successfully connect all nodes
2022/04/14 02:03:45 Successfully connect all nodes
2022/04/14 02:03:45 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:03:48 Receive propose from client
2022/04/14 02:03:48 Receive propose from client
2022/04/14 02:03:48 Receive propose from client
2022/04/14 02:03:48 Receive propose from client
2022/04/14 02:03:48 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2082379106>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2082379106>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2082379106>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2082379106>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2082379106 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:0], nextIndex :map[1:2 2:1 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90454 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90455 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90456 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90457 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90458 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90460 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90461 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90462 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90463 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:03:50 Start listening to port: 12496
node 1 Proxy started
node 2 Proxy started
2022/04/14 02:03:50 Start listening to port: 13462
node 4 Proxy started
2022/04/14 02:03:50 Start listening to port: 12393
2022/04/14 02:03:50 Start listening to port: 14345
2022/04/14 02:03:50 Start listening to port: 13237
2022/04/14 02:03:50 Successfully connect all nodes
2022/04/14 02:03:50 Successfully connect all nodes
2022/04/14 02:03:50 Successfully connect all nodes
2022/04/14 02:03:50 Successfully connect all nodes
2022/04/14 02:03:50 Successfully connect all nodes
Running testOneSimpleUpdate:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:03:53 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1049939293>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1049939293>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1049939293 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:03:54 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1731085656>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1731085656>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1049939293>,t1:put<test,1731085656>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1049939293>,t1:put<test,1731085656>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1049939293  Term:1 Key:"test" Value:1731085656 ], kvStore: map[test:1049939293]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90543 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90546 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90547 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90548 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90549 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:03:56 Start listening to port: 12496
2022/04/14 02:03:56 Start listening to port: 14345
2022/04/14 02:03:56 Start listening to port: 13237
2022/04/14 02:03:56 Start listening to port: 13462
2022/04/14 02:03:56 Start listening to port: 12393
node 3 Proxy started
2022/04/14 02:03:56 Successfully connect all nodes
2022/04/14 02:03:56 Successfully connect all nodes
2022/04/14 02:03:56 Successfully connect all nodes
2022/04/14 02:03:56 Successfully connect all nodes
Running testOneSimpleDelete:
2022/04/14 02:03:57 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:03:59 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1497149086>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:04:00 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1497149086>,t1:del<test,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1497149086  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1497149086>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1497149086>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1497149086  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1497149086]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90631 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90632 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90633 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90634 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90635 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90637 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90638 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90639 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90640 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:04:03 Start listening to port: 12496
2022/04/14 02:04:03 Start listening to port: 13462
2022/04/14 02:04:03 Start listening to port: 12393
2022/04/14 02:04:03 Start listening to port: 14345
node 0 Proxy started
2022/04/14 02:04:03 Start listening to port: 13237
2022/04/14 02:04:03 Successfully connect all nodes
2022/04/14 02:04:03 Successfully connect all nodes
2022/04/14 02:04:03 Successfully connect all nodes
2022/04/14 02:04:03 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 02:04:04 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:04:06 Receive propose from client
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:04:07 Receive propose from client
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1102336765>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1102336765  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 

当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1102336765  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1102336765]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90714 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90715 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90716 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90717 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90718 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90720 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90721 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90722 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 90723 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:03:24 testOneCandidateOneRoundElection PASS
2022/04/14 02:03:28 testOneCandidateStartTwoElection PASS
2022/04/14 02:03:33 testTwoCandidateForElection PASS
2022/04/14 02:03:38 testSplitVote PASS
2022/04/14 02:03:41 testAllForElection PASS
2022/04/14 02:03:45 testLeaderRevertToFollower PASS
2022/04/14 02:03:50 testOneSimplePut PASS
2022/04/14 02:03:56 testOneSimpleUpdate PASS
2022/04/14 02:04:03 testOneSimpleDelete PASS
2022/04/14 02:04:10 testDeleteNonExistKey PASS

30
2022-04-14 02:04:15
All real ports: 11334 16183 17240 10932 15067
All proxy ports: 13694 15941 14240 10668 18083
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:04:17 Start listening to port: 17240
2022/04/14 02:04:17 Start listening to port: 15067
2022/04/14 02:04:17 Start listening to port: 16183
2022/04/14 02:04:17 Start listening to port: 11334
2022/04/14 02:04:17 Start listening to port: 10932
2022/04/14 02:04:17 Successfully connect all nodes
2022/04/14 02:04:17 Successfully connect all nodes
2022/04/14 02:04:17 Successfully connect all nodes
2022/04/14 02:04:17 Successfully connect all nodes
2022/04/14 02:04:17 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
1node 3: dropped RequestVoteResponse to 0

初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 4: dropped RequestVoteResponse to 0
1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91626 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91635 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:04:20 Start listening to port: 11334
2022/04/14 02:04:20 Start listening to port: 16183
2022/04/14 02:04:20 Start listening to port: 17240
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:04:20 Start listening to port: 10932
2022/04/14 02:04:20 Start listening to port: 15067
2022/04/14 02:04:20 Successfully connect all nodes
2022/04/14 02:04:20 Successfully connect all nodes
2022/04/14 02:04:20 Successfully connect all nodes
2022/04/14 02:04:20 Successfully connect all nodes
2022/04/14 02:04:20 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91719 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
node 4 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:04:25 Start listening to port: 16183
node 1 Proxy started
2022/04/14 02:04:25 Start listening to port: 15067
2022/04/14 02:04:25 Start listening to port: 17240
2022/04/14 02:04:25 Start listening to port: 11334
2022/04/14 02:04:25 Start listening to port: 10932
2022/04/14 02:04:25 Successfully connect all nodes
2022/04/14 02:04:25 Successfully connect all nodes
2022/04/14 02:04:25 Successfully connect all nodes
2022/04/14 02:04:25 Successfully connect all nodes
2022/04/14 02:04:25 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91797 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91798 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91799 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91800 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91801 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91803 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91804 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91805 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91806 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 02:04:30 Start listening to port: 11334
node 4 Proxy started
2022/04/14 02:04:30 Start listening to port: 16183
2022/04/14 02:04:30 Start listening to port: 10932
2022/04/14 02:04:30 Start listening to port: 15067
2022/04/14 02:04:30 Successfully connect all nodes
2022/04/14 02:04:30 Start listening to port: 17240
2022/04/14 02:04:30 Successfully connect all nodes
2022/04/14 02:04:30 Successfully connect all nodes
2022/04/14 02:04:30 Successfully connect all nodes
2022/04/14 02:04:30 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 0 -> 3: granted, term: 2
1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91892 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91893 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91894 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91895 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91896 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91898 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91899 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91900 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91901 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:04:34 Start listening to port: 11334
node 1 Proxy started
2022/04/14 02:04:34 Start listening to port: 17240
node 4 Proxy started
2022/04/14 02:04:34 Start listening to port: 15067
2022/04/14 02:04:34 Start listening to port: 16183
node 3 Proxy started
2022/04/14 02:04:34 Start listening to port: 10932
2022/04/14 02:04:34 Successfully connect all nodes
2022/04/14 02:04:34 Successfully connect all nodes
2022/04/14 02:04:34 Successfully connect all nodes
Running testAllForElection:
2022/04/14 02:04:35 Successfully connect all nodes
2022/04/14 02:04:35 Successfully connect all nodes
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 4: granted, term: 2
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91977 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91978 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91979 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91980 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91981 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91983 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91984 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91985 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 91986 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:04:38 Start listening to port: 11334
2022/04/14 02:04:38 Start listening to port: 16183
node 4 Proxy started
2022/04/14 02:04:38 Start listening to port: 10932
2022/04/14 02:04:38 Start listening to port: 17240
2022/04/14 02:04:38 Start listening to port: 15067
2022/04/14 02:04:38 Successfully connect all nodes
2022/04/14 02:04:38 Successfully connect all nodes
2022/04/14 02:04:38 Successfully connect all nodes
2022/04/14 02:04:38 Successfully connect all nodes
2022/04/14 02:04:38 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92083 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92084 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92085 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92086 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92087 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92089 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92090 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92091 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92092 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:04:41 Start listening to port: 11334
2022/04/14 02:04:41 Start listening to port: 16183
2022/04/14 02:04:41 Start listening to port: 10932
2022/04/14 02:04:41 Start listening to port: 17240
2022/04/14 02:04:41 Start listening to port: 15067
2022/04/14 02:04:41 Successfully connect all nodes
2022/04/14 02:04:41 Successfully connect all nodes
2022/04/14 02:04:41 Successfully connect all nodes
2022/04/14 02:04:41 Successfully connect all nodes
2022/04/14 02:04:41 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:04:45 Receive propose from client
2022/04/14 02:04:45 Receive propose from client
2022/04/14 02:04:45 Receive propose from client
2022/04/14 02:04:45 Receive propose from client
2022/04/14 02:04:45 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1523864152>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1523864152>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1523864152>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1523864152>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1523864152 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 1AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 

响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92165 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92166 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92167 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92168 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92169 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92171 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92174 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:04:46 Start listening to port: 11334
2022/04/14 02:04:46 Start listening to port: 16183
2022/04/14 02:04:46 Start listening to port: 17240
2022/04/14 02:04:46 Start listening to port: 15067
2022/04/14 02:04:46 Start listening to port: 10932
2022/04/14 02:04:46 Successfully connect all nodes
2022/04/14 02:04:46 Successfully connect all nodes
2022/04/14 02:04:46 Successfully connect all nodes
2022/04/14 02:04:46 Successfully connect all nodes
2022/04/14 02:04:46 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:04:50 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2034799075>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2034799075>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2034799075 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:04:50 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1364404866>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1364404866>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2034799075>,t1:put<test,1364404866>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2034799075>,t1:put<test,1364404866>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2034799075  Term:1 Key:"test" Value:1364404866 ], kvStore: map[test:2034799075]  
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92247 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92248 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92249 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92250 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92251 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92253 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92256 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:04:52 Start listening to port: 16183
node 1 Proxy started
2022/04/14 02:04:52 Start listening to port: 17240
2022/04/14 02:04:52 Start listening to port: 10932
2022/04/14 02:04:52 Start listening to port: 11334
2022/04/14 02:04:52 Start listening to port: 15067
2022/04/14 02:04:52 Successfully connect all nodes
2022/04/14 02:04:52 Successfully connect all nodes
2022/04/14 02:04:52 Successfully connect all nodes
2022/04/14 02:04:52 Successfully connect all nodes
2022/04/14 02:04:52 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:04:56 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183062554>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:04:57 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183062554>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:183062554  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183062554>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,183062554>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
node 4 -> 0: success, term: 1, matchIdx: 2
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:183062554  Term:1 Op:Delete Key:"test" ], kvStore: map[test:183062554]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92332 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92333 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92334 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92335 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92336 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92338 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92339 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92340 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92341 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:04:59 Start listening to port: 11334
2022/04/14 02:04:59 Start listening to port: 17240
2022/04/14 02:04:59 Start listening to port: 16183
2022/04/14 02:04:59 Start listening to port: 10932
node 4 Proxy started
2022/04/14 02:04:59 Start listening to port: 15067
2022/04/14 02:04:59 Successfully connect all nodes
2022/04/14 02:04:59 Successfully connect all nodes
2022/04/14 02:04:59 Successfully connect all nodes
2022/04/14 02:04:59 Successfully connect all nodes
2022/04/14 02:04:59 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:05:03 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:05:04 Receive propose from client
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,440406737>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:440406737  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:440406737  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:440406737]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92419 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92420 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92421 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92422 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92423 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92427 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 92428 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:04:20 testOneCandidateOneRoundElection PASS
2022/04/14 02:04:24 testOneCandidateStartTwoElection PASS
2022/04/14 02:04:30 testTwoCandidateForElection PASS
2022/04/14 02:04:34 testSplitVote PASS
2022/04/14 02:04:38 testAllForElection PASS
2022/04/14 02:04:41 testLeaderRevertToFollower PASS
2022/04/14 02:04:46 testOneSimplePut PASS
2022/04/14 02:04:52 testOneSimpleUpdate PASS
2022/04/14 02:04:59 testOneSimpleDelete PASS
2022/04/14 02:05:06 testDeleteNonExistKey PASS

31
2022-04-14 02:05:11
All real ports: 18209 16779 10956 11843 19018
All proxy ports: 10251 11288 14625 13616 11655
node 2 Proxy started
node 4 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:05:17 Start listening to port: 11843
2022/04/14 02:05:17 Start listening to port: 19018
2022/04/14 02:05:17 Start listening to port: 10956
2022/04/14 02:05:17 Start listening to port: 18209
2022/04/14 02:05:17 Start listening to port: 16779
2022/04/14 02:05:17 Successfully connect all nodes
2022/04/14 02:05:17 Successfully connect all nodes
2022/04/14 02:05:17 Successfully connect all nodes
2022/04/14 02:05:17 Successfully connect all nodes
2022/04/14 02:05:17 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93366 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93367 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93368 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93369 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93370 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93372 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93373 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93374 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93375 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:05:20 Start listening to port: 19018
2022/04/14 02:05:20 Start listening to port: 16779
2022/04/14 02:05:20 Start listening to port: 11843
2022/04/14 02:05:20 Start listening to port: 18209
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:05:20 Start listening to port: 10956
2022/04/14 02:05:20 Successfully connect all nodes
2022/04/14 02:05:20 Successfully connect all nodes
2022/04/14 02:05:20 Successfully connect all nodes
2022/04/14 02:05:20 Successfully connect all nodes
2022/04/14 02:05:20 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93451 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93452 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93453 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93454 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93455 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93457 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93458 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93459 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93460 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:05:24 Start listening to port: 16779
2022/04/14 02:05:24 Start listening to port: 18209
node 3 Proxy started
2022/04/14 02:05:24 Start listening to port: 10956
node 4 Proxy started
node 0 Proxy started
2022/04/14 02:05:24 Start listening to port: 11843
2022/04/14 02:05:24 Start listening to port: 19018
2022/04/14 02:05:24 Successfully connect all nodes
2022/04/14 02:05:24 Successfully connect all nodes
2022/04/14 02:05:24 Successfully connect all nodes
2022/04/14 02:05:24 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 02:05:25 Successfully connect all nodes
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93532 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93533 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93534 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93535 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93537 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93539 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93540 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93541 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93542 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 02:05:29 Start listening to port: 18209
2022/04/14 02:05:29 Start listening to port: 10956
2022/04/14 02:05:29 Start listening to port: 11843
2022/04/14 02:05:29 Start listening to port: 16779
2022/04/14 02:05:29 Start listening to port: 19018
2022/04/14 02:05:29 Successfully connect all nodes
2022/04/14 02:05:29 Successfully connect all nodes
2022/04/14 02:05:29 Successfully connect all nodes
2022/04/14 02:05:29 Successfully connect all nodes
2022/04/14 02:05:29 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93615 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93616 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93617 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93618 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93619 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93621 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93622 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93623 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93624 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:05:33 Start listening to port: 18209
2022/04/14 02:05:33 Start listening to port: 10956
2022/04/14 02:05:33 Start listening to port: 11843
2022/04/14 02:05:33 Start listening to port: 19018
2022/04/14 02:05:33 Start listening to port: 16779
2022/04/14 02:05:33 Successfully connect all nodes
2022/04/14 02:05:33 Successfully connect all nodes
2022/04/14 02:05:33 Successfully connect all nodes
2022/04/14 02:05:33 Successfully connect all nodes
2022/04/14 02:05:33 Successfully connect all nodes
Running testAllForElection:
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93704 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93710 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93711 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93712 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93713 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:05:37 Start listening to port: 11843
2022/04/14 02:05:37 Start listening to port: 16779
2022/04/14 02:05:37 Start listening to port: 18209
2022/04/14 02:05:37 Start listening to port: 10956
node 3 Proxy started
node 1 Proxy started
2022/04/14 02:05:37 Start listening to port: 19018
2022/04/14 02:05:37 Successfully connect all nodes
2022/04/14 02:05:37 Successfully connect all nodes
Running testLeaderRevertToFollower:
2022/04/14 02:05:38 Successfully connect all nodes
2022/04/14 02:05:38 Successfully connect all nodes
2022/04/14 02:05:38 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93797 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93798 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93799 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93800 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93801 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93803 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93804 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93805 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93806 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:05:41 Start listening to port: 18209
2022/04/14 02:05:41 Start listening to port: 16779
2022/04/14 02:05:41 Start listening to port: 10956
2022/04/14 02:05:41 Start listening to port: 11843
2022/04/14 02:05:41 Start listening to port: 19018
2022/04/14 02:05:41 Successfully connect all nodes
2022/04/14 02:05:41 Successfully connect all nodes
2022/04/14 02:05:41 Successfully connect all nodes
2022/04/14 02:05:41 Successfully connect all nodes
2022/04/14 02:05:41 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:05:44 Receive propose from client
2022/04/14 02:05:44 Receive propose from client
2022/04/14 02:05:44 Receive propose from client
2022/04/14 02:05:44 Receive propose from client
2022/04/14 02:05:44 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1301431601>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1301431601>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1301431601>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1301431601>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
node 2 -> 0: success, term: 1, matchIdx: 1
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1301431601 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:1], nextIndex :map[1:1 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93879 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93880 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93881 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93882 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93883 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93885 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93886 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93887 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93888 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:05:46 Start listening to port: 18209
2022/04/14 02:05:46 Start listening to port: 16779
2022/04/14 02:05:46 Start listening to port: 10956
2022/04/14 02:05:46 Start listening to port: 11843
2022/04/14 02:05:46 Start listening to port: 19018
node 1 Proxy started
2022/04/14 02:05:46 Successfully connect all nodes
2022/04/14 02:05:46 Successfully connect all nodes
2022/04/14 02:05:46 Successfully connect all nodes
2022/04/14 02:05:46 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 02:05:47 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:05:49 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,259676655>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,259676655>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:259676655 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:05:50 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1099848087>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,259676655>,t1:put<test,1099848087>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1099848087>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,259676655>,t1:put<test,1099848087>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
当前leder的commit次数是:0
node 4 -> 0: success, term: 1, matchIdx: 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:259676655  Term:1 Key:"test" Value:1099848087 ], kvStore: map[test:259676655]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 

AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93969 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93970 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93971 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93972 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93973 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93975 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93976 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93977 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 93978 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:05:52 Start listening to port: 18209
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:05:52 Start listening to port: 10956
2022/04/14 02:05:52 Start listening to port: 11843
2022/04/14 02:05:52 Start listening to port: 16779
2022/04/14 02:05:52 Start listening to port: 19018
2022/04/14 02:05:52 Successfully connect all nodes
2022/04/14 02:05:52 Successfully connect all nodes
2022/04/14 02:05:52 Successfully connect all nodes
2022/04/14 02:05:52 Successfully connect all nodes
2022/04/14 02:05:52 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:05:55 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1496593978>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:05:56 Receive propose from client
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1496593978>,t1:del<test,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1496593978  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1496593978>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1496593978>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1496593978  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1496593978]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： node 4 -> 0: success, term: 1, matchIdx: 2
3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94053 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94054 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94055 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94056 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94057 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94059 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94060 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94061 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94062 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
node 0 Proxy started
2022/04/14 02:05:59 Start listening to port: 16779
node 1 Proxy started
2022/04/14 02:05:59 Start listening to port: 10956
2022/04/14 02:05:59 Start listening to port: 11843
2022/04/14 02:05:59 Start listening to port: 18209
2022/04/14 02:05:59 Start listening to port: 19018
2022/04/14 02:05:59 Successfully connect all nodes
2022/04/14 02:05:59 Successfully connect all nodes
2022/04/14 02:05:59 Successfully connect all nodes
2022/04/14 02:05:59 Successfully connect all nodes
2022/04/14 02:05:59 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:06:02 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:06:03 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,713813695>,t1:del<test2,0>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:0 4:0], nextIndex :map[1:1 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:713813695  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
当前的commitNum是:2
响应成功。更新之后：rn.nextIndex[hostId]： 当前leder的commit次数是:1
3超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交

commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:713813695  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:713813695]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94146 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94147 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94148 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94149 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94150 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94152 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94153 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94154 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 94155 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:05:20 testOneCandidateOneRoundElection PASS
2022/04/14 02:05:24 testOneCandidateStartTwoElection PASS
2022/04/14 02:05:29 testTwoCandidateForElection PASS
2022/04/14 02:05:33 testSplitVote PASS
2022/04/14 02:05:37 testAllForElection PASS
2022/04/14 02:05:41 testLeaderRevertToFollower PASS
2022/04/14 02:05:46 testOneSimplePut PASS
2022/04/14 02:05:52 testOneSimpleUpdate PASS
2022/04/14 02:05:59 testOneSimpleDelete PASS
2022/04/14 02:06:06 testDeleteNonExistKey PASS

32
2022-04-14 02:06:11
All real ports: 13303 19846 14941 10520 14235
All proxy ports: 19128 19328 13733 16734 16211
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:06:13 Start listening to port: 19846
2022/04/14 02:06:13 Start listening to port: 14941
2022/04/14 02:06:13 Start listening to port: 10520
2022/04/14 02:06:13 Start listening to port: 14235
2022/04/14 02:06:13 Start listening to port: 13303
2022/04/14 02:06:13 Successfully connect all nodes
2022/04/14 02:06:13 Successfully connect all nodes
2022/04/14 02:06:13 Successfully connect all nodes
2022/04/14 02:06:13 Successfully connect all nodes
2022/04/14 02:06:13 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95179 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95180 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95181 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95182 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95184 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95185 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95186 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95187 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:06:16 Start listening to port: 14235
2022/04/14 02:06:16 Start listening to port: 19846
2022/04/14 02:06:16 Start listening to port: 10520
2022/04/14 02:06:16 Start listening to port: 13303
2022/04/14 02:06:16 Start listening to port: 14941
node 2 Proxy started
2022/04/14 02:06:16 Successfully connect all nodes
2022/04/14 02:06:16 Successfully connect all nodes
2022/04/14 02:06:16 Successfully connect all nodes
2022/04/14 02:06:16 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 02:06:17 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 2
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 2
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95260 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95261 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95262 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95263 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95264 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95267 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95268 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95269 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:06:20 Start listening to port: 13303
2022/04/14 02:06:20 Start listening to port: 19846
2022/04/14 02:06:20 Start listening to port: 10520
2022/04/14 02:06:20 Start listening to port: 14941
2022/04/14 02:06:20 Start listening to port: 14235
2022/04/14 02:06:20 Successfully connect all nodes
2022/04/14 02:06:20 Successfully connect all nodes
2022/04/14 02:06:20 Successfully connect all nodes
2022/04/14 02:06:20 Successfully connect all nodes
2022/04/14 02:06:20 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 2: reject, term: 1
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95347 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95348 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95349 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95350 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95351 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95353 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95354 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95355 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95356 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:06:25 Start listening to port: 19846
2022/04/14 02:06:25 Start listening to port: 13303
node 3 Proxy started
node 0 Proxy started
2022/04/14 02:06:25 Start listening to port: 14235
2022/04/14 02:06:25 Start listening to port: 10520
2022/04/14 02:06:25 Start listening to port: 14941
2022/04/14 02:06:25 Successfully connect all nodes
2022/04/14 02:06:25 Successfully connect all nodes
2022/04/14 02:06:25 Successfully connect all nodes
2022/04/14 02:06:25 Successfully connect all nodes
Running testSplitVote:
2022/04/14 02:06:26 Successfully connect all nodes
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95437 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95438 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95439 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95440 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95441 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95443 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95444 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95445 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95446 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:06:29 Start listening to port: 13303
node 4 Proxy started
2022/04/14 02:06:29 Start listening to port: 14941
2022/04/14 02:06:29 Start listening to port: 19846
2022/04/14 02:06:29 Start listening to port: 14235
2022/04/14 02:06:29 Start listening to port: 10520
2022/04/14 02:06:30 Successfully connect all nodes
2022/04/14 02:06:30 Successfully connect all nodes
2022/04/14 02:06:30 Successfully connect all nodes
2022/04/14 02:06:30 Successfully connect all nodes
2022/04/14 02:06:30 Successfully connect all nodes
Running testAllForElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 2 -> 3: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 2 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 2 -> 4: reject, term: 1
node 3 -> 4: reject, term: 1
node 0 -> 4: reject, term: 1
node 1 -> 4: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 2: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 4: granted, term: 2
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95520 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95521 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95522 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95523 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95524 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95526 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95527 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95528 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95529 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 4 Proxy started
2022/04/14 02:06:33 Start listening to port: 13303
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:06:33 Start listening to port: 14941
2022/04/14 02:06:33 Start listening to port: 19846
2022/04/14 02:06:33 Start listening to port: 10520
2022/04/14 02:06:33 Start listening to port: 14235
2022/04/14 02:06:33 Successfully connect all nodes
2022/04/14 02:06:33 Successfully connect all nodes
2022/04/14 02:06:33 Successfully connect all nodes
2022/04/14 02:06:33 Successfully connect all nodes
2022/04/14 02:06:33 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95620 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95621 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95622 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95623 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95624 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95626 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95627 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95628 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95629 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:06:37 Start listening to port: 13303
node 3 Proxy started
2022/04/14 02:06:37 Start listening to port: 14941
2022/04/14 02:06:37 Start listening to port: 19846
2022/04/14 02:06:37 Start listening to port: 10520
2022/04/14 02:06:37 Start listening to port: 14235
2022/04/14 02:06:37 Successfully connect all nodes
2022/04/14 02:06:37 Successfully connect all nodes
2022/04/14 02:06:37 Successfully connect all nodes
2022/04/14 02:06:37 Successfully connect all nodes
2022/04/14 02:06:37 Successfully connect all nodes
Running testOneSimplePut:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:06:40 Receive propose from client
2022/04/14 02:06:40 Receive propose from client
2022/04/14 02:06:40 Receive propose from client
2022/04/14 02:06:40 Receive propose from client
2022/04/14 02:06:40 Receive propose from client
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,406911810>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,406911810>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,406911810>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,406911810>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 4 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:0], nextIndex :map[1:1 2:1 3:2 4:1] 
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:406911810 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:1], nextIndex :map[1:1 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95708 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95709 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95710 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95711 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95712 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95714 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95715 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95717 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95718 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:06:42 Start listening to port: 14941
2022/04/14 02:06:42 Start listening to port: 13303
node 4 Proxy started
2022/04/14 02:06:42 Start listening to port: 14235
node 3 Proxy started
2022/04/14 02:06:42 Start listening to port: 19846
node 0 Proxy started
2022/04/14 02:06:42 Start listening to port: 10520
2022/04/14 02:06:42 Successfully connect all nodes
2022/04/14 02:06:42 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 02:06:43 Successfully connect all nodes
2022/04/14 02:06:43 Successfully connect all nodes
2022/04/14 02:06:43 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:06:45 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066208555>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066208555>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2066208555 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:06:46 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1804347943>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066208555>,t1:put<test,1804347943>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2066208555>,t1:put<test,1804347943>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1804347943>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 1 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2066208555  Term:1 Key:"test" Value:1804347943 ], kvStore: map[test:2066208555]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95793 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95798 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95799 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:06:48 Start listening to port: 13303
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:06:48 Start listening to port: 14941
2022/04/14 02:06:48 Start listening to port: 10520
2022/04/14 02:06:48 Start listening to port: 19846
2022/04/14 02:06:48 Start listening to port: 14235
2022/04/14 02:06:48 Successfully connect all nodes
2022/04/14 02:06:48 Successfully connect all nodes
2022/04/14 02:06:48 Successfully connect all nodes
2022/04/14 02:06:48 Successfully connect all nodes
Running testOneSimpleDelete:
2022/04/14 02:06:49 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:06:51 Receive propose from client
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1986294864>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:06:52 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1986294864>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1986294864  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1986294864>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1986294864>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1986294864  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1986294864]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95882 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95883 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95884 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95885 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95886 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95888 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95889 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95890 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95891 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:06:55 Start listening to port: 14235
2022/04/14 02:06:55 Start listening to port: 10520
2022/04/14 02:06:55 Start listening to port: 14941
2022/04/14 02:06:55 Start listening to port: 19846
node 4 Proxy started
2022/04/14 02:06:55 Start listening to port: 13303
2022/04/14 02:06:55 Successfully connect all nodes
2022/04/14 02:06:55 Successfully connect all nodes
2022/04/14 02:06:55 Successfully connect all nodes
2022/04/14 02:06:55 Successfully connect all nodes
2022/04/14 02:06:55 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:06:59 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:07:00 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,589025682>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:589025682  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:589025682  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:589025682]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95969 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95970 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95971 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95972 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95974 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 95976 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
2022/04/14 02:06:16 testOneCandidateOneRoundElection PASS
2022/04/14 02:06:20 testOneCandidateStartTwoElection PASS
2022/04/14 02:06:25 testTwoCandidateForElection PASS
2022/04/14 02:06:29 testSplitVote PASS
2022/04/14 02:06:33 testAllForElection PASS
2022/04/14 02:06:37 testLeaderRevertToFollower PASS
2022/04/14 02:06:42 testOneSimplePut PASS
2022/04/14 02:06:48 testOneSimpleUpdate PASS
2022/04/14 02:06:55 testOneSimpleDelete PASS
2022/04/14 02:07:02 testDeleteNonExistKey PASS

33
2022-04-14 02:07:08
All real ports: 11855 10868 15856 15946 11684
All proxy ports: 17986 10873 18005 14799 10276
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:07:10 Start listening to port: 11684
2022/04/14 02:07:10 Start listening to port: 15856
2022/04/14 02:07:10 Start listening to port: 10868
2022/04/14 02:07:10 Start listening to port: 15946
2022/04/14 02:07:10 Start listening to port: 11855
2022/04/14 02:07:10 Successfully connect all nodes
2022/04/14 02:07:10 Successfully connect all nodes
2022/04/14 02:07:10 Successfully connect all nodes
2022/04/14 02:07:10 Successfully connect all nodes
2022/04/14 02:07:10 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96856 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96857 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96858 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96859 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96861 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96863 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96864 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96865 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96866 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 02:07:13 Start listening to port: 11855
node 4 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:07:13 Start listening to port: 15946
2022/04/14 02:07:13 Start listening to port: 10868
2022/04/14 02:07:13 Start listening to port: 15856
2022/04/14 02:07:13 Start listening to port: 11684
2022/04/14 02:07:13 Successfully connect all nodes
2022/04/14 02:07:13 Successfully connect all nodes
2022/04/14 02:07:13 Successfully connect all nodes
2022/04/14 02:07:13 Successfully connect all nodes
2022/04/14 02:07:13 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVote from 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96943 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96944 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96945 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96946 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96947 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96950 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96951 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 96952 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:07:17 Start listening to port: 11855
2022/04/14 02:07:17 Start listening to port: 15856
2022/04/14 02:07:17 Start listening to port: 10868
2022/04/14 02:07:17 Start listening to port: 15946
2022/04/14 02:07:17 Start listening to port: 11684
2022/04/14 02:07:17 Successfully connect all nodes
2022/04/14 02:07:17 Successfully connect all nodes
2022/04/14 02:07:17 Successfully connect all nodes
2022/04/14 02:07:17 Successfully connect all nodes
2022/04/14 02:07:17 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97024 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97025 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97026 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97027 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97028 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97030 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97031 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97032 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97033 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:07:22 Start listening to port: 11855
2022/04/14 02:07:22 Start listening to port: 15856
2022/04/14 02:07:22 Start listening to port: 15946
2022/04/14 02:07:22 Start listening to port: 10868
2022/04/14 02:07:22 Start listening to port: 11684
2022/04/14 02:07:22 Successfully connect all nodes
2022/04/14 02:07:22 Successfully connect all nodes
2022/04/14 02:07:22 Successfully connect all nodes
2022/04/14 02:07:22 Successfully connect all nodes
2022/04/14 02:07:22 Successfully connect all nodes
Running testSplitVote:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97110 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97113 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97114 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97117 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97118 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97119 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:07:27 Start listening to port: 11855
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:07:27 Start listening to port: 10868
2022/04/14 02:07:27 Start listening to port: 15946
2022/04/14 02:07:27 Start listening to port: 11684
2022/04/14 02:07:27 Start listening to port: 15856
2022/04/14 02:07:27 Successfully connect all nodes
2022/04/14 02:07:27 Successfully connect all nodes
2022/04/14 02:07:27 Successfully connect all nodes
2022/04/14 02:07:27 Successfully connect all nodes
2022/04/14 02:07:27 Successfully connect all nodes
Running testAllForElection:
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 0 -> 3: reject, term: 1
node 1 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 1 -> 0: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97192 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97193 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97194 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97195 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97196 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97199 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97200 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97201 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:07:31 Start listening to port: 11855
node 4 Proxy started
2022/04/14 02:07:31 Start listening to port: 15856
2022/04/14 02:07:31 Start listening to port: 15946
2022/04/14 02:07:31 Start listening to port: 10868
2022/04/14 02:07:31 Start listening to port: 11684
2022/04/14 02:07:31 Successfully connect all nodes
2022/04/14 02:07:31 Successfully connect all nodes
2022/04/14 02:07:31 Successfully connect all nodes
2022/04/14 02:07:31 Successfully connect all nodes
2022/04/14 02:07:31 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0

初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97286 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97287 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97288 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97289 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97290 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97293 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97295 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:07:34 Start listening to port: 10868
2022/04/14 02:07:34 Start listening to port: 11855
2022/04/14 02:07:34 Start listening to port: 15856
2022/04/14 02:07:34 Start listening to port: 15946
2022/04/14 02:07:34 Start listening to port: 11684
2022/04/14 02:07:34 Successfully connect all nodes
2022/04/14 02:07:34 Successfully connect all nodes
2022/04/14 02:07:34 Successfully connect all nodes
2022/04/14 02:07:34 Successfully connect all nodes
2022/04/14 02:07:34 Successfully connect all nodes
Running testOneSimplePut:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:07:38 Receive propose from client
2022/04/14 02:07:38 Receive propose from client
2022/04/14 02:07:38 Receive propose from client
2022/04/14 02:07:38 Receive propose from client
2022/04/14 02:07:38 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1281864159>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1281864159>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1281864159>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1281864159>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 1 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1281864159 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:1], nextIndex :map[1:1 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97369 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97371 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97372 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97373 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97378 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 02:07:39 Start listening to port: 11855
node 3 Proxy started
2022/04/14 02:07:39 Start listening to port: 15946
2022/04/14 02:07:39 Start listening to port: 11684
2022/04/14 02:07:39 Start listening to port: 10868
node 4 Proxy started
2022/04/14 02:07:39 Start listening to port: 15856
node 1 Proxy started
2022/04/14 02:07:39 Successfully connect all nodes
node 2 Proxy started
Running testOneSimpleUpdate:
2022/04/14 02:07:40 Successfully connect all nodes
2022/04/14 02:07:40 Successfully connect all nodes
2022/04/14 02:07:40 Successfully connect all nodes
2022/04/14 02:07:40 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:07:43 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,222222298>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,222222298>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
当前的commitNum是:2
响应成功。更新之后：rn.nextIndex[hostId]： 当前leder的commit次数是:0
2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:222222298 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:07:43 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,436503365>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,436503365>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,222222298>,t1:put<test,436503365>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,222222298>,t1:put<test,436503365>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:222222298  Term:1 Key:"test" Value:436503365 ], kvStore: map[test:222222298]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 

响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97451 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97452 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97453 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97454 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97455 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97457 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97458 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97459 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97460 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:07:45 Start listening to port: 10868
2022/04/14 02:07:45 Start listening to port: 11855
node 1 Proxy started
2022/04/14 02:07:45 Start listening to port: 15946
2022/04/14 02:07:45 Start listening to port: 15856
2022/04/14 02:07:45 Start listening to port: 11684
2022/04/14 02:07:45 Successfully connect all nodes
2022/04/14 02:07:45 Successfully connect all nodes
2022/04/14 02:07:45 Successfully connect all nodes
2022/04/14 02:07:45 Successfully connect all nodes
2022/04/14 02:07:45 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:07:49 Receive propose from client
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,100610083>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:07:50 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,100610083>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:100610083  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,100610083>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,100610083>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:100610083  Term:1 Op:Delete Key:"test" ], kvStore: map[test:100610083]  
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
node 1 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97531 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97532 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97533 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97534 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97535 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97537 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97539 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97540 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:07:52 Start listening to port: 11855
2022/04/14 02:07:52 Start listening to port: 10868
node 4 Proxy started
2022/04/14 02:07:52 Start listening to port: 15856
2022/04/14 02:07:52 Start listening to port: 15946
2022/04/14 02:07:52 Start listening to port: 11684
2022/04/14 02:07:52 Successfully connect all nodes
2022/04/14 02:07:52 Successfully connect all nodes
2022/04/14 02:07:52 Successfully connect all nodes
2022/04/14 02:07:52 Successfully connect all nodes
2022/04/14 02:07:52 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:07:56 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:07:57 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,208529609>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
node 2 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
node 3 -> 0: success, term: 1, matchIdx: 2
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:208529609  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 当前的commitNum是:2
3当前leder的commit次数是:1

超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:208529609  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:208529609]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97615 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97616 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97617 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97618 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97619 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97621 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97622 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97623 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 97624 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:07:13 testOneCandidateOneRoundElection PASS
2022/04/14 02:07:17 testOneCandidateStartTwoElection PASS
2022/04/14 02:07:22 testTwoCandidateForElection PASS
2022/04/14 02:07:27 testSplitVote PASS
2022/04/14 02:07:31 testAllForElection PASS
2022/04/14 02:07:34 testLeaderRevertToFollower PASS
2022/04/14 02:07:39 testOneSimplePut PASS
2022/04/14 02:07:45 testOneSimpleUpdate PASS
2022/04/14 02:07:52 testOneSimpleDelete PASS
2022/04/14 02:07:59 testDeleteNonExistKey PASS

34
2022-04-14 02:08:05
All real ports: 18625 19856 14872 13604 11832
All proxy ports: 11191 10367 13171 10634 19590
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:08:07 Start listening to port: 11832
2022/04/14 02:08:07 Start listening to port: 18625
2022/04/14 02:08:07 Start listening to port: 13604
2022/04/14 02:08:07 Start listening to port: 14872
2022/04/14 02:08:07 Start listening to port: 19856
2022/04/14 02:08:07 Successfully connect all nodes
2022/04/14 02:08:07 Successfully connect all nodes
2022/04/14 02:08:07 Successfully connect all nodes
2022/04/14 02:08:07 Successfully connect all nodes
2022/04/14 02:08:07 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
node 3: dropped RequestVoteResponse to 0
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98506 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98507 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98508 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98509 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 119: 98502 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
2022/04/14 02:08:10 Start listening to port: 13604
2022/04/14 02:08:10 Start listening to port: 11832
2022/04/14 02:08:10 Start listening to port: 14872
node 0 Proxy started
2022/04/14 02:08:10 Start listening to port: 18625
2022/04/14 02:08:10 Start listening to port: 19856
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
Running testOneCandidateStartTwoElection:
2022/04/14 02:08:11 Successfully connect all nodes
2022/04/14 02:08:11 Successfully connect all nodes
2022/04/14 02:08:11 Successfully connect all nodes
2022/04/14 02:08:11 Successfully connect all nodes
2022/04/14 02:08:11 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98580 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98581 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98582 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98583 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98584 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98586 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98587 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98588 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98589 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:08:14 Start listening to port: 19856
2022/04/14 02:08:14 Start listening to port: 18625
2022/04/14 02:08:14 Start listening to port: 14872
2022/04/14 02:08:14 Start listening to port: 11832
2022/04/14 02:08:14 Start listening to port: 13604
2022/04/14 02:08:14 Successfully connect all nodes
2022/04/14 02:08:14 Successfully connect all nodes
2022/04/14 02:08:14 Successfully connect all nodes
2022/04/14 02:08:14 Successfully connect all nodes
2022/04/14 02:08:14 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98660 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98661 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98662 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98664 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98665 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98667 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98668 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98669 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98670 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:08:19 Start listening to port: 18625
node 4 Proxy started
2022/04/14 02:08:19 Start listening to port: 14872
2022/04/14 02:08:19 Start listening to port: 19856
2022/04/14 02:08:19 Start listening to port: 11832
2022/04/14 02:08:19 Start listening to port: 13604
2022/04/14 02:08:19 Successfully connect all nodes
2022/04/14 02:08:19 Successfully connect all nodes
2022/04/14 02:08:19 Successfully connect all nodes
2022/04/14 02:08:19 Successfully connect all nodes
2022/04/14 02:08:19 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98743 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98744 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98745 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98746 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98747 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98749 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98750 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98751 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98752 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
node 0 Proxy started
2022/04/14 02:08:24 Start listening to port: 18625
2022/04/14 02:08:24 Start listening to port: 19856
2022/04/14 02:08:24 Start listening to port: 13604
2022/04/14 02:08:24 Start listening to port: 14872
2022/04/14 02:08:24 Start listening to port: 11832
2022/04/14 02:08:24 Successfully connect all nodes
2022/04/14 02:08:24 Successfully connect all nodes
2022/04/14 02:08:24 Successfully connect all nodes
2022/04/14 02:08:24 Successfully connect all nodes
2022/04/14 02:08:24 Successfully connect all nodes
Running testAllForElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 3: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 1 -> 0: reject, term: 1
node 2 -> 1: reject, term: 1
node 1 -> 3: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 2 -> 4: granted, term: 2
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: granted, term: 2
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
1node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0

node 0 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
初始化nextIndex[]，其中的每一项为: node 0 -> 4: reject, term: 1
1
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1node 0 -> 4: granted, term: 2

初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98825 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98826 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98830 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98834 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98835 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98836 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98837 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 02:08:28 Start listening to port: 19856
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:08:28 Start listening to port: 18625
node 2 Proxy started
node 1 Proxy started
Running testLeaderRevertToFollower:
2022/04/14 02:08:28 Start listening to port: 11832
2022/04/14 02:08:28 Start listening to port: 14872
2022/04/14 02:08:28 Successfully connect all nodes
2022/04/14 02:08:28 Successfully connect all nodes
2022/04/14 02:08:28 Start listening to port: 13604
2022/04/14 02:08:28 Successfully connect all nodes
2022/04/14 02:08:29 Successfully connect all nodes
2022/04/14 02:08:29 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98919 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98922 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98923 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98924 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98925 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98927 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98928 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98929 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 98930 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:08:31 Start listening to port: 14872
node 0 Proxy started
2022/04/14 02:08:31 Start listening to port: 13604
2022/04/14 02:08:31 Start listening to port: 11832
2022/04/14 02:08:31 Successfully connect all nodes
2022/04/14 02:08:31 Start listening to port: 18625
2022/04/14 02:08:31 Start listening to port: 19856
node 3 Proxy started
2022/04/14 02:08:31 Successfully connect all nodes
2022/04/14 02:08:31 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 02:08:32 Successfully connect all nodes
2022/04/14 02:08:32 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:08:36 Receive propose from client
2022/04/14 02:08:36 Receive propose from client
2022/04/14 02:08:36 Receive propose from client
2022/04/14 02:08:36 Receive propose from client
2022/04/14 02:08:36 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1303476019>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1303476019>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1303476019>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1303476019>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
node 2 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1303476019 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:1 4:1], nextIndex :map[1:1 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99044 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99045 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99046 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99047 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99048 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99051 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99052 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99053 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:08:38 Start listening to port: 13604
2022/04/14 02:08:38 Start listening to port: 19856
node 2 Proxy started
node 0 Proxy started
2022/04/14 02:08:38 Start listening to port: 14872
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:08:38 Start listening to port: 11832
2022/04/14 02:08:38 Start listening to port: 18625
node 3 Proxy started
2022/04/14 02:08:39 Successfully connect all nodes
2022/04/14 02:08:39 Successfully connect all nodes
2022/04/14 02:08:39 Successfully connect all nodes
2022/04/14 02:08:39 Successfully connect all nodes
2022/04/14 02:08:39 Successfully connect all nodes
Running testOneSimpleUpdate:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:08:42 Receive propose from client
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1951321252>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1951321252>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1951321252 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
node 3: dropped AppendEntries from 0
2022/04/14 02:08:43 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1829484383>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1951321252>,t1:put<test,1829484383>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1829484383>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1951321252>,t1:put<test,1829484383>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
node 3 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 当前的commitNum是:2
2当前leder的commit次数是:0

超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
响应成功。更新之后：rn.nextIndex[hostId]： 3
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:2], nextIndex :map[1:2 2:2 3:1 4:3] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1951321252  Term:1 Key:"test" Value:1829484383 ], kvStore: map[test:1951321252]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:2], nextIndex :map[1:2 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:2], nextIndex :map[1:3 2:3 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99156 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99157 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99158 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99159 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99160 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99163 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99164 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99165 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 02:08:45 Start listening to port: 18625
2022/04/14 02:08:45 Start listening to port: 19856
2022/04/14 02:08:45 Start listening to port: 14872
2022/04/14 02:08:45 Start listening to port: 11832
2022/04/14 02:08:45 Start listening to port: 13604
2022/04/14 02:08:45 Successfully connect all nodes
2022/04/14 02:08:45 Successfully connect all nodes
2022/04/14 02:08:45 Successfully connect all nodes
2022/04/14 02:08:45 Successfully connect all nodes
2022/04/14 02:08:45 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:08:48 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1856055385>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:08:49 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1856055385>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1856055385  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1856055385>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1856055385>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
当前的commitNum是:2
node 2 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1856055385  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1856055385]  
node 1 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99236 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99237 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99238 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99239 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99240 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99242 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99243 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99244 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99245 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:08:52 Start listening to port: 18625
2022/04/14 02:08:52 Start listening to port: 19856
2022/04/14 02:08:52 Start listening to port: 14872
2022/04/14 02:08:52 Start listening to port: 13604
2022/04/14 02:08:52 Start listening to port: 11832
2022/04/14 02:08:52 Successfully connect all nodes
2022/04/14 02:08:52 Successfully connect all nodes
2022/04/14 02:08:52 Successfully connect all nodes
2022/04/14 02:08:52 Successfully connect all nodes
2022/04/14 02:08:52 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:08:55 Receive propose from client
node 2: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:08:56 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>,t1:del<test2,0>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1006822627>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1006822627  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1006822627  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99326 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99327 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99328 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 99329 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:08:10 testOneCandidateOneRoundElection PASS
2022/04/14 02:08:14 testOneCandidateStartTwoElection PASS
2022/04/14 02:08:19 testTwoCandidateForElection PASS
2022/04/14 02:08:24 testSplitVote PASS
2022/04/14 02:08:28 testAllForElection PASS
2022/04/14 02:08:31 testLeaderRevertToFollower PASS
2022/04/14 02:08:37 testOneSimplePut PASS
2022/04/14 02:08:45 testOneSimpleUpdate PASS
2022/04/14 02:08:52 testOneSimpleDelete PASS
2022/04/14 02:08:59 testDeleteNonExistKey PASS

35
2022-04-14 02:09:04
All real ports: 12851 13945 16009 17197 17430
All proxy ports: 10602 17496 15397 10754 12650
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 02:09:07 Start listening to port: 16009
2022/04/14 02:09:07 Start listening to port: 13945
2022/04/14 02:09:07 Start listening to port: 17197
2022/04/14 02:09:07 Start listening to port: 12851
2022/04/14 02:09:07 Start listening to port: 17430
2022/04/14 02:09:07 Successfully connect all nodes
2022/04/14 02:09:07 Successfully connect all nodes
2022/04/14 02:09:07 Successfully connect all nodes
2022/04/14 02:09:07 Successfully connect all nodes
2022/04/14 02:09:07 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100243 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100244 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100245 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100246 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100247 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100249 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100250 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100251 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100252 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:09:10 Start listening to port: 12851
2022/04/14 02:09:10 Start listening to port: 13945
2022/04/14 02:09:10 Start listening to port: 16009
2022/04/14 02:09:10 Start listening to port: 17430
2022/04/14 02:09:10 Start listening to port: 17197
2022/04/14 02:09:10 Successfully connect all nodes
2022/04/14 02:09:10 Successfully connect all nodes
2022/04/14 02:09:10 Successfully connect all nodes
2022/04/14 02:09:10 Successfully connect all nodes
2022/04/14 02:09:10 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100324 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100325 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100326 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100327 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100328 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100330 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100331 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100332 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100333 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:09:14 Start listening to port: 12851
2022/04/14 02:09:14 Start listening to port: 13945
node 3 Proxy started
2022/04/14 02:09:14 Start listening to port: 16009
2022/04/14 02:09:14 Start listening to port: 17197
2022/04/14 02:09:14 Start listening to port: 17430
2022/04/14 02:09:14 Successfully connect all nodes
2022/04/14 02:09:14 Successfully connect all nodes
2022/04/14 02:09:14 Successfully connect all nodes
2022/04/14 02:09:14 Successfully connect all nodes
2022/04/14 02:09:14 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100412 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100413 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100415 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100418 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100420 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:09:19 Start listening to port: 12851
2022/04/14 02:09:19 Start listening to port: 13945
2022/04/14 02:09:19 Start listening to port: 16009
2022/04/14 02:09:19 Start listening to port: 17197
2022/04/14 02:09:19 Start listening to port: 17430
2022/04/14 02:09:19 Successfully connect all nodes
2022/04/14 02:09:19 Successfully connect all nodes
2022/04/14 02:09:19 Successfully connect all nodes
2022/04/14 02:09:19 Successfully connect all nodes
2022/04/14 02:09:19 Successfully connect all nodes
Running testSplitVote:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: granted, term: 2
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100499 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100500 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100501 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100502 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100503 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100505 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100506 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100507 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100508 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:09:24 Start listening to port: 12851
2022/04/14 02:09:24 Start listening to port: 16009
node 0 Proxy started
2022/04/14 02:09:24 Start listening to port: 17430
2022/04/14 02:09:24 Start listening to port: 17197
2022/04/14 02:09:24 Successfully connect all nodes
2022/04/14 02:09:24 Start listening to port: 13945
2022/04/14 02:09:24 Successfully connect all nodes
2022/04/14 02:09:24 Successfully connect all nodes
2022/04/14 02:09:24 Successfully connect all nodes
2022/04/14 02:09:24 Successfully connect all nodes
Running testAllForElection:
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 0 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 -> 4: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 3: reject, term: 1
node 3 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 1: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 0: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100582 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100583 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100585 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100586 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100588 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100589 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 02:09:28 Start listening to port: 12851
2022/04/14 02:09:28 Start listening to port: 13945
2022/04/14 02:09:28 Start listening to port: 16009
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:09:28 Start listening to port: 17197
2022/04/14 02:09:28 Start listening to port: 17430
2022/04/14 02:09:28 Successfully connect all nodes
2022/04/14 02:09:28 Successfully connect all nodes
2022/04/14 02:09:28 Successfully connect all nodes
2022/04/14 02:09:28 Successfully connect all nodes
2022/04/14 02:09:28 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 2: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100679 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100680 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100681 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100703 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100706 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100708 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100709 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100714 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100715 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:09:31 Start listening to port: 13945
2022/04/14 02:09:31 Start listening to port: 16009
2022/04/14 02:09:31 Start listening to port: 17197
2022/04/14 02:09:31 Start listening to port: 12851
2022/04/14 02:09:31 Start listening to port: 17430
2022/04/14 02:09:31 Successfully connect all nodes
2022/04/14 02:09:31 Successfully connect all nodes
2022/04/14 02:09:31 Successfully connect all nodes
2022/04/14 02:09:31 Successfully connect all nodes
2022/04/14 02:09:31 Successfully connect all nodes
Running testOneSimplePut:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:09:34 Receive propose from client
2022/04/14 02:09:34 Receive propose from client
2022/04/14 02:09:34 Receive propose from client
2022/04/14 02:09:34 Receive propose from client
2022/04/14 02:09:34 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1560454101>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1560454101>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1560454101>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1560454101>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1560454101 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:1], nextIndex :map[1:2 2:1 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100829 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100830 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100831 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100832 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100833 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100836 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100837 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100838 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100839 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 3 Proxy started
node 0 Proxy started
node 4 Proxy started
node 1 Proxy started
2022/04/14 02:09:36 Start listening to port: 16009
2022/04/14 02:09:36 Start listening to port: 13945
2022/04/14 02:09:36 Start listening to port: 17197
2022/04/14 02:09:36 Start listening to port: 12851
2022/04/14 02:09:36 Start listening to port: 17430
2022/04/14 02:09:36 Successfully connect all nodes
2022/04/14 02:09:36 Successfully connect all nodes
2022/04/14 02:09:36 Successfully connect all nodes
2022/04/14 02:09:36 Successfully connect all nodes
2022/04/14 02:09:36 Successfully connect all nodes
Running testOneSimpleUpdate:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:09:40 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,349319722>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,349319722>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
node 1 -> 0: success, term: 1, matchIdx: 1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:349319722 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:09:40 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1192608388>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,349319722>,t1:put<test,1192608388>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1192608388>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,349319722>,t1:put<test,1192608388>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:0 4:0], nextIndex :map[1:2 2:3 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:349319722  Term:1 Key:"test" Value:1192608388 ], kvStore: map[test:349319722]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:2 3:2 4:0], nextIndex :map[1:2 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100912 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100913 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100914 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100915 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100916 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100918 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100919 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100920 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 100921 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
2022/04/14 02:09:42 Start listening to port: 13945
2022/04/14 02:09:42 Start listening to port: 12851
2022/04/14 02:09:42 Start listening to port: 17197
2022/04/14 02:09:42 Start listening to port: 17430
2022/04/14 02:09:42 Start listening to port: 16009
2022/04/14 02:09:42 Successfully connect all nodes
2022/04/14 02:09:42 Successfully connect all nodes
2022/04/14 02:09:42 Successfully connect all nodes
2022/04/14 02:09:42 Successfully connect all nodes
2022/04/14 02:09:42 Successfully connect all nodes
Running testOneSimpleDelete:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
node 4 -> 0: granted, term: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:09:46 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2146469678>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:09:47 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2146469678>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2146469678  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2146469678>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2146469678>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:2146469678  Term:1 Op:Delete Key:"test" ], kvStore: map[test:2146469678]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101000 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101001 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101002 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101003 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101004 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101007 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101008 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101009 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 02:09:49 Start listening to port: 13945
2022/04/14 02:09:49 Start listening to port: 12851
node 4 Proxy started
2022/04/14 02:09:49 Start listening to port: 16009
2022/04/14 02:09:49 Start listening to port: 17430
2022/04/14 02:09:49 Start listening to port: 17197
2022/04/14 02:09:49 Successfully connect all nodes
2022/04/14 02:09:49 Successfully connect all nodes
2022/04/14 02:09:49 Successfully connect all nodes
2022/04/14 02:09:49 Successfully connect all nodes
2022/04/14 02:09:49 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:09:53 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:09:54 Receive propose from client
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>,t1:del<test2,0>], leaderCommit: 0
node 3: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1644805249>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:0], nextIndex :map[1:1 2:1 3:3 4:1] 
1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1644805249  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1644805249  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101088 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101089 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101090 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101091 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101092 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101094 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101095 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101096 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101097 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:09:10 testOneCandidateOneRoundElection PASS
2022/04/14 02:09:14 testOneCandidateStartTwoElection PASS
2022/04/14 02:09:19 testTwoCandidateForElection PASS
2022/04/14 02:09:24 testSplitVote PASS
2022/04/14 02:09:27 testAllForElection PASS
2022/04/14 02:09:31 testLeaderRevertToFollower PASS
2022/04/14 02:09:36 testOneSimplePut PASS
2022/04/14 02:09:42 testOneSimpleUpdate PASS
2022/04/14 02:09:49 testOneSimpleDelete PASS
2022/04/14 02:09:56 testDeleteNonExistKey PASS

36
2022-04-14 02:10:01
All real ports: 17923 18567 18941 11968 16805
All proxy ports: 15194 15977 10272 12118 13261
node 3 Proxy started
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:10:03 Start listening to port: 11968
2022/04/14 02:10:03 Start listening to port: 17923
2022/04/14 02:10:03 Start listening to port: 18941
2022/04/14 02:10:03 Start listening to port: 16805
2022/04/14 02:10:03 Start listening to port: 18567
2022/04/14 02:10:03 Successfully connect all nodes
2022/04/14 02:10:03 Successfully connect all nodes
2022/04/14 02:10:03 Successfully connect all nodes
2022/04/14 02:10:03 Successfully connect all nodes
2022/04/14 02:10:03 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 4: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101997 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101998 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 101999 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102000 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102001 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102003 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102004 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102005 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102006 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:10:06 Start listening to port: 17923
node 4 Proxy started
2022/04/14 02:10:06 Start listening to port: 11968
2022/04/14 02:10:06 Start listening to port: 16805
node 0 Proxy started
2022/04/14 02:10:06 Start listening to port: 18567
2022/04/14 02:10:06 Successfully connect all nodes
2022/04/14 02:10:06 Start listening to port: 18941
2022/04/14 02:10:06 Successfully connect all nodes
2022/04/14 02:10:06 Successfully connect all nodes
2022/04/14 02:10:06 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 02:10:06 Successfully connect all nodes
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102079 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102080 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102081 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102082 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102083 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102085 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102086 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102087 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102088 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:10:10 Start listening to port: 17923
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:10:10 Start listening to port: 18567
2022/04/14 02:10:10 Start listening to port: 16805
2022/04/14 02:10:10 Start listening to port: 18941
2022/04/14 02:10:10 Start listening to port: 11968
2022/04/14 02:10:10 Successfully connect all nodes
2022/04/14 02:10:10 Successfully connect all nodes
2022/04/14 02:10:10 Successfully connect all nodes
2022/04/14 02:10:10 Successfully connect all nodes
2022/04/14 02:10:10 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102161 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102162 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102163 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102164 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102165 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102168 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102169 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102170 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:10:15 Start listening to port: 18567
2022/04/14 02:10:15 Start listening to port: 17923
node 1 Proxy started
2022/04/14 02:10:15 Start listening to port: 18941
2022/04/14 02:10:15 Start listening to port: 11968
2022/04/14 02:10:15 Start listening to port: 16805
2022/04/14 02:10:15 Successfully connect all nodes
2022/04/14 02:10:15 Successfully connect all nodes
2022/04/14 02:10:15 Successfully connect all nodes
2022/04/14 02:10:15 Successfully connect all nodes
2022/04/14 02:10:15 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 0 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102248 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102249 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102250 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102251 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102252 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102254 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102256 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102257 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 02:10:20 Start listening to port: 18567
2022/04/14 02:10:20 Start listening to port: 17923
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:10:20 Start listening to port: 16805
2022/04/14 02:10:20 Start listening to port: 18941
2022/04/14 02:10:20 Start listening to port: 11968
2022/04/14 02:10:20 Successfully connect all nodes
2022/04/14 02:10:20 Successfully connect all nodes
2022/04/14 02:10:20 Successfully connect all nodes
2022/04/14 02:10:20 Successfully connect all nodes
2022/04/14 02:10:20 Successfully connect all nodes
Running testAllForElection:
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: reject, term: 1
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 2 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 3: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 3 -> 1: reject, term: 1
node 3 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 0 -> 4: reject, term: 1
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 4: granted, term: 2
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102330 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102331 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102332 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102333 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102334 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102336 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102337 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102338 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102339 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 02:10:24 Start listening to port: 17923
2022/04/14 02:10:24 Start listening to port: 18567
node 3 Proxy started
2022/04/14 02:10:24 Start listening to port: 11968
node 4 Proxy started
2022/04/14 02:10:24 Start listening to port: 18941
2022/04/14 02:10:24 Start listening to port: 16805
2022/04/14 02:10:24 Successfully connect all nodes
2022/04/14 02:10:24 Successfully connect all nodes
2022/04/14 02:10:24 Successfully connect all nodes
2022/04/14 02:10:24 Successfully connect all nodes
2022/04/14 02:10:24 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102429 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102430 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102431 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102432 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102433 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102435 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102436 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102437 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102438 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:10:27 Start listening to port: 18567
2022/04/14 02:10:27 Start listening to port: 18941
node 4 Proxy started
2022/04/14 02:10:27 Start listening to port: 11968
2022/04/14 02:10:27 Start listening to port: 17923
2022/04/14 02:10:27 Start listening to port: 16805
2022/04/14 02:10:27 Successfully connect all nodes
2022/04/14 02:10:27 Successfully connect all nodes
2022/04/14 02:10:27 Successfully connect all nodes
2022/04/14 02:10:27 Successfully connect all nodes
2022/04/14 02:10:27 Successfully connect all nodes
Running testOneSimplePut:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:10:31 Receive propose from client
2022/04/14 02:10:31 Receive propose from client
2022/04/14 02:10:31 Receive propose from client
2022/04/14 02:10:31 Receive propose from client
2022/04/14 02:10:31 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,317654741>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,317654741>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,317654741>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,317654741>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
node 3 -> 0: success, term: 1, matchIdx: 1
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:317654741 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:1], nextIndex :map[1:2 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102517 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102518 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102519 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102520 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102521 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102524 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102526 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 1 Proxy started
node 0 Proxy started
2022/04/14 02:10:32 Start listening to port: 17923
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:10:32 Start listening to port: 18567
2022/04/14 02:10:32 Start listening to port: 11968
2022/04/14 02:10:32 Start listening to port: 18941
2022/04/14 02:10:32 Start listening to port: 16805
2022/04/14 02:10:32 Successfully connect all nodes
2022/04/14 02:10:32 Successfully connect all nodes
2022/04/14 02:10:32 Successfully connect all nodes
2022/04/14 02:10:32 Successfully connect all nodes
2022/04/14 02:10:32 Successfully connect all nodes
Running testOneSimpleUpdate:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:10:36 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,521269654>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,521269654>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 2 -> 0: success, term: 1, matchIdx: 1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:521269654 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:10:36 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,521269654>,t1:put<test,1934348530>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1934348530>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1934348530>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,521269654>,t1:put<test,1934348530>], leaderCommit: 1
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:2 4:0], nextIndex :map[1:2 2:2 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:521269654  Term:1 Key:"test" Value:1934348530 ], kvStore: map[test:521269654]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:0], nextIndex :map[1:3 2:2 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102613 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102616 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102618 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102619 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102620 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102622 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102623 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102624 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102630 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 0 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:10:38 Start listening to port: 17923
2022/04/14 02:10:38 Start listening to port: 18941
2022/04/14 02:10:38 Start listening to port: 11968
2022/04/14 02:10:38 Start listening to port: 18567
2022/04/14 02:10:38 Start listening to port: 16805
2022/04/14 02:10:38 Successfully connect all nodes
2022/04/14 02:10:38 Successfully connect all nodes
2022/04/14 02:10:38 Successfully connect all nodes
2022/04/14 02:10:38 Successfully connect all nodes
2022/04/14 02:10:38 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: node 4 -> 0: granted, term: 1
0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:10:42 Receive propose from client
node 3: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,618074282>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:10:43 Receive propose from client
node 2: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,618074282>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:618074282  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,618074282>,t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,618074282>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:618074282  Term:1 Op:Delete Key:"test" ], kvStore: map[test:618074282]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102716 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102717 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102718 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102719 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102720 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102722 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102723 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102724 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102725 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:10:45 Start listening to port: 17923
node 4 Proxy started
2022/04/14 02:10:45 Start listening to port: 16805
2022/04/14 02:10:45 Start listening to port: 18567
2022/04/14 02:10:45 Start listening to port: 11968
node 1 Proxy started
2022/04/14 02:10:45 Start listening to port: 18941
node 2 Proxy started
2022/04/14 02:10:45 Successfully connect all nodes
2022/04/14 02:10:45 Successfully connect all nodes
2022/04/14 02:10:45 Successfully connect all nodes
Running testDeleteNonExistKey:
2022/04/14 02:10:46 Successfully connect all nodes
2022/04/14 02:10:46 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:10:49 Receive propose from client
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:10:50 Receive propose from client
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>,t1:del<test2,0>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1521004322>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1521004322  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1521004322  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1521004322]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102803 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102804 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102805 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102806 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102807 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102809 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102810 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102811 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 102812 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:10:06 testOneCandidateOneRoundElection PASS
2022/04/14 02:10:10 testOneCandidateStartTwoElection PASS
2022/04/14 02:10:15 testTwoCandidateForElection PASS
2022/04/14 02:10:20 testSplitVote PASS
2022/04/14 02:10:24 testAllForElection PASS
2022/04/14 02:10:27 testLeaderRevertToFollower PASS
2022/04/14 02:10:32 testOneSimplePut PASS
2022/04/14 02:10:38 testOneSimpleUpdate PASS
2022/04/14 02:10:45 testOneSimpleDelete PASS
2022/04/14 02:10:52 testDeleteNonExistKey PASS

37
2022-04-14 02:10:57
All real ports: 18385 15779 18090 14095 10311
All proxy ports: 10628 14780 11194 15744 13882
2022/04/14 02:11:00 Start listening to port: 15779
2022/04/14 02:11:00 Start listening to port: 14095
2022/04/14 02:11:00 Start listening to port: 18385
2022/04/14 02:11:00 Start listening to port: 18090
2022/04/14 02:11:00 Start listening to port: 10311
node 4 Proxy started
node 1 Proxy started
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
Running testOneCandidateOneRoundElection:
2022/04/14 02:11:01 Successfully connect all nodes
2022/04/14 02:11:01 Successfully connect all nodes
2022/04/14 02:11:01 Successfully connect all nodes
2022/04/14 02:11:01 Successfully connect all nodes
2022/04/14 02:11:01 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 4: dropped RequestVoteResponse to 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 1 -> 0: granted, term: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103751 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103753 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103755 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103757 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103758 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103759 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103760 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:11:03 Start listening to port: 15779
node 4 Proxy started
node 0 Proxy started
2022/04/14 02:11:03 Start listening to port: 10311
2022/04/14 02:11:03 Start listening to port: 18090
2022/04/14 02:11:03 Start listening to port: 14095
2022/04/14 02:11:03 Start listening to port: 18385
2022/04/14 02:11:03 Successfully connect all nodes
2022/04/14 02:11:03 Successfully connect all nodes
2022/04/14 02:11:03 Successfully connect all nodes
2022/04/14 02:11:03 Successfully connect all nodes
2022/04/14 02:11:03 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 1 <- 0: RequestVote -- term: 3, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 3, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 3, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 3, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 3
node 3 -> 0: granted, term: 3
node 4 -> 0: granted, term: 3
node 2 -> 0: granted, term: 3
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
02:11:08.565130 rafttest.go:262: FAIL: error on testOneCandidateStartTwoElection - 
Expected:
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 2
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
But get:
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 2
node 3 <- 0: RequestVote -- term: 3, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 3
testOneCandidateStartTwoElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103841 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103842 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103843 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103844 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103845 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103847 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103848 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103849 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103850 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
2022/04/14 02:11:08 Start listening to port: 18385
2022/04/14 02:11:08 Start listening to port: 15779
2022/04/14 02:11:08 Start listening to port: 18090
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:11:08 Start listening to port: 14095
2022/04/14 02:11:08 Start listening to port: 10311
2022/04/14 02:11:08 Successfully connect all nodes
2022/04/14 02:11:08 Successfully connect all nodes
2022/04/14 02:11:08 Successfully connect all nodes
2022/04/14 02:11:08 Successfully connect all nodes
2022/04/14 02:11:08 Successfully connect all nodes
Running testTwoCandidateForElection:
node 2: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 1 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103932 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103933 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103934 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103935 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103936 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103938 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103939 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103940 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 103942 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:11:13 Start listening to port: 18385
2022/04/14 02:11:13 Start listening to port: 18090
2022/04/14 02:11:13 Start listening to port: 15779
2022/04/14 02:11:13 Start listening to port: 14095
2022/04/14 02:11:13 Start listening to port: 10311
2022/04/14 02:11:13 Successfully connect all nodes
2022/04/14 02:11:13 Successfully connect all nodes
2022/04/14 02:11:13 Successfully connect all nodes
2022/04/14 02:11:13 Successfully connect all nodes
2022/04/14 02:11:13 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 3: granted, term: 2
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: granted, term: 2
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 2 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104026 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104027 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104028 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104029 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104032 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104033 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
2022/04/14 02:11:18 Start listening to port: 15779
node 4 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:11:18 Start listening to port: 18090
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:11:18 Start listening to port: 18385
2022/04/14 02:11:18 Successfully connect all nodes
2022/04/14 02:11:18 Start listening to port: 14095
2022/04/14 02:11:18 Successfully connect all nodes
2022/04/14 02:11:18 Start listening to port: 10311
2022/04/14 02:11:18 Successfully connect all nodes
Running testAllForElection:
2022/04/14 02:11:19 Successfully connect all nodes
2022/04/14 02:11:19 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 1
node 0 -> 1: reject, term: 1
node 0 -> 2: reject, term: 1
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 1 -> 0: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
node 3 -> 4: reject, term: 1
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 2 -> 4: reject, term: 1
node 2 -> 1: reject, term: 1
node 2 -> 0: reject, term: 1
node 1 -> 4: reject, term: 1
node 1 -> 2: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
node 0 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 4: granted, term: 2
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104108 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104109 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104110 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104111 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104112 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104114 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104115 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104116 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104117 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:11:22 Start listening to port: 15779
node 4 Proxy started
2022/04/14 02:11:22 Start listening to port: 18385
2022/04/14 02:11:22 Start listening to port: 18090
2022/04/14 02:11:22 Start listening to port: 10311
2022/04/14 02:11:22 Start listening to port: 14095
2022/04/14 02:11:22 Successfully connect all nodes
2022/04/14 02:11:22 Successfully connect all nodes
2022/04/14 02:11:22 Successfully connect all nodes
2022/04/14 02:11:22 Successfully connect all nodes
2022/04/14 02:11:22 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0node 4 -> 0: granted, term: 1

初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104219 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104220 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104221 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104222 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:11:25 Start listening to port: 14095
node 4 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:11:25 Start listening to port: 15779
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:11:25 Start listening to port: 18385
2022/04/14 02:11:25 Start listening to port: 10311
2022/04/14 02:11:25 Successfully connect all nodes
2022/04/14 02:11:25 Successfully connect all nodes
2022/04/14 02:11:25 Start listening to port: 18090
2022/04/14 02:11:25 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 02:11:26 Successfully connect all nodes
2022/04/14 02:11:26 Successfully connect all nodes
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:11:29 Receive propose from client
2022/04/14 02:11:29 Receive propose from client
2022/04/14 02:11:29 Receive propose from client
2022/04/14 02:11:29 Receive propose from client
2022/04/14 02:11:29 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2029340604>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2029340604>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2029340604>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2029340604>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
node 3 -> 0: success, term: 1, matchIdx: 1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2029340604 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:0], nextIndex :map[1:2 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104300 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104301 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104302 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104303 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104304 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104306 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104307 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104308 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104309 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:11:30 Start listening to port: 18385
node 3 Proxy started
2022/04/14 02:11:30 Start listening to port: 15779
2022/04/14 02:11:30 Start listening to port: 14095
2022/04/14 02:11:30 Start listening to port: 18090
2022/04/14 02:11:30 Start listening to port: 10311
node 1 Proxy started
node 4 Proxy started
2022/04/14 02:11:30 Successfully connect all nodes
2022/04/14 02:11:30 Successfully connect all nodes
2022/04/14 02:11:30 Successfully connect all nodes
2022/04/14 02:11:30 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 02:11:31 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:11:34 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1403314806>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1403314806>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1403314806 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:11:34 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1659015054>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1659015054>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1403314806>,t1:put<test,1659015054>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1403314806>,t1:put<test,1659015054>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 4 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1403314806  Term:1 Key:"test" Value:1659015054 ], kvStore: map[test:1403314806]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:0 4:0], nextIndex :map[1:3 2:3 3:1 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104383 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104384 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104385 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104386 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104387 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104389 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104390 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104391 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104392 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:11:36 Start listening to port: 18385
2022/04/14 02:11:36 Start listening to port: 15779
2022/04/14 02:11:36 Start listening to port: 18090
2022/04/14 02:11:36 Start listening to port: 14095
2022/04/14 02:11:36 Start listening to port: 10311
2022/04/14 02:11:36 Successfully connect all nodes
2022/04/14 02:11:36 Successfully connect all nodes
2022/04/14 02:11:36 Successfully connect all nodes
2022/04/14 02:11:36 Successfully connect all nodes
2022/04/14 02:11:36 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:11:40 Receive propose from client
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,748297776>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:11:41 Receive propose from client
node 1: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,748297776>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:748297776  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,748297776>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,748297776>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:748297776  Term:1 Op:Delete Key:"test" ], kvStore: map[test:748297776]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104468 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104469 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104470 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104471 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104472 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104474 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104475 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104476 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104477 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
node 3 Proxy started
node 0 Proxy started
2022/04/14 02:11:44 Start listening to port: 15779
2022/04/14 02:11:44 Start listening to port: 18090
2022/04/14 02:11:44 Start listening to port: 14095
2022/04/14 02:11:44 Start listening to port: 10311
2022/04/14 02:11:44 Start listening to port: 18385
2022/04/14 02:11:44 Successfully connect all nodes
2022/04/14 02:11:44 Successfully connect all nodes
2022/04/14 02:11:44 Successfully connect all nodes
2022/04/14 02:11:44 Successfully connect all nodes
2022/04/14 02:11:44 Successfully connect all nodes
Running testDeleteNonExistKey:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 -> 0: granted, term: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:11:47 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:11:48 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,470774801>,t1:del<test2,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
node 2 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:470774801  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:0], nextIndex :map[1:3 2:1 3:3 4:1] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:470774801  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
node 4 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104553 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104554 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104555 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104556 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104557 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104560 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104561 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 104562 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:11:03 testOneCandidateOneRoundElection PASS
2022/04/14 02:11:08 testOneCandidateStartTwoElection FAIL
2022/04/14 02:11:13 testTwoCandidateForElection PASS
2022/04/14 02:11:18 testSplitVote PASS
2022/04/14 02:11:22 testAllForElection PASS
2022/04/14 02:11:25 testLeaderRevertToFollower PASS
2022/04/14 02:11:30 testOneSimplePut PASS
2022/04/14 02:11:36 testOneSimpleUpdate PASS
2022/04/14 02:11:44 testOneSimpleDelete PASS
2022/04/14 02:11:51 testDeleteNonExistKey PASS

38
2022-04-14 02:11:56
All real ports: 11243 12486 13658 10672 16164
All proxy ports: 19054 17141 19923 15502 12644
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 02:11:58 Start listening to port: 12486
2022/04/14 02:11:58 Start listening to port: 13658
2022/04/14 02:11:58 Start listening to port: 10672
2022/04/14 02:11:58 Start listening to port: 16164
2022/04/14 02:11:58 Start listening to port: 11243
2022/04/14 02:11:58 Successfully connect all nodes
2022/04/14 02:11:58 Successfully connect all nodes
2022/04/14 02:11:58 Successfully connect all nodes
2022/04/14 02:11:58 Successfully connect all nodes
2022/04/14 02:11:58 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105492 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105493 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105494 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105495 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105496 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105499 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105500 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105501 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:12:01 Start listening to port: 11243
2022/04/14 02:12:01 Start listening to port: 12486
node 4 Proxy started
2022/04/14 02:12:01 Start listening to port: 10672
2022/04/14 02:12:01 Start listening to port: 13658
2022/04/14 02:12:01 Start listening to port: 16164
2022/04/14 02:12:01 Successfully connect all nodes
2022/04/14 02:12:01 Successfully connect all nodes
2022/04/14 02:12:01 Successfully connect all nodes
2022/04/14 02:12:01 Successfully connect all nodes
2022/04/14 02:12:01 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105588 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105590 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105591 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105592 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105593 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:12:05 Start listening to port: 11243
2022/04/14 02:12:05 Start listening to port: 12486
node 4 Proxy started
2022/04/14 02:12:05 Start listening to port: 13658
2022/04/14 02:12:05 Start listening to port: 10672
2022/04/14 02:12:05 Start listening to port: 16164
2022/04/14 02:12:05 Successfully connect all nodes
2022/04/14 02:12:05 Successfully connect all nodes
2022/04/14 02:12:05 Successfully connect all nodes
2022/04/14 02:12:05 Successfully connect all nodes
2022/04/14 02:12:05 Successfully connect all nodes
Running testTwoCandidateForElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVote from 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 2: granted, term: 1
node 4 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105680 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105686 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105687 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105688 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105689 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:12:10 Start listening to port: 13658
2022/04/14 02:12:10 Start listening to port: 16164
2022/04/14 02:12:10 Start listening to port: 11243
node 4 Proxy started
2022/04/14 02:12:10 Start listening to port: 10672
node 2 Proxy started
node 3 Proxy started
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:12:10 Start listening to port: 12486
2022/04/14 02:12:10 Successfully connect all nodes
2022/04/14 02:12:10 Successfully connect all nodes
Running testSplitVote:
2022/04/14 02:12:11 Successfully connect all nodes
2022/04/14 02:12:11 Successfully connect all nodes
2022/04/14 02:12:11 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVoteResponse to 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105767 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105768 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105769 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105770 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105771 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105774 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105775 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105776 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:12:15 Start listening to port: 16164
2022/04/14 02:12:15 Start listening to port: 12486
2022/04/14 02:12:15 Start listening to port: 13658
2022/04/14 02:12:15 Start listening to port: 10672
2022/04/14 02:12:15 Start listening to port: 11243
2022/04/14 02:12:15 Successfully connect all nodes
2022/04/14 02:12:15 Successfully connect all nodes
2022/04/14 02:12:15 Successfully connect all nodes
2022/04/14 02:12:15 Successfully connect all nodes
2022/04/14 02:12:15 Successfully connect all nodes
Running testAllForElection:
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 1: reject, term: 1
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 1
node 2 -> 0: reject, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: reject, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 0: reject, term: 1
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 0 -> 3: reject, term: 1
node 3 -> 4: reject, term: 1
node 3 -> 0: reject, term: 1
node 3 -> 1: reject, term: 1
node 4 -> 2: reject, term: 1
node 0 -> 1: reject, term: 1
node 3 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
node 2 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 4: granted, term: 2
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105865 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105866 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105867 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105868 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105869 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105872 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105873 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105874 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:12:19 Start listening to port: 12486
2022/04/14 02:12:19 Start listening to port: 11243
node 4 Proxy started
2022/04/14 02:12:19 Start listening to port: 16164
2022/04/14 02:12:19 Start listening to port: 13658
2022/04/14 02:12:19 Start listening to port: 10672
2022/04/14 02:12:19 Successfully connect all nodes
2022/04/14 02:12:19 Successfully connect all nodes
2022/04/14 02:12:19 Successfully connect all nodes
2022/04/14 02:12:19 Successfully connect all nodes
2022/04/14 02:12:19 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105969 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105970 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105971 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105972 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105973 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105976 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105977 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105978 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 105979 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 0 Proxy started
node 4 Proxy started
2022/04/14 02:12:22 Start listening to port: 13658
2022/04/14 02:12:22 Start listening to port: 11243
2022/04/14 02:12:22 Start listening to port: 10672
2022/04/14 02:12:22 Start listening to port: 12486
2022/04/14 02:12:22 Start listening to port: 16164
2022/04/14 02:12:22 Successfully connect all nodes
2022/04/14 02:12:22 Successfully connect all nodes
2022/04/14 02:12:22 Successfully connect all nodes
2022/04/14 02:12:22 Successfully connect all nodes
2022/04/14 02:12:22 Successfully connect all nodes
Running testOneSimplePut:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:12:26 Receive propose from client
2022/04/14 02:12:26 Receive propose from client
2022/04/14 02:12:26 Receive propose from client
2022/04/14 02:12:26 Receive propose from client
2022/04/14 02:12:26 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2000726947>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2000726947>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2000726947>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,2000726947>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
node 4 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 1 -> 0: success, term: 1, matchIdx: 1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:2000726947 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:0], nextIndex :map[1:1 2:2 3:2 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106056 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106057 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106058 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106059 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106060 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106065 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106066 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106067 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106068 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
2022/04/14 02:12:27 Start listening to port: 11243
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:12:27 Start listening to port: 13658
2022/04/14 02:12:27 Start listening to port: 12486
2022/04/14 02:12:27 Start listening to port: 10672
2022/04/14 02:12:27 Start listening to port: 16164
2022/04/14 02:12:27 Successfully connect all nodes
2022/04/14 02:12:27 Successfully connect all nodes
2022/04/14 02:12:27 Successfully connect all nodes
2022/04/14 02:12:27 Successfully connect all nodes
2022/04/14 02:12:27 Successfully connect all nodes
Running testOneSimpleUpdate:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:12:31 Receive propose from client
node 4: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,263594007>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,263594007>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:263594007 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:12:31 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,212897651>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,263594007>,t1:put<test,212897651>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,212897651>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,263594007>,t1:put<test,212897651>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
node 3 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:2], nextIndex :map[1:2 2:2 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:263594007  Term:1 Key:"test" Value:212897651 ], kvStore: map[test:263594007]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106170 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106171 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106178 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106179 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106180 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106182 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106183 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106186 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106187 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:12:33 Start listening to port: 11243
2022/04/14 02:12:33 Start listening to port: 12486
node 4 Proxy started
node 2 Proxy started
node 0 Proxy started
2022/04/14 02:12:33 Start listening to port: 10672
2022/04/14 02:12:33 Start listening to port: 16164
2022/04/14 02:12:33 Start listening to port: 13658
2022/04/14 02:12:33 Successfully connect all nodes
2022/04/14 02:12:33 Successfully connect all nodes
2022/04/14 02:12:33 Successfully connect all nodes
2022/04/14 02:12:33 Successfully connect all nodes
Running testOneSimpleDelete:
2022/04/14 02:12:34 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:12:37 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950095673>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:12:38 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950095673>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1950095673  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950095673>,t1:del<test,0>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1950095673>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
node 1 -> 0: success, term: 1, matchIdx: 2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1950095673  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1950095673]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:2], nextIndex :map[1:1 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106299 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106300 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106301 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106302 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106304 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106306 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106307 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106308 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106309 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:12:40 Start listening to port: 12486
2022/04/14 02:12:40 Start listening to port: 10672
2022/04/14 02:12:40 Start listening to port: 16164
2022/04/14 02:12:40 Start listening to port: 11243
2022/04/14 02:12:40 Start listening to port: 13658
2022/04/14 02:12:40 Successfully connect all nodes
2022/04/14 02:12:40 Successfully connect all nodes
2022/04/14 02:12:40 Successfully connect all nodes
2022/04/14 02:12:40 Successfully connect all nodes
2022/04/14 02:12:40 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:12:44 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:12:45 Receive propose from client
node 2: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1430962750>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:0], nextIndex :map[1:3 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1430962750  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1430962750  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1430962750]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106393 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106394 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106395 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106396 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106397 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106399 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106401 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 106406 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:12:01 testOneCandidateOneRoundElection PASS
2022/04/14 02:12:05 testOneCandidateStartTwoElection PASS
2022/04/14 02:12:10 testTwoCandidateForElection PASS
2022/04/14 02:12:15 testSplitVote PASS
2022/04/14 02:12:19 testAllForElection PASS
2022/04/14 02:12:22 testLeaderRevertToFollower PASS
2022/04/14 02:12:27 testOneSimplePut PASS
2022/04/14 02:12:33 testOneSimpleUpdate PASS
2022/04/14 02:12:40 testOneSimpleDelete PASS
2022/04/14 02:12:47 testDeleteNonExistKey PASS

39
2022-04-14 02:12:52
All real ports: 19473 11922 10967 17946 14200
All proxy ports: 15821 11338 19180 10049 12320
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:12:55 Start listening to port: 10967
2022/04/14 02:12:55 Start listening to port: 19473
2022/04/14 02:12:55 Start listening to port: 14200
2022/04/14 02:12:55 Start listening to port: 11922
2022/04/14 02:12:55 Start listening to port: 17946
2022/04/14 02:12:55 Successfully connect all nodes
2022/04/14 02:12:55 Successfully connect all nodes
2022/04/14 02:12:55 Successfully connect all nodes
2022/04/14 02:12:55 Successfully connect all nodes
2022/04/14 02:12:55 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107276 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107277 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107278 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107279 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107283 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107284 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107285 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:12:58 Start listening to port: 19473
2022/04/14 02:12:58 Start listening to port: 10967
2022/04/14 02:12:58 Start listening to port: 11922
2022/04/14 02:12:58 Start listening to port: 17946
2022/04/14 02:12:58 Start listening to port: 14200
2022/04/14 02:12:58 Successfully connect all nodes
2022/04/14 02:12:58 Successfully connect all nodes
2022/04/14 02:12:58 Successfully connect all nodes
2022/04/14 02:12:58 Successfully connect all nodes
2022/04/14 02:12:58 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 4 -> 0: granted, term: 2
node 2 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0node 3 -> 0: granted, term: 2

初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107367 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107368 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107369 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107370 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107371 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107373 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107374 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107375 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107376 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:13:02 Start listening to port: 19473
2022/04/14 02:13:02 Start listening to port: 11922
2022/04/14 02:13:02 Start listening to port: 10967
2022/04/14 02:13:02 Start listening to port: 14200
2022/04/14 02:13:02 Start listening to port: 17946
2022/04/14 02:13:02 Successfully connect all nodes
2022/04/14 02:13:02 Successfully connect all nodes
2022/04/14 02:13:02 Successfully connect all nodes
2022/04/14 02:13:02 Successfully connect all nodes
2022/04/14 02:13:02 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 3 -> 2: granted, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 1 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107450 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107451 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107452 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107453 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107454 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107457 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107458 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107459 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:13:07 Start listening to port: 19473
2022/04/14 02:13:07 Start listening to port: 11922
2022/04/14 02:13:07 Start listening to port: 10967
2022/04/14 02:13:07 Start listening to port: 17946
node 3 Proxy started
2022/04/14 02:13:07 Start listening to port: 14200
2022/04/14 02:13:07 Successfully connect all nodes
2022/04/14 02:13:07 Successfully connect all nodes
2022/04/14 02:13:07 Successfully connect all nodes
Running testSplitVote:
2022/04/14 02:13:08 Successfully connect all nodes
2022/04/14 02:13:08 Successfully connect all nodes
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 1 -> 0: granted, term: 1
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
node 2 -> 3: reject, term: 2
node 4 -> 0: reject, term: 2
node 3 -> 0: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107549 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107551 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107552 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107553 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107556 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107558 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
2022/04/14 02:13:12 Start listening to port: 10967
node 1 Proxy started
2022/04/14 02:13:12 Start listening to port: 11922
2022/04/14 02:13:12 Start listening to port: 19473
2022/04/14 02:13:12 Start listening to port: 14200
2022/04/14 02:13:12 Start listening to port: 17946
node 0 Proxy started
node 4 Proxy started
node 3 Proxy started
Running testAllForElection:
2022/04/14 02:13:13 Successfully connect all nodes
2022/04/14 02:13:13 Successfully connect all nodes
2022/04/14 02:13:13 Successfully connect all nodes
2022/04/14 02:13:13 Successfully connect all nodes
2022/04/14 02:13:13 Successfully connect all nodes
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 3 -> 2: reject, term: 1
node 4 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 4 -> 2: reject, term: 1
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 1: reject, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: reject, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 4: granted, term: 2
node 2 -> 0: reject, term: 1
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 2 -> 4: reject, term: 1
node 0 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 0 -> 1: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
1node 1 -> 0: reject, term: 1

node 1 -> 2: reject, term: 1
node 1 -> 4: reject, term: 1
初始化nextIndex[]，其中的每一项为: node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
1node 1 -> 3: reject, term: 1

node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: 1node 1 -> 4: granted, term: 2

初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107632 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107633 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107634 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107638 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107644 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107646 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107647 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107648 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:13:16 Start listening to port: 19473
node 4 Proxy started
2022/04/14 02:13:16 Start listening to port: 17946
2022/04/14 02:13:16 Start listening to port: 14200
2022/04/14 02:13:16 Start listening to port: 10967
2022/04/14 02:13:16 Start listening to port: 11922
2022/04/14 02:13:16 Successfully connect all nodes
2022/04/14 02:13:16 Successfully connect all nodes
2022/04/14 02:13:16 Successfully connect all nodes
2022/04/14 02:13:16 Successfully connect all nodes
2022/04/14 02:13:16 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
初始化nextIndex[]，其中的每一项为: node 1 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2: dropped RequestVote from 4
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107731 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107732 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107733 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107734 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107735 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107737 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107738 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107739 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107740 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:13:19 Start listening to port: 11922
2022/04/14 02:13:19 Start listening to port: 19473
2022/04/14 02:13:19 Start listening to port: 10967
2022/04/14 02:13:19 Start listening to port: 17946
2022/04/14 02:13:19 Start listening to port: 14200
2022/04/14 02:13:19 Successfully connect all nodes
2022/04/14 02:13:19 Successfully connect all nodes
2022/04/14 02:13:19 Successfully connect all nodes
2022/04/14 02:13:19 Successfully connect all nodes
2022/04/14 02:13:19 Successfully connect all nodes
Running testOneSimplePut:
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:13:23 Receive propose from client
2022/04/14 02:13:23 Receive propose from client
2022/04/14 02:13:23 Receive propose from client
2022/04/14 02:13:23 Receive propose from client
2022/04/14 02:13:23 Receive propose from client
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,74489219>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,74489219>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,74489219>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,74489219>], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
node 1 -> 0: success, term: 1, matchIdx: 1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:74489219 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:1], nextIndex :map[1:1 2:2 3:1 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:1 4:1], nextIndex :map[1:1 2:2 3:2 4:2] 
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107816 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107817 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107818 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107819 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107820 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107823 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107824 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107825 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 3 Proxy started
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:13:25 Start listening to port: 19473
2022/04/14 02:13:25 Start listening to port: 11922
node 4 Proxy started
2022/04/14 02:13:25 Start listening to port: 10967
2022/04/14 02:13:25 Start listening to port: 14200
2022/04/14 02:13:25 Start listening to port: 17946
2022/04/14 02:13:25 Successfully connect all nodes
2022/04/14 02:13:25 Successfully connect all nodes
2022/04/14 02:13:25 Successfully connect all nodes
2022/04/14 02:13:25 Successfully connect all nodes
Running testOneSimpleUpdate:
2022/04/14 02:13:26 Successfully connect all nodes
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 3 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:13:28 Receive propose from client
node 3: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1194116097>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1194116097>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
node 2 -> 0: success, term: 1, matchIdx: 1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1194116097 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:13:29 Receive propose from client
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,956053857>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1194116097>,t1:put<test,956053857>], leaderCommit: 1
开始更新自己节点的kvStore
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1194116097>,t1:put<test,956053857>], leaderCommit: 1
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,956053857>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1194116097  Term:1 Key:"test" Value:956053857 ], kvStore: map[test:1194116097]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:2], nextIndex :map[1:3 2:2 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107919 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107920 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107921 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107922 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107923 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107925 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107926 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107929 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 107930 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
2022/04/14 02:13:31 Start listening to port: 19473
node 4 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:13:31 Start listening to port: 10967
2022/04/14 02:13:31 Start listening to port: 11922
2022/04/14 02:13:31 Start listening to port: 14200
2022/04/14 02:13:31 Start listening to port: 17946
2022/04/14 02:13:31 Successfully connect all nodes
2022/04/14 02:13:31 Successfully connect all nodes
2022/04/14 02:13:31 Successfully connect all nodes
2022/04/14 02:13:31 Successfully connect all nodes
2022/04/14 02:13:31 Successfully connect all nodes
Running testOneSimpleDelete:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:13:34 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1117836908>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:13:35 Receive propose from client
node 1: dropped AppendEntries from 0
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1117836908>,t1:del<test,0>], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1117836908  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1117836908>,t1:del<test,0>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1117836908>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1117836908  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1117836908]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108020 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108021 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108022 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108023 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108024 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108027 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108028 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108029 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108030 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 2 Proxy started
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
2022/04/14 02:13:38 Start listening to port: 11922
2022/04/14 02:13:38 Start listening to port: 19473
2022/04/14 02:13:38 Start listening to port: 10967
node 4 Proxy started
2022/04/14 02:13:38 Start listening to port: 14200
2022/04/14 02:13:38 Start listening to port: 17946
2022/04/14 02:13:38 Successfully connect all nodes
2022/04/14 02:13:38 Successfully connect all nodes
2022/04/14 02:13:38 Successfully connect all nodes
2022/04/14 02:13:38 Successfully connect all nodes
2022/04/14 02:13:38 Successfully connect all nodes
Running testDeleteNonExistKey:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1node 3 -> 0: granted, term: 1

初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:13:41 Receive propose from client
node 3: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>], leaderCommit: 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>], leaderCommit: 0
node 4: dropped AppendEntriesResponse to 0
node 1: dropped AppendEntriesResponse to 0
2022/04/14 02:13:42 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>,t1:del<test2,0>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>,t1:del<test2,0>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1487201138>,t1:del<test2,0>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 2 -> 0: success, term: 1, matchIdx: 2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1487201138  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:2 4:2], nextIndex :map[1:1 2:1 3:3 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1487201138  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1487201138]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:2], nextIndex :map[1:1 2:3 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108147 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108148 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108149 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108153 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108156 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108157 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108158 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 108159 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:12:58 testOneCandidateOneRoundElection PASS
2022/04/14 02:13:02 testOneCandidateStartTwoElection PASS
2022/04/14 02:13:07 testTwoCandidateForElection PASS
2022/04/14 02:13:12 testSplitVote PASS
2022/04/14 02:13:16 testAllForElection PASS
2022/04/14 02:13:19 testLeaderRevertToFollower PASS
2022/04/14 02:13:25 testOneSimplePut PASS
2022/04/14 02:13:31 testOneSimpleUpdate PASS
2022/04/14 02:13:38 testOneSimpleDelete PASS
2022/04/14 02:13:45 testDeleteNonExistKey PASS

40
2022-04-14 02:13:50
All real ports: 13903 14461 12685 14313 15749
All proxy ports: 12601 12963 13494 13910 10955
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:13:52 Start listening to port: 14313
2022/04/14 02:13:52 Start listening to port: 12685
2022/04/14 02:13:52 Start listening to port: 13903
2022/04/14 02:13:52 Start listening to port: 15749
2022/04/14 02:13:52 Start listening to port: 14461
2022/04/14 02:13:52 Successfully connect all nodes
2022/04/14 02:13:52 Successfully connect all nodes
2022/04/14 02:13:52 Successfully connect all nodes
2022/04/14 02:13:52 Successfully connect all nodes
2022/04/14 02:13:52 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 2 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3: dropped RequestVoteResponse to 0
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
testOneCandidateOneRoundElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109038 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109039 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109040 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109041 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109046 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 2 Proxy started
2022/04/14 02:13:55 Start listening to port: 13903
node 4 Proxy started
2022/04/14 02:13:55 Start listening to port: 12685
2022/04/14 02:13:55 Start listening to port: 14461
2022/04/14 02:13:55 Start listening to port: 15749
2022/04/14 02:13:55 Start listening to port: 14313
2022/04/14 02:13:55 Successfully connect all nodes
2022/04/14 02:13:55 Successfully connect all nodes
2022/04/14 02:13:55 Successfully connect all nodes
2022/04/14 02:13:55 Successfully connect all nodes
2022/04/14 02:13:55 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 -> 0: granted, term: 2
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 2 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 4 -> 0: success, term: 2, matchIdx: 0
testOneCandidateStartTwoElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109114 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109115 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109116 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109117 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109118 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109122 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109124 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
node 1 Proxy started
2022/04/14 02:13:59 Start listening to port: 14461
2022/04/14 02:13:59 Start listening to port: 12685
2022/04/14 02:13:59 Start listening to port: 14313
2022/04/14 02:13:59 Start listening to port: 15749
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:13:59 Start listening to port: 13903
2022/04/14 02:13:59 Successfully connect all nodes
2022/04/14 02:13:59 Successfully connect all nodes
2022/04/14 02:13:59 Successfully connect all nodes
2022/04/14 02:13:59 Successfully connect all nodes
Running testTwoCandidateForElection:
2022/04/14 02:14:00 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 0 -> 2: reject, term: 1
node 4 -> 2: granted, term: 1
node 3 -> 2: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
node 4 -> 2: success, term: 1, matchIdx: 0
node 0 -> 2: success, term: 1, matchIdx: 0
node 3 -> 2: success, term: 1, matchIdx: 0
testTwoCandidateForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109196 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109197 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109198 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109199 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109200 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109204 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109205 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:14:04 Start listening to port: 13903
node 1 Proxy started
node 4 Proxy started
node 3 Proxy started
2022/04/14 02:14:04 Start listening to port: 12685
2022/04/14 02:14:04 Start listening to port: 14461
2022/04/14 02:14:04 Start listening to port: 15749
2022/04/14 02:14:04 Successfully connect all nodes
2022/04/14 02:14:04 Successfully connect all nodes
2022/04/14 02:14:04 Successfully connect all nodes
2022/04/14 02:14:04 Start listening to port: 14313
2022/04/14 02:14:04 Successfully connect all nodes
2022/04/14 02:14:04 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 2: dropped RequestVoteResponse to 0
node 4 -> 3: granted, term: 1
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: granted, term: 2
node 2 -> 3: granted, term: 2
node 4 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: granted, term: 2
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 2 -> 3: success, term: 2, matchIdx: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 3: reject, term: 2
node 3 -> 0: reject, term: 2
node 4 -> 0: reject, term: 2
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 1 -> 3: reject, term: 2
testSplitVote PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109277 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109278 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109279 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109280 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109281 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109283 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109284 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109285 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109286 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
2022/04/14 02:14:09 Start listening to port: 13903
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:14:09 Start listening to port: 14461
node 4 Proxy started
2022/04/14 02:14:09 Start listening to port: 15749
2022/04/14 02:14:09 Start listening to port: 14313
2022/04/14 02:14:09 Start listening to port: 12685
2022/04/14 02:14:09 Successfully connect all nodes
2022/04/14 02:14:09 Successfully connect all nodes
2022/04/14 02:14:09 Successfully connect all nodes
2022/04/14 02:14:09 Successfully connect all nodes
2022/04/14 02:14:09 Successfully connect all nodes
Running testAllForElection:
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 1: reject, term: 1
node 0 -> 3: reject, term: 1
node 0 -> 2: reject, term: 1
node 0 -> 4: reject, term: 1
node 2 -> 0: reject, term: 1
node 2 -> 3: reject, term: 1
node 2 -> 1: reject, term: 1
node 3 -> 2: reject, term: 1
node 4 <- 1: RequestVote -- term: 1, candidateId: 1, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 1: reject, term: 1
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 1
node 3 -> 4: reject, term: 1
node 2 -> 4: reject, term: 1
node 4 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: reject, term: 1
node 1 -> 2: reject, term: 1
node 1 -> 3: reject, term: 1
node 1 -> 4: reject, term: 1
node 4 -> 0: reject, term: 1
node 4 -> 1: reject, term: 1
node 4 -> 3: reject, term: 1
node 4 -> 2: reject, term: 1
node 2 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 4: granted, term: 2
node 3 -> 4: granted, term: 2
node 0 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 3 -> 4: success, term: 2, matchIdx: 0
testAllForElection PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109361 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109362 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109363 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109364 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109365 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109367 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109368 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109369 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109370 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:14:13 Start listening to port: 13903
2022/04/14 02:14:13 Start listening to port: 12685
2022/04/14 02:14:13 Start listening to port: 15749
2022/04/14 02:14:13 Start listening to port: 14461
2022/04/14 02:14:13 Start listening to port: 14313
2022/04/14 02:14:13 Successfully connect all nodes
2022/04/14 02:14:13 Successfully connect all nodes
2022/04/14 02:14:13 Successfully connect all nodes
2022/04/14 02:14:13 Successfully connect all nodes
2022/04/14 02:14:13 Successfully connect all nodes
Running testLeaderRevertToFollower:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 3 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 0: dropped RequestVote from 4
node 1 <- 4: RequestVote -- term: 2, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 2: dropped RequestVote from 4
node 3 -> 4: granted, term: 2
node 1 -> 4: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 <- 4: AppendEntries -- term: 2, leaderId: 4, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 4: success, term: 2, matchIdx: 0
node 1 -> 4: success, term: 2, matchIdx: 0
node 2 -> 4: success, term: 2, matchIdx: 0
node 0 -> 4: success, term: 2, matchIdx: 0
testLeaderRevertToFollower PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109456 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109457 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109458 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109459 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109460 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109462 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109463 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109464 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109465 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:14:16 Start listening to port: 13903
node 0 Proxy started
2022/04/14 02:14:16 Start listening to port: 14313
2022/04/14 02:14:16 Start listening to port: 14461
node 3 Proxy started
2022/04/14 02:14:16 Start listening to port: 12685
node 1 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:14:16 Start listening to port: 15749
2022/04/14 02:14:16 Successfully connect all nodes
Running testOneSimplePut:
2022/04/14 02:14:17 Successfully connect all nodes
2022/04/14 02:14:17 Successfully connect all nodes
2022/04/14 02:14:17 Successfully connect all nodes
2022/04/14 02:14:17 Successfully connect all nodes
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: node 4 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:14:21 Receive propose from client
2022/04/14 02:14:21 Receive propose from client
2022/04/14 02:14:21 Receive propose from client
2022/04/14 02:14:21 Receive propose from client
2022/04/14 02:14:21 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,796422182>], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,796422182>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,796422182>], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,796422182>], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:1], nextIndex :map[1:1 2:1 3:1 4:2] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:796422182 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： node 3 -> 0: success, term: 1, matchIdx: 1
2
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:1 4:1], nextIndex :map[1:2 2:1 3:2 4:2] 
1
响应成功。更新之后：rn.nextIndex[hostId]： 2
响应成功。更新之后：rn.matchIndex[hostId]： AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:1 4:1], nextIndex :map[1:2 2:2 3:2 4:2] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 1
node 1 -> 0: success, term: 1, matchIdx: 1
node 3 -> 0: success, term: 1, matchIdx: 1
node 4 -> 0: success, term: 1, matchIdx: 1
testOneSimplePut PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109542 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109543 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109544 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109545 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109546 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109548 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109549 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109550 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109551 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 2 Proxy started
node 3 Proxy started
2022/04/14 02:14:22 Start listening to port: 13903
node 4 Proxy started
2022/04/14 02:14:22 Start listening to port: 14313
2022/04/14 02:14:22 Start listening to port: 12685
2022/04/14 02:14:22 Start listening to port: 14461
2022/04/14 02:14:22 Start listening to port: 15749
2022/04/14 02:14:22 Successfully connect all nodes
2022/04/14 02:14:22 Successfully connect all nodes
2022/04/14 02:14:22 Successfully connect all nodes
2022/04/14 02:14:22 Successfully connect all nodes
2022/04/14 02:14:22 Successfully connect all nodes
Running testOneSimpleUpdate:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 2 -> 0: granted, term: 1
1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:14:26 Receive propose from client
node 4: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1058353177>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1058353177>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 1
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:0 3:0 4:0], nextIndex :map[1:2 2:1 3:1 4:1] 
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1058353177 ], kvStore: map[]  
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:1 2:1 3:0 4:0], nextIndex :map[1:2 2:2 3:1 4:1] 
2022/04/14 02:14:26 Receive propose from client
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1296514538>], leaderCommit: 1
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:put<test,1296514538>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1058353177>,t1:put<test,1296514538>], leaderCommit: 1
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1058353177>,t1:put<test,1296514538>], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
当前的commitNum是:2
当前leder的commit次数是:0
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:0], nextIndex :map[1:3 2:2 3:1 4:1] 
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1058353177  Term:1 Key:"test" Value:1296514538 ], kvStore: map[test:1058353177]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:0 4:2], nextIndex :map[1:3 2:2 3:1 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:1 3:2 4:2], nextIndex :map[1:3 2:2 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 4 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 3 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
testOneSimpleUpdate PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109623 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109624 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109625 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109626 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109627 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109629 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109630 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109631 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109632 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 3 Proxy started
node 4 Proxy started
node 2 Proxy started
2022/04/14 02:14:28 Start listening to port: 13903
2022/04/14 02:14:28 Start listening to port: 14313
2022/04/14 02:14:28 Start listening to port: 15749
2022/04/14 02:14:28 Start listening to port: 12685
2022/04/14 02:14:28 Start listening to port: 14461
2022/04/14 02:14:28 Successfully connect all nodes
2022/04/14 02:14:28 Successfully connect all nodes
2022/04/14 02:14:28 Successfully connect all nodes
2022/04/14 02:14:28 Successfully connect all nodes
2022/04/14 02:14:28 Successfully connect all nodes
Running testOneSimpleDelete:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 1
node 1 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 3 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:14:32 Receive propose from client
node 4: dropped AppendEntries from 0
node 1: dropped AppendEntries from 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1064350441>], leaderCommit: 0
node 3: dropped AppendEntries from 0
node 2 -> 0: success, term: 1, matchIdx: 1
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 1
响应成功。更新之后：rn.nextIndex[hostId]： 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:0 4:0], nextIndex :map[1:1 2:2 3:1 4:1] 
2022/04/14 02:14:33 Receive propose from client
node 4: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1064350441>,t1:del<test,0>], leaderCommit: 0
node 1: dropped AppendEntries from 0
node 3 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1064350441  Term:1 Op:Delete Key:"test" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:1 3:2 4:0], nextIndex :map[1:1 2:2 3:3 4:1] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 1, prevLogTerm: 1, entries: [t1:del<test,0>], leaderCommit: 1
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1064350441>,t1:del<test,0>], leaderCommit: 1
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1064350441>,t1:del<test,0>], leaderCommit: 1
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 1
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
当前的commitNum是:2
当前leder的commit次数是:0
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:1
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1064350441  Term:1 Op:Delete Key:"test" ], kvStore: map[test:1064350441]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:2 3:2 4:0], nextIndex :map[1:1 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:0], nextIndex :map[1:3 2:3 3:3 4:1] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 2 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testOneSimpleDelete PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109712 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109713 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109714 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109715 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109716 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109719 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109720 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109721 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 3 Proxy started
node 1 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:14:35 Start listening to port: 12685
2022/04/14 02:14:35 Start listening to port: 13903
2022/04/14 02:14:35 Start listening to port: 14461
2022/04/14 02:14:35 Start listening to port: 15749
2022/04/14 02:14:35 Start listening to port: 14313
2022/04/14 02:14:35 Successfully connect all nodes
2022/04/14 02:14:35 Successfully connect all nodes
2022/04/14 02:14:35 Successfully connect all nodes
2022/04/14 02:14:35 Successfully connect all nodes
2022/04/14 02:14:35 Successfully connect all nodes
Running testDeleteNonExistKey:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 0: granted, term: 1
node 3 -> 0: granted, term: 1
node 2 -> 0: granted, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 3 -> 0: success, term: 1, matchIdx: 0
node 1 -> 0: success, term: 1, matchIdx: 0
node 4 -> 0: success, term: 1, matchIdx: 0
node 2 -> 0: success, term: 1, matchIdx: 0
2022/04/14 02:14:39 Receive propose from client
node 3: dropped AppendEntries from 0
node 2: dropped AppendEntries from 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 4: dropped AppendEntriesResponse to 0
2022/04/14 02:14:40 Receive propose from client
node 2: dropped AppendEntries from 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>,t1:del<test2,0>], leaderCommit: 0
node 4: dropped AppendEntries from 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>,t1:del<test2,0>], leaderCommit: 0
node 1: dropped AppendEntriesResponse to 0
node 3: dropped AppendEntriesResponse to 0
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>,t1:del<test2,0>], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>,t1:del<test2,0>], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>,t1:del<test2,0>], leaderCommit: 0
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [t1:put<test,1479416066>,t1:del<test2,0>], leaderCommit: 0
当前的commitNum是:1
当前leder的commit次数是:0
响应成功。更新之后：rn.matchIndex[hostId]： 当前的commitNum是:2
2当前leder的commit次数是:0

node 2 -> 0: success, term: 1, matchIdx: 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为0，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 1
当前leader的commit次数是:1
node 3 -> 0: success, term: 1, matchIdx: 2
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:0 2:0 3:0 4:2], nextIndex :map[1:1 2:1 3:1 4:3] 
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 1, LogEntries : [ Term:1 Key:"test" Value:1479416066  Term:1 Op:Delete Key:"test2" ], kvStore: map[]  
当前的commitNum是:1
当前leder的commit次数是:1
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:0 4:2], nextIndex :map[1:3 2:1 3:1 4:3] 
当前的commitNum是:2
当前leder的commit次数是:1
超过一半的节点已经收到了日志，那么leader可以开始commit日志，提交次数为1，进行一次提交
commit日志之后，当前的leader的rn.commitIndex为:
 2
当前leader的commit次数是:2
[Leader commit 自己的日志之后] nodeId : 0, leader的commitIndex : 2, LogEntries : [ Term:1 Key:"test" Value:1479416066  Term:1 Op:Delete Key:"test2" ], kvStore: map[test:1479416066]  
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:0 3:2 4:2], nextIndex :map[1:3 2:1 3:3 4:3] 
响应成功。更新之后：rn.matchIndex[hostId]： 2
响应成功。更新之后：rn.nextIndex[hostId]： 3
AppendEntries返回成功，开始更新leader的matchIndex数组和nextIndex数组,matchIndex: map[1:2 2:2 3:2 4:2], nextIndex :map[1:3 2:3 3:3 4:3] 
node 2 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
node 1 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
开始更新自己节点的kvStore
node 3 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 2, prevLogTerm: 1, entries: [], leaderCommit: 2
开始更新自己节点的kvStore
node 2 -> 0: success, term: 1, matchIdx: 2
开始更新自己节点的kvStore
node 1 -> 0: success, term: 1, matchIdx: 2
node 4 -> 0: success, term: 1, matchIdx: 2
node 3 -> 0: success, term: 1, matchIdx: 2
testDeleteNonExistKey PASS
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109965 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109966 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109967 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109968 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109969 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109971 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109972 Killed                  ${RAFT_NODE} ${NODE_PORT2} ${ALL_PROXY_PORTS} 2 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109973 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 109974 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
2022/04/14 02:13:55 testOneCandidateOneRoundElection PASS
2022/04/14 02:13:59 testOneCandidateStartTwoElection PASS
2022/04/14 02:14:04 testTwoCandidateForElection PASS
2022/04/14 02:14:09 testSplitVote PASS
2022/04/14 02:14:13 testAllForElection PASS
2022/04/14 02:14:16 testLeaderRevertToFollower PASS
2022/04/14 02:14:22 testOneSimplePut PASS
2022/04/14 02:14:28 testOneSimpleUpdate PASS
2022/04/14 02:14:35 testOneSimpleDelete PASS
2022/04/14 02:14:42 testDeleteNonExistKey PASS

41
2022-04-14 02:14:47
All real ports: 14764 19913 11918 19777 14611
All proxy ports: 19149 10191 18938 12250 12243
node 4 Proxy started
node 0 Proxy started
node 2 Proxy started
node 3 Proxy started
node 1 Proxy started
2022/04/14 02:14:50 Start listening to port: 19777
2022/04/14 02:14:50 Start listening to port: 14764
2022/04/14 02:14:50 Start listening to port: 19913
2022/04/14 02:14:50 Fail to listen port listen tcp 127.0.0.1:11918: bind: address already in use
2022/04/14 02:14:50 Start listening to port: 14611
2022/04/14 02:14:50 Successfully connect all nodes
2022/04/14 02:14:50 Successfully connect all nodes
2022/04/14 02:14:50 Successfully connect all nodes
2022/04/14 02:14:50 Successfully connect all nodes
Running testOneCandidateOneRoundElection:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4: dropped RequestVoteResponse to 0
node 3: dropped RequestVoteResponse to 0
node 0 -> 0: reject, term: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 2
node 4 -> 0: granted, term: 2
node 0 -> 0: reject, term: 0
node 1 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
02:14:54.296565 rafttest.go:262: FAIL: error on testOneCandidateOneRoundElection - 
Expected:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: AppendEntries -- term: 1, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 1, matchIdx: 0
But get:
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: granted, term: 2
testOneCandidateOneRoundElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110905 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110906 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110907 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110908 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110909 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110911 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110913 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110914 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
2022/04/14 02:14:54 Start listening to port: 14764
node 4 Proxy started
2022/04/14 02:14:54 Fail to listen port listen tcp 127.0.0.1:11918: bind: address already in use
node 0 Proxy started
node 3 Proxy started
2022/04/14 02:14:54 Start listening to port: 19777
2022/04/14 02:14:54 Start listening to port: 14611
node 2 Proxy started
2022/04/14 02:14:54 Start listening to port: 19913
2022/04/14 02:14:54 Successfully connect all nodes
2022/04/14 02:14:54 Successfully connect all nodes
2022/04/14 02:14:54 Successfully connect all nodes
Running testOneCandidateStartTwoElection:
2022/04/14 02:14:55 Successfully connect all nodes
node 2: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3: dropped RequestVote from 0
node 4: dropped RequestVote from 0
node 1 -> 0: granted, term: 1
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1: dropped RequestVoteResponse to 0
node 0 -> 0: reject, term: 0
node 4 -> 0: granted, term: 2
node 3 -> 0: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 3 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 -> 0: success, term: 2, matchIdx: 0
node 3 -> 0: success, term: 2, matchIdx: 0
node 1 -> 0: success, term: 2, matchIdx: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
02:14:58.526288 rafttest.go:262: FAIL: error on testOneCandidateStartTwoElection - 
Expected:
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 0: granted, term: 2
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 0: success, term: 2, matchIdx: 0
But get:
node 2 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 2 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
testOneCandidateStartTwoElection FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110988 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110990 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110991 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110993 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110995 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 110996 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 1 Proxy started
node 0 Proxy started
node 2 Proxy started
node 4 Proxy started
2022/04/14 02:14:58 Start listening to port: 14764
node 3 Proxy started
2022/04/14 02:14:58 Fail to listen port listen tcp 127.0.0.1:11918: bind: address already in use
2022/04/14 02:14:58 Start listening to port: 19777
2022/04/14 02:14:58 Start listening to port: 14611
2022/04/14 02:14:58 Start listening to port: 19913
2022/04/14 02:14:58 Successfully connect all nodes
2022/04/14 02:14:58 Successfully connect all nodes
2022/04/14 02:14:58 Successfully connect all nodes
2022/04/14 02:14:58 Successfully connect all nodes
Running testTwoCandidateForElection:
node 4: dropped RequestVote from 0
node 2: dropped RequestVote from 0
node 3: dropped RequestVote from 0
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 0 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 4: reject, term: 2
node 1 -> 4: reject, term: 1
node 4 -> 0: granted, term: 2
node 1 -> 0: granted, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: granted, term: 2
node 3 -> 4: reject, term: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 -> 3: reject, term: 2
02:15:04.563163 rafttest.go:262: FAIL: error on testTwoCandidateForElection - 
Expected:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 2: RequestVote -- term: 1, candidateId: 2, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 2: reject, term: 1
node 1 <- 2: AppendEntries -- term: 1, leaderId: 2, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 -> 2: success, term: 1, matchIdx: 0
But get:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 1 <- 4: RequestVote -- term: 1, candidateId: 4, lastLogIdx: 0, lastLogTerm: 0
node 1 <- 0: RequestVote -- term: 2, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 4: reject, term: 1
node 1 -> 0: granted, term: 2
testTwoCandidateForElection FAIL
node 4 <- 0: AppendEntries -- term: 2, leaderId: 0, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111068 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111069 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111070 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111071 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111073 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111075 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111077 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111078 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 1 Proxy started
node 3 Proxy started
node 2 Proxy started
2022/04/14 02:15:04 Start listening to port: 19913
2022/04/14 02:15:04 Start listening to port: 14764
node 4 Proxy started
2022/04/14 02:15:04 Fail to listen port listen tcp 127.0.0.1:11918: bind: address already in use
2022/04/14 02:15:04 Start listening to port: 19777
2022/04/14 02:15:04 Start listening to port: 14611
2022/04/14 02:15:04 Successfully connect all nodes
2022/04/14 02:15:04 Successfully connect all nodes
2022/04/14 02:15:04 Successfully connect all nodes
2022/04/14 02:15:04 Successfully connect all nodes
Running testSplitVote:
node 1 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 0: granted, term: 1
node 4 -> 3: granted, term: 1
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 1 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 3: granted, term: 2
node 1 -> 3: granted, term: 2
node 0 -> 0: reject, term: 0
node 0 -> 3: granted, term: 2
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化nextIndex[]，其中的每一项为: 1
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化matchIndex[]，其中的每一项为: 0
初始化nextIndex[]和matchIndex[]完毕
node 0 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 4 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 1 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 3: success, term: 2, matchIdx: 0
node 4 -> 3: success, term: 2, matchIdx: 0
node 1 -> 3: success, term: 2, matchIdx: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 1 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 1 -> 3: reject, term: 2
node 3 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 4 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 3 -> 0: reject, term: 2
node 0 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 4 -> 0: reject, term: 2
node 0 -> 3: reject, term: 2
02:15:09.213566 rafttest.go:262: FAIL: error on testSplitVote2 - 
Expected:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: reject, term: 2
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 2 -> 3: granted, term: 2
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 2 -> 3: success, term: 2, matchIdx: 0
But get:
node 2 <- 0: RequestVote -- term: 1, candidateId: 0, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 2 <- 3: RequestVote -- term: 2, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
node 0 -> 0: reject, term: 0
node 2 <- 3: AppendEntries -- term: 2, leaderId: 3, prevLogIdx: 0, prevLogTerm: 0, entries: [], leaderCommit: 0
node 0 -> 0: fail, term: 0, matchIdx: 0
node 2 <- 3: RequestVote -- term: 1, candidateId: 3, lastLogIdx: 0, lastLogTerm: 0
testSplitVote FAIL
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111164 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT0} -proxyport=${PROXY_NODE_PORT0} -id=0
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111165 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT1} -proxyport=${PROXY_NODE_PORT1} -id=1
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111166 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT2} -proxyport=${PROXY_NODE_PORT2} -id=2
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111167 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT3} -proxyport=${PROXY_NODE_PORT3} -id=3
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111168 Killed                  ${PROXY_NODE} -raftport=${NODE_PORT4} -proxyport=${PROXY_NODE_PORT4} -id=4
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111170 Killed                  ${RAFT_NODE} ${NODE_PORT1} ${ALL_PROXY_PORTS} 1 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111172 Killed                  ${RAFT_NODE} ${NODE_PORT3} ${ALL_PROXY_PORTS} 3 10000 10000
/home/ycpan21/cuhk-raft-pycyyaxyy/scripts/rafttest_single.sh: line 118: 111173 Killed                  ${RAFT_NODE} ${NODE_PORT4} ${ALL_PROXY_PORTS} 4 10000 10000
node 0 Proxy started
node 2 Proxy started
2022/04/14 02:15:09 Start listening to port: 14764
node 3 Proxy started
node 4 Proxy started
2022/04/14 02:15:09 Start listening to port: 19913
node 1 Proxy started
2022/04/14 02:15:09 Start listening to port: 14611
2022/04/14 02:15:09 Start listening to port: 19777
2022/04/14 02:15:09 Fail to listen port listen tcp 127.0.0.1:11918: bind: address already in use
2022/04/14 02:15:09 Successfully connect all nodes
2022/04/14 02:15:09 Successfully connect all nodes
2022/04/14 02:15:09 Successfully connect all nodes
2022/04/14 02:15:09 Successfully connect all nodes
Running testAllForElection:
